;/*FB_PKG_DELIM*/

__d("LSGetLocalizedReplySnippet",["LSGetThreadParticipantDisplayName","LSGetViewerFBID"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(g){return c.seq([function(a){return c.sp(b("LSGetViewerFBID")).then(function(a){return a=a,d[0]=a[0],a})},function(e){return c.i64.eq(a[3],c.i64.cast([0,1]))?c.seq([function(e){return c.i64.eq(a[1],d[0])?c.seq([function(e){return c.i64.eq(a[2],d[0])?c.seq([function(a){return c.localizeV2Async(c.i64.cast([0,2421884758]),f).then(function(a){return d[4]=a})},function(a){return d[3]=d[4]}]):c.seq([function(e){return c.sp(b("LSGetThreadParticipantDisplayName"),a[0],a[2]).then(function(a){return a=a,d[4]=a[0],a})},function(a){return d[5]=c.createArray(),d[7]=(d[5].push(d[4]),d[5]),c.localizeV2Async(c.i64.cast([0,2676961947]),d[5]).then(function(a){return d[6]=a})},function(a){return d[3]=d[6]}])},function(a){return d[2]=d[3]}]):c.seq([function(e){return c.sp(b("LSGetThreadParticipantDisplayName"),a[0],a[1]).then(function(a){return a=a,d[3]=a[0],a})},function(e){return c.i64.eq(a[2],d[0])?c.seq([function(a){return d[5]=c.createArray(),d[7]=(d[5].push(d[3]),d[5]),c.localizeV2Async(c.i64.cast([0,3298086032]),d[5]).then(function(a){return d[6]=a})},function(a){return d[4]=d[6]}]):c.seq([function(e){return c.i64.eq(a[1],a[2])?c.seq([function(a){return d[6]=c.createArray(),d[8]=(d[6].push(d[3]),d[6]),c.localizeV2Async(c.i64.cast([0,3873263038]),d[6]).then(function(a){return d[7]=a})},function(a){return d[5]=d[7]}]):c.seq([function(e){return c.sp(b("LSGetThreadParticipantDisplayName"),a[0],a[2]).then(function(a){return a=a,d[6]=a[0],a})},function(a){return d[7]=c.createArray(),d[9]=(d[7].push(d[3]),d[7]),d[9]=(d[7].push(d[6]),d[7]),c.localizeV2Async(c.i64.cast([0,2616853333]),d[7]).then(function(a){return d[8]=a})},function(a){return d[5]=d[8]}])},function(a){return d[4]=d[5]}])},function(a){return d[2]=d[4]}])},function(a){return d[1]=d[2]}]):c.seq([function(e){return c.i64.eq(a[1],d[0])?c.seq([function(e){return c.i64.eq(a[2],d[0])?c.seq([function(a){return c.localizeV2Async(c.i64.cast([0,4002265907]),f).then(function(a){return d[4]=a})},function(a){return d[3]=d[4]}]):c.seq([function(e){return c.sp(b("LSGetThreadParticipantDisplayName"),a[0],a[2]).then(function(a){return a=a,d[4]=a[0],a})},function(a){return d[5]=c.createArray(),d[7]=(d[5].push(d[4]),d[5]),c.localizeV2Async(c.i64.cast([0,2663996736]),d[5]).then(function(a){return d[6]=a})},function(a){return d[3]=d[6]}])},function(a){return d[2]=d[3]}]):c.seq([function(e){return c.sp(b("LSGetThreadParticipantDisplayName"),a[0],a[1]).then(function(a){return a=a,d[3]=a[0],a})},function(e){return c.i64.eq(a[2],d[0])?c.seq([function(a){return d[5]=c.createArray(),d[7]=(d[5].push(d[3]),d[5]),c.localizeV2Async(c.i64.cast([0,2868699317]),d[5]).then(function(a){return d[6]=a})},function(a){return d[4]=d[6]}]):c.seq([function(e){return c.i64.eq(a[1],a[2])?c.seq([function(a){return d[6]=c.createArray(),d[8]=(d[6].push(d[3]),d[6]),c.localizeV2Async(c.i64.cast([0,2688620547]),d[6]).then(function(a){return d[7]=a})},function(a){return d[5]=d[7]}]):c.seq([function(e){return c.sp(b("LSGetThreadParticipantDisplayName"),a[0],a[2]).then(function(a){return a=a,d[6]=a[0],a})},function(a){return d[7]=c.createArray(),d[9]=(d[7].push(d[3]),d[7]),d[9]=(d[7].push(d[6]),d[7]),c.localizeV2Async(c.i64.cast([0,3544071775]),d[7]).then(function(a){return d[8]=a})},function(a){return d[5]=d[8]}])},function(a){return d[4]=d[5]}])},function(a){return d[2]=d[4]}])},function(a){return d[1]=d[2]}])},function(a){return e[0]=d[1]}])},function(a){return c.resolve(e)}])}c=a;f["default"]=c}),66);
__d("LSInsertOptimisticAttachment",["LSSetMessageDisplayedContentTypes"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e;return c.seq([function(d){return c.seq([function(b){return c.fe(c.ftr(c.db.table(16).fetch([[[a[0],a[2],a[4]]]]),function(b){return c.i64.eq(b.threadKey,a[0])&&c.i64.eq(c.i64.cast([0,0]),c.i64.cast([0,0]))&&b.messageId===a[2]&&b.attachmentFbid===a[4]&&c.i64.lt(b.authorityLevel,c.i64.cast([0,20]))}),function(a){return a["delete"]()})},function(b){return c.db.table(16).add({threadKey:a[0],messageId:a[2],attachmentFbid:a[4],timestampMs:a[1],offlineAttachmentId:a[3],attachmentType:a[5],filename:a[6],attributionAppId:a[7],hasMedia:a[8],isSharable:!1,hasXma:a[9],authorityLevel:c.i64.cast([0,20])})},function(d){return c.sp(b("LSSetMessageDisplayedContentTypes"),a[0],a[2],a[1],e,!1,c.i64.eq(a[5],c.i64.cast([0,1])))}])},function(a){return c.resolve(d)}])}c=a;f["default"]=c}),66);
__d("LSIssueSendAttachmentMessageTask",["LSAppendDataTraceAddon","LSArrayGetObjectAt","LSIssueNewTaskWithExtraOperationsAndGetTaskID","LSPredefineTraceForTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(e){return c.seq([function(e){return d[0]=c.i64.of_int32(a[5].length),c.i64.gt(d[0],c.i64.cast([0,0]))?c.loopAsync(d[0],function(e){return d[3]=e,c.seq([function(e){return c.ntop("Array",b("LSArrayGetObjectAt"),a[5],d[3]).then(function(a){return a=a,d[4]=a[0],d[5]=a[1],a})},function(b){return c.fe(c.ftr(c.db.table(16).fetch([[[a[1],a[3]]]]),function(b){return c.i64.eq(b.threadKey,a[1])&&b.messageId===a[3]&&c.i64.eq(b.attachmentIndex,d[3])&&c.i64.eq(b.authorityLevel,c.i64.cast([0,20]))}),function(a){var b=a.update;a.item;return b({attachmentFbid:c.i64.to_string(d[4])})})}])}):c.resolve()},function(e){return c.i64.eq(f,c.i64.cast([0,12]))?d[1]=c.i64.cast([0,10]):(a[9]?d[3]=c.i64.cast([0,9]):d[3]=c.i64.cast([0,3]),d[1]=d[3]),c.sp(b("LSIssueNewTaskWithExtraOperationsAndGetTaskID"),c.i64.to_string(a[1]),c.i64.cast([0,46]),"",f,f,c.i64.cast([0,0]),c.i64.cast([0,0]),c.i64.cast([0,1]),f,c.i64.cast([0,0]),f).then(function(a){return a=a,d[2]=a[0],a})},function(e){return a[12]!==f?c.seq([function(e){return c.sp(b("LSPredefineTraceForTask"),a[12],d[2],c.i64.to_string(c.i64.cast([0,46])),a[3])},function(d){return c.sp(b("LSAppendDataTraceAddon"),a[12],c.i64.cast([0,20]),c.i64.cast([0,1]),f,f)}]):c.resolve()},function(b){return c.db.table(31).add({taskId:d[2],threadKey:a[1],offlineThreadingId:a[3],threadAttributionSource:a[6],platformRef:a[10],platformToken:a[11],replySourceId:a[7],replySourceType:a[8],sendType:d[1],markThreadRead:!1})}])},function(a){return c.resolve(e)}])}c=a;f["default"]=c}),66);
__d("LSSetMessageViewFlags",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[],d=[],e;return b.seq([function(d){return b.seq([function(d){return b.ftr(b.db.table(12).fetch([[[a[0],a[2],a[1]]]]),function(c){return b.i64.eq(c.threadKey,a[0])&&b.i64.eq(b.i64.cast([0,0]),b.i64.cast([0,0]))&&b.i64.eq(c.timestampMs,a[2])&&c.messageId===a[1]}).next().then(function(a,d){var f=a.done;a=a.value;return f?(f=[b.i64.cast([0,0]),b.i64.cast([0,0]),b.i64.cast([0,0]),!1,"nonexistent",b.i64.cast([0,20]),e,b.i64.cast([-1,4294967295]),b.i64.cast([-1,4294967295])],c[0]=f[0],c[1]=f[1],c[2]=f[2],c[3]=f[3],c[4]=f[4],c[5]=f[5],c[6]=f[6],c[7]=f[7],c[8]=f[8],f):(d=a.item,f=[d.timestampMs,d.senderId,d.viewFlags,d.isAdminMessage,d.messageId,d.authorityLevel,d.stickerId,d.primarySortKey,d.secondarySortKey==null?b.i64.cast([-1,4294967295]):d.secondarySortKey],c[0]=f[0],c[1]=f[1],c[2]=f[2],c[3]=f[3],c[4]=f[4],c[5]=f[5],c[6]=f[6],c[7]=f[7],c[8]=f[8],f)})},function(d){return b.sb(b.ftr(b.db.table(12).fetch([[[a[0],{gt:c[7]}],[a[0],c[7]]],"messageDisplayOrder"]),function(d){return b.i64.eq(d.threadKey,a[0])&&d.messageId!==a[1]&&(b.i64.gt(d.primarySortKey,c[7])||b.i64.eq(d.primarySortKey,c[7])&&b.i64.ge(d.secondarySortKey==null?b.i64.cast([-1,4294967295]):d.secondarySortKey,c[8]))}),[["timestampMs","ASC"]],["primarySortKey","secondarySortKey"]).next().then(function(a,d){var f=a.done;a=a.value;return f?(f=[b.i64.cast([0,0]),b.i64.cast([0,0]),b.i64.cast([0,0]),!1,"nonexistent",b.i64.cast([0,20]),e,b.i64.cast([-1,4294967295]),b.i64.cast([-1,4294967295])],c[10]=f[0],c[11]=f[1],c[12]=f[2],c[13]=f[3],c[14]=f[4],c[15]=f[5],c[16]=f[6],c[17]=f[7],c[18]=f[8],f):(d=a.item,f=[d.timestampMs,d.senderId,d.viewFlags,d.isAdminMessage,d.messageId,d.authorityLevel,d.stickerId,b.i64.cast([-1,4294967295]),b.i64.cast([-1,4294967295])],c[10]=f[0],c[11]=f[1],c[12]=f[2],c[13]=f[3],c[14]=f[4],c[15]=f[5],c[16]=f[6],c[17]=f[7],c[18]=f[8],f)})},function(d){return b.sb(b.ftr(b.db.table(12).fetchDesc([[[a[0],{lt:c[7]}],[a[0],c[7]]],"messageDisplayOrder"]),function(d){return b.i64.eq(d.threadKey,a[0])&&d.messageId!==a[1]&&(b.i64.lt(d.primarySortKey,c[7])||b.i64.eq(d.primarySortKey,c[7])&&b.i64.le(d.secondarySortKey==null?b.i64.cast([-1,4294967295]):d.secondarySortKey,c[8]))}),[["timestampMs","DESC"]],["primarySortKey","secondarySortKey"]).next().then(function(a,d){var f=a.done;a=a.value;return f?(f=[b.i64.cast([0,0]),b.i64.cast([0,0]),b.i64.cast([0,0]),!1,"nonexistent",b.i64.cast([0,20]),e,b.i64.cast([-1,4294967295]),b.i64.cast([-1,4294967295])],c[20]=f[0],c[21]=f[1],c[22]=f[2],c[23]=f[3],c[24]=f[4],c[25]=f[5],c[26]=f[6],c[27]=f[7],c[28]=f[8],f):(d=a.item,f=[d.timestampMs,d.senderId,d.viewFlags,d.isAdminMessage,d.messageId,d.authorityLevel,d.stickerId,b.i64.cast([-1,4294967295]),b.i64.cast([-1,4294967295])],c[20]=f[0],c[21]=f[1],c[22]=f[2],c[23]=f[3],c[24]=f[4],c[25]=f[5],c[26]=f[6],c[27]=f[7],c[28]=f[8],f)})},function(d){return c[32]=b.i64.or_(b.i64.cast([0,2]),b.i64.or_(!c[3]&&!a[3]?b.i64.cast([0,4]):b.i64.cast([0,0]),b.i64.or_(c[3]?b.i64.cast([0,0]):b.i64.cast([0,1]),b.i64.or_(b.i64.eq(c[5],b.i64.cast([0,60]))||b.i64.eq(c[5],b.i64.cast([0,80]))?b.i64.cast([0,1048576]):b.i64.cast([0,0]),b.i64.neq(c[6],b.i64.cast([85970,924785702]))&&b.i64.neq(c[6],b.i64.cast([85970,1004785694]))&&b.i64.neq(c[6],b.i64.cast([85970,1044785690]))?b.i64.cast([0,0]):b.i64.cast([0,2097152]))))),c[14]!=="nonexistent"?b.seq([function(d){return c[35]=b.i64.or_(b.i64.and_(c[12],b.i64.cast([-1,4294967280])),b.i64.or_(b.i64.gt(b.i64.sub(c[10],c[0]),b.i64.cast([0,6e5]))?b.i64.cast([0,2]):b.i64.cast([0,0]),b.i64.or_(b.i64.eq(c[11],c[1])&&!c[13]&&!c[3]&&!b.i64.gt(b.i64.sub(c[10],c[0]),b.i64.cast([0,6e5]))?b.i64.cast([0,8]):b.i64.cast([0,0]),b.i64.or_(!a[3]&&!c[13]&&!(b.i64.eq(c[11],c[1])&&!c[13]&&!c[3]&&!b.i64.gt(b.i64.sub(c[10],c[0]),b.i64.cast([0,6e5])))?b.i64.cast([0,4]):b.i64.cast([0,0]),b.i64.and_(c[12],b.i64.cast([0,1])))))),c[33]=b.i64.eq(b.i64.and_(c[35],b.i64.cast([0,8])),b.i64.cast([0,8])),c[34]=c[33]?b.i64.or_(c[32],b.i64.cast([0,16])):c[32],b.fe(b.ftr(b.db.table(12).fetch([[[a[0],c[10],c[14]]]]),function(d){return b.i64.eq(d.threadKey,a[0])&&b.i64.eq(b.i64.cast([0,0]),b.i64.cast([0,0]))&&b.i64.eq(d.timestampMs,c[10])&&d.messageId===c[14]}),function(a){var b=a.update;a.item;return b({viewFlags:c[35]})})},function(a){return c[30]=c[33]?b.i64.and_(c[34],b.i64.cast([-1,4294967294])):c[34]}]):b.resolve(c[30]=c[32])},function(d){return c[24]!=="nonexistent"?b.seq([function(d){return c[35]=b.i64.or_(b.i64.and_(c[30],b.i64.cast([-1,4294967280])),b.i64.or_(b.i64.gt(b.i64.sub(c[0],c[20]),b.i64.cast([0,6e5]))?b.i64.cast([0,2]):b.i64.cast([0,0]),b.i64.or_(b.i64.eq(c[1],c[21])&&!c[3]&&!c[23]&&!b.i64.gt(b.i64.sub(c[0],c[20]),b.i64.cast([0,6e5]))?b.i64.cast([0,8]):b.i64.cast([0,0]),b.i64.or_(!a[3]&&!c[3]&&!(b.i64.eq(c[1],c[21])&&!c[3]&&!c[23]&&!b.i64.gt(b.i64.sub(c[0],c[20]),b.i64.cast([0,6e5])))?b.i64.cast([0,4]):b.i64.cast([0,0]),b.i64.and_(c[30],b.i64.cast([0,1])))))),c[33]=b.i64.eq(b.i64.and_(c[35],b.i64.cast([0,8])),b.i64.cast([0,8])),c[34]=c[33]?b.i64.or_(c[22],b.i64.cast([0,16])):c[22],b.fe(b.ftr(b.db.table(12).fetch([[[a[0],c[20],c[24]]]]),function(d){return b.i64.eq(d.threadKey,a[0])&&b.i64.eq(b.i64.cast([0,0]),b.i64.cast([0,0]))&&b.i64.eq(d.timestampMs,c[20])&&d.messageId===c[24]}),function(a){var d=a.update;a.item;return d({viewFlags:c[33]?b.i64.and_(c[34],b.i64.cast([-1,4294967294])):c[34]})})},function(a){return c[31]=c[35]}]):b.resolve(c[31]=c[30])},function(d){return b.fe(b.ftr(b.db.table(12).fetch([[[a[0],c[0],c[4]]]]),function(d){return b.i64.eq(d.threadKey,a[0])&&b.i64.eq(b.i64.cast([0,0]),b.i64.cast([0,0]))&&b.i64.eq(d.timestampMs,c[0])&&d.messageId===c[4]}),function(a){var b=a.update;a.item;return b({viewFlags:c[31]})})}])},function(a){return b.resolve(d)}])}b=a;f["default"]=b}),66);
__d("LSLocalApplyOptimisticMessage",["LSCreateOfflineThreadingID","LSGetLocalizedReplySnippet","LSIssueNewError","LSSetMessageDisplayedContentTypes","LSSetMessageViewFlags"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(g){return c.seq([function(a){return d[0]=c.i64.of_float(Date.now()),f!==f?c.resolve(d[1]=f):c.seq([function(a){return c.sp(b("LSCreateOfflineThreadingID"),d[0]).then(function(a){return a=a,d[9]=a[0],a})},function(a){return d[1]=c.i64.to_string(d[9])}])},function(e){return d[8]=a[4]==null?a[3]:a[4],c.seq([function(a){return c.islc(c.db.table(9).fetchDesc([[[]],"lastActivityTimestampMs"]),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(a,b){var e=a.done;a=a.value;return e?d[9]=c.i64.cast([-1,4294967295]):(b=a.item,d[9]=b.lastActivityTimestampMs)})},function(e){return d[11]=c.i64.add(d[9],c.i64.cast([0,1])),d[13]=c.i64.gt(d[0],d[11])?d[0]:d[11],c.db.table(9).fetch([[[a[1]]]]).next().then(function(e,h){h=e.done;e=e.value;return h?c.seq([function(b){return function(a){c.logger(a).info(a)}("localApplyOptimisticMessage insert optimistic thread"),c.fe(c.ftr(c.db.table(9).fetch([[[a[1]]]]),function(b){return c.i64.eq(b.threadKey,a[1])&&c.i64.lt(b.authorityLevel,c.i64.cast([0,40]))}),function(a){return a["delete"]()})},function(b){return c.db.table(9).add({threadKey:a[1],mailboxType:c.i64.cast([0,0]),threadType:a[2],clientThreadKey:a[1],folderName:"inbox",parentThreadKey:c.i64.cast([0,0]),lastActivityTimestampMs:d[13],lastReadWatermarkTimestampMs:d[13],snippet:d[8],snippetHasEmoji:a[5]==null?!1:a[5],snippetSenderContactId:a[0],ongoingCallState:c.i64.cast([0,0]),authorityLevel:c.i64.cast([0,40])})},function(b){return c.i64.eq(a[2],c.i64.cast([0,13]))||c.i64.eq(a[2],c.i64.cast([0,7]))||c.i64.eq(a[2],c.i64.cast([0,1]))?c.seq([function(b){return c.fe(c.ftr(c.db.table(14).fetch([[[a[1],a[1]]]]),function(b){return c.i64.eq(b.threadKey,a[1])&&c.i64.eq(c.i64.cast([0,0]),c.i64.cast([0,0]))&&c.i64.eq(b.contactId,a[1])&&c.i64.lt(b.authorityLevel,c.i64.cast([0,20]))}),function(a){return a["delete"]()})},function(b){return c.db.table(14).add({threadKey:a[1],contactId:a[1],readWatermarkTimestampMs:c.i64.cast([0,0]),deliveredWatermarkTimestampMs:c.i64.cast([0,0]),authorityLevel:c.i64.cast([0,20]),isModerator:!1})}]):c.resolve()},function(a){return c.sb(c.db.table(115).fetch(),[["timestampMs","DESC"]]).next().then(function(a,b){var c=a.done;a=a.value;return c?d[14]=!1:(b=a.item,d[14]=b.errorShouldBeShown)})},function(a){return d[14]===!0?c.seq([function(a){return c.localizeV2Async(c.i64.cast([0,2285622730]),f).then(function(a){return d[16]=a})},function(a){return c.localizeV2Async(c.i64.cast([0,1919524925]),f).then(function(a){return d[17]=a})},function(a){return c.sp(b("LSIssueNewError"),f,c.i64.cast([0,1545093]),d[16],d[17],f,f)}]):c.resolve()}]):(e.item,c.fe(c.ftr(c.db.table(9).fetch([[[a[1]]]]),function(b){return c.i64.eq(b.threadKey,a[1])&&c.i64.eq(b.threadType,a[2])}),function(b){var c=b.update;b.item;return c({lastActivityTimestampMs:d[13],lastReadWatermarkTimestampMs:d[13],snippet:d[8],snippetHasEmoji:a[5]==null?!1:a[5],snippetSenderContactId:a[0],snippetStringHash:f,snippetStringArgument1:f,snippetAttribution:f,snippetAttributionStringHash:f,additionalThreadContext:f})}))})}])},function(e){return c.seq([function(b){return c.islc(c.ftr(c.db.table(12).fetchDesc([[[a[1]]],"messageDisplayOrder"]),function(b){return c.i64.eq(b.threadKey,a[1])&&(c.i64.eq(b.authorityLevel,c.i64.cast([0,80]))||c.i64.eq(b.authorityLevel,c.i64.cast([0,60]))||c.i64.eq(b.authorityLevel,c.i64.cast([0,40])))}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(a,b){var e=a.done;a=a.value;return e?(d[33]=c.i64.of_float(Date.now()),d[9]=d[33]):(b=a.item,d[9]=b.primarySortKey)})},function(e){return a[8]!==f&&(c.i64.eq(a[9],c.i64.cast([0,1]))||c.i64.eq(a[10],c.i64.cast([0,1])))?c.seq([function(e){return c.ftr(c.db.table(12).fetch([[[a[1]]]]),function(b){return c.i64.eq(b.threadKey,a[1])&&b.messageId===(a[8]==null?"":a[8])}).next().then(function(e,h){var i=e.done;e=e.value;return i?(i=[a[8],f,f,c.i64.cast([0,0]),f,f,f,f,f,f,f,f,f,f,f,f],d[33]=i[0],d[34]=i[1],d[35]=i[2],d[36]=i[3],d[37]=i[4],d[38]=i[5],d[39]=i[6],d[40]=i[7],d[41]=i[8],d[42]=i[9],d[43]=i[10],d[44]=i[11],d[45]=i[12],d[46]=i[13],d[47]=i[14],d[48]=i[15],i):(h=e.item,c.seq([function(e){return d[54]=h.senderId,d[53]=h.stickerId,c.i64.neq(d[53],f)?(e=[d[53],c.i64.cast([0,4])],d[56]=e[0],d[57]=e[1],e):(e=[f,f],d[56]=e[0],d[57]=e[1],e),e=[d[56],d[57]],d[50]=e[0],d[51]=e[1],e,d[55]=h.replyType==null?c.i64.cast([0,0]):h.replyType,c.seq([function(e){return c.sp(b("LSGetLocalizedReplySnippet"),a[1],a[0],d[54],d[55]).then(function(a){return a=a,d[56]=a[0],a})},function(b){return d[52]=c.i64.eq(a[10],c.i64.cast([0,1]))?d[56]:""}])},function(b){return b=[a[8],a[9],a[10],c.i64.cast([0,1]),d[52],d[54],h.text,d[50],d[51],f,f,f,f,f,f,d[55]],d[33]=b[0],d[34]=b[1],d[35]=b[2],d[36]=b[3],d[37]=b[4],d[38]=b[5],d[39]=b[6],d[40]=b[7],d[41]=b[8],d[42]=b[9],d[43]=b[10],d[44]=b[11],d[45]=b[12],d[46]=b[13],d[47]=b[14],d[48]=b[15],b}]))})},function(a){return a=[d[33],d[34],d[35],d[36],d[37],d[38],d[39],d[40],d[41],d[42],d[43],d[44],d[45],d[46],d[47],d[48]],d[11]=a[0],d[12]=a[1],d[13]=a[2],d[14]=a[3],d[15]=a[4],d[16]=a[5],d[17]=a[6],d[18]=a[7],d[19]=a[8],d[20]=a[9],d[21]=a[10],d[22]=a[11],d[23]=a[12],d[24]=a[13],d[25]=a[14],d[26]=a[15],a}]):c.resolve((a[8]===f||c.i64.eq(a[9],c.i64.cast([0,0]))||c.i64.eq(a[10],c.i64.cast([0,0]))?(e=[f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f],d[33]=e[0],d[34]=e[1],d[35]=e[2],d[36]=e[3],d[37]=e[4],d[38]=e[5],d[39]=e[6],d[40]=e[7],d[41]=e[8],d[42]=e[9],d[43]=e[10],d[44]=e[11],d[45]=e[12],d[46]=e[13],d[47]=e[14],d[48]=e[15],e):(e=[a[8],a[9],a[10],c.i64.cast([0,1]),f,f,f,f,f,f,f,f,f,f,f,f],d[33]=e[0],d[34]=e[1],d[35]=e[2],d[36]=e[3],d[37]=e[4],d[38]=e[5],d[39]=e[6],d[40]=e[7],d[41]=e[8],d[42]=e[9],d[43]=e[10],d[44]=e[11],d[45]=e[12],d[46]=e[13],d[47]=e[14],d[48]=e[15],e),e=[d[33],d[34],d[35],d[36],d[37],d[38],d[39],d[40],d[41],d[42],d[43],d[44],d[45],d[46],d[47],d[48]],d[11]=e[0],d[12]=e[1],d[13]=e[2],d[14]=e[3],d[15]=e[4],d[16]=e[5],d[17]=e[6],d[18]=e[7],d[19]=e[8],d[20]=e[9],d[21]=e[10],d[22]=e[11],d[23]=e[12],d[24]=e[13],d[25]=e[14],d[26]=e[15],e))},function(b){return a[13]?d[27]=!1:d[27]=!0,d[27]?(b=[f,f,f,f],d[28]=b[0],d[29]=b[1],d[30]=b[2],d[31]=b[3],b):(d[33]=a[13].get("mention_offsets"),a[13],d[34]=a[13].get("mention_lengths"),a[13],d[35]=a[13].get("mention_ids"),a[13],d[36]=a[13].get("mention_types"),a[13],b=[d[33],d[34],d[35],d[36]],d[28]=b[0],d[29]=b[1],d[30]=b[2],d[31]=b[3],b),a[11]?d[32]=c.i64.cast([0,3]):d[32]=d[13],c.i64.eq(c.i64.cast([0,20]),c.i64.cast([0,20]))?c.db.table(12).add({threadKey:a[1],messageId:d[1],timestampMs:d[0],offlineThreadingId:d[1],primarySortKey:d[9],secondarySortKey:d[0],text:a[3],senderId:a[0],stickerId:a[6],hotEmojiSize:a[7],isForwarded:a[11],forwardScore:a[12],isAdminMessage:!1,sendStatus:c.i64.cast([0,1]),sendStatusV2:c.i64.cast([0,1]),authorityLevel:c.i64.cast([0,20]),replySourceId:d[11],replySourceType:d[12],replySourceTypeV2:d[32],replyStatus:d[14],replySnippet:d[15],replyToUserId:d[16],replyMessageText:d[17],replyAttachmentId:d[18],replyAttachmentType:d[19],replyMediaUrl:d[20],replyMediaUrlFallback:d[21],replyMediaPreviewWidth:d[22],replyMediaPreviewHeight:d[23],replyMediaUrlMimeType:d[24],replyType:d[26],mentionOffsets:d[28],mentionLengths:d[29],mentionIds:d[30],mentionTypes:d[31]}):c.seq([function(a){return c.db.table(12).fetch([[[d[1]]],"optimistic"]).next().then(function(a,b){var c=a.done;a=a.value;return c?(c=[d[9],d[0],f],d[33]=c[0],d[34]=c[1],d[35]=c[2],c):(b=a.item,c=[b.primarySortKey,b.secondarySortKey,b.localDataId],d[33]=c[0],d[34]=c[1],d[35]=c[2],c)})},function(a){return c.fe(c.ftr(c.db.table(12).fetch([[[d[1]]],"optimistic"]),function(a){return a.offlineThreadingId===d[1]&&c.i64.lt(a.authorityLevel,c.i64.cast([0,20]))}),function(a){return a["delete"]()})},function(b){return c.db.table(12).add({threadKey:a[1],messageId:d[1],timestampMs:d[0],offlineThreadingId:d[1],primarySortKey:d[33],secondarySortKey:d[34],text:a[3],senderId:a[0],stickerId:a[6],hotEmojiSize:a[7],isForwarded:a[11],forwardScore:a[12],isAdminMessage:!1,sendStatus:c.i64.cast([0,1]),sendStatusV2:c.i64.cast([0,1]),authorityLevel:c.i64.cast([0,20]),localDataId:d[35],replySourceId:d[11],replySourceType:d[12],replySourceTypeV2:d[32],replyStatus:d[14],replySnippet:d[15],replyToUserId:d[16],replyMessageText:d[17],replyAttachmentId:d[18],replyAttachmentType:d[19],replyMediaUrl:d[20],replyMediaUrlFallback:d[21],replyMediaPreviewWidth:d[22],replyMediaPreviewHeight:d[23],replyMediaUrlMimeType:d[24],replyType:d[26],mentionOffsets:d[28],mentionLengths:d[29],mentionIds:d[30],mentionTypes:d[31]})}])}])},function(e){return d[2]=c.createArray(),d[3]=(d[2].push("LSMailboxLocalApplyOptimisticMessageStoredProcedure"),d[2]),d[4]=(d[2].push("localApplyOptimisticMessage"),d[2]),d[5]=(d[2].push(a[1]),d[2]),d[6]=(d[2].push(d[1]),d[2]),d[7]=c.toJSON(d[2]),function(a){c.logger(a).info(a)}(d[7]),a[14]?c.seq([function(e){return c.sp(b("LSSetMessageViewFlags"),a[1],d[1],d[0],c.i64.eq(a[2],c.i64.cast([0,1])))},function(e){return c.sp(b("LSSetMessageDisplayedContentTypes"),a[1],d[1],d[0],a[3],!1,c.i64.neq(a[6],f))}]):c.resolve()},function(a){return a=[d[1],d[0]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}c=a;f["default"]=c}),66);
__d("LSLocalApplyOptimisticMessageV2",["LSCreateOfflineThreadingID","LSGetLocalizedReplySnippet","LSIssueNewError","LSSetMessageDisplayedContentTypes","LSSetMessageViewFlags"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(g){return c.seq([function(a){return d[0]=c.i64.of_float(Date.now()),c.sp(b("LSCreateOfflineThreadingID"),d[0]).then(function(a){return a=a,d[1]=a[0],a})},function(e){return d[4]=c.i64.to_string(d[1]),d[3]=a[4]==null?a[3]:a[4],c.seq([function(b){return d[5]=a[5].get("snippet_has_emoji"),a[5],c.islc(c.db.table(9).fetchDesc([[[]],"lastActivityTimestampMs"]),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(a,b){var e=a.done;a=a.value;return e?d[6]=c.i64.cast([-1,4294967295]):(b=a.item,d[6]=b.lastActivityTimestampMs)})},function(e){return d[8]=c.i64.add(d[6],c.i64.cast([0,1])),d[10]=c.i64.gt(d[0],d[8])?d[0]:d[8],c.db.table(9).fetch([[[a[1]]]]).next().then(function(e,h){h=e.done;e=e.value;return h?c.seq([function(b){return function(a){c.logger(a).info(a)}("localApplyOptimisticMessage insert optimistic thread"),c.i64.eq(a[2],c.i64.cast([0,1]))?c.seq([function(b){return c.ftr(c.db.table(7).fetch([[[a[1]]]]),function(b){return c.i64.eq(b.id,a[1])&&c.i64.eq(c.i64.cast([0,1]),c.i64.cast([0,1]))}).next().then(function(a,b){var e=a.done;a=a.value;return e?d[16]=!1:(b=a.item,d[19]=b.capabilities2,c.i64.neq(d[19],f)?d[18]=d[19]:d[18]=c.i64.cast([0,0]),d[16]=c.i64.neq(c.i64.and_(d[18],c.i64.cast([0,4096])),c.i64.cast([0,0])))})},function(a){return d[11]=d[16]}]):c.resolve(d[11]=!1)},function(b){return d[11]?d[12]="e2ee_cutover":d[12]="inbox",d[11]?d[13]=c.i64.cast([-1,4294967279]):d[13]=c.i64.cast([0,0]),c.fe(c.ftr(c.db.table(9).fetch([[[a[1]]]]),function(b){return c.i64.eq(b.threadKey,a[1])&&c.i64.lt(b.authorityLevel,c.i64.cast([0,40]))}),function(a){return a["delete"]()})},function(b){return c.db.table(9).add({threadKey:a[1],mailboxType:c.i64.cast([0,0]),threadType:a[2],clientThreadKey:a[1],folderName:d[12],parentThreadKey:d[13],lastActivityTimestampMs:d[10],lastReadWatermarkTimestampMs:d[10],snippet:d[3],snippetHasEmoji:d[5]==null?!1:d[5],snippetSenderContactId:a[0],ongoingCallState:c.i64.cast([0,0]),authorityLevel:c.i64.cast([0,40])})},function(b){return c.i64.eq(a[2],c.i64.cast([0,13]))||c.i64.eq(a[2],c.i64.cast([0,7]))||c.i64.eq(a[2],c.i64.cast([0,1]))?c.seq([function(b){return c.fe(c.ftr(c.db.table(14).fetch([[[a[1],a[1]]]]),function(b){return c.i64.eq(b.threadKey,a[1])&&c.i64.eq(c.i64.cast([0,0]),c.i64.cast([0,0]))&&c.i64.eq(b.contactId,a[1])&&c.i64.lt(b.authorityLevel,c.i64.cast([0,20]))}),function(a){return a["delete"]()})},function(b){return c.db.table(14).add({threadKey:a[1],contactId:a[1],readWatermarkTimestampMs:c.i64.cast([0,0]),deliveredWatermarkTimestampMs:c.i64.cast([0,0]),authorityLevel:c.i64.cast([0,20]),isModerator:!1})}]):c.resolve()},function(a){return c.sb(c.db.table(115).fetch(),[["timestampMs","DESC"]]).next().then(function(a,b){var c=a.done;a=a.value;return c?d[14]=!1:(b=a.item,d[14]=b.errorShouldBeShown)})},function(a){return d[14]===!0?c.seq([function(a){return c.localizeV2Async(c.i64.cast([0,2285622730]),f).then(function(a){return d[16]=a})},function(a){return c.localizeV2Async(c.i64.cast([0,1919524925]),f).then(function(a){return d[17]=a})},function(a){return c.sp(b("LSIssueNewError"),f,c.i64.cast([0,1545093]),d[16],d[17],f,f)}]):c.resolve()}]):(e.item,c.fe(c.ftr(c.db.table(9).fetch([[[a[1]]]]),function(b){return c.i64.eq(b.threadKey,a[1])&&c.i64.eq(b.threadType,a[2])}),function(b){var c=b.update;b.item;return c({lastActivityTimestampMs:d[10],lastReadWatermarkTimestampMs:d[10],snippet:d[3],snippetHasEmoji:d[5]==null?!1:d[5],snippetSenderContactId:a[0],snippetStringHash:f,snippetStringArgument1:f,snippetAttribution:f,snippetAttributionStringHash:f,additionalThreadContext:f})}))})}])},function(e){return c.seq([function(b){return c.islc(c.ftr(c.db.table(12).fetchDesc([[[a[1]]],"messageDisplayOrder"]),function(b){return c.i64.eq(b.threadKey,a[1])&&(c.i64.eq(b.authorityLevel,c.i64.cast([0,80]))||c.i64.eq(b.authorityLevel,c.i64.cast([0,60]))||c.i64.eq(b.authorityLevel,c.i64.cast([0,40])))}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(a,b){var e=a.done;a=a.value;return e?(d[49]=c.i64.of_float(Date.now()),d[5]=d[49]):(b=a.item,d[5]=b.primarySortKey)})},function(e){return d[7]=a[5].get("reply_source_id"),a[5],d[8]=a[5].get("reply_source_type"),a[5],d[9]=a[5].get("reply_source_type_v2"),a[5],d[10]=a[5].get("reply_type"),a[5],d[7]!==f&&(c.i64.eq(d[8],c.i64.cast([0,1]))||c.i64.eq(d[9],c.i64.cast([0,1])))?c.seq([function(e){return c.ftr(c.db.table(12).fetch([[[a[1]]]]),function(b){return c.i64.eq(b.threadKey,a[1])&&b.messageId===(d[7]==null?"":d[7])}).next().then(function(e,h){var i=e.done;e=e.value;return i?(i=[d[7],f,f,c.i64.cast([0,0]),f,f,f,f,f,f,f,f,f,f,f,f],d[49]=i[0],d[50]=i[1],d[51]=i[2],d[52]=i[3],d[53]=i[4],d[54]=i[5],d[55]=i[6],d[56]=i[7],d[57]=i[8],d[58]=i[9],d[59]=i[10],d[60]=i[11],d[61]=i[12],d[62]=i[13],d[63]=i[14],d[64]=i[15],i):(h=e.item,c.seq([function(e){return d[70]=h.senderId,d[69]=h.stickerId,c.i64.neq(d[69],f)?(e=[d[69],c.i64.cast([0,4])],d[71]=e[0],d[72]=e[1],e):(e=[f,f],d[71]=e[0],d[72]=e[1],e),e=[d[71],d[72]],d[66]=e[0],d[67]=e[1],e,c.seq([function(e){return c.sp(b("LSGetLocalizedReplySnippet"),a[1],a[0],d[70],d[10]==null?c.i64.cast([0,0]):d[10]).then(function(a){return a=a,d[71]=a[0],a})},function(a){return d[68]=c.i64.eq(d[9],c.i64.cast([0,1]))?d[71]:""}])},function(a){return a=[d[7],d[8],d[9],c.i64.cast([0,1]),d[68],d[70],h.text,d[66],d[67],f,f,f,f,f,f,d[10]],d[49]=a[0],d[50]=a[1],d[51]=a[2],d[52]=a[3],d[53]=a[4],d[54]=a[5],d[55]=a[6],d[56]=a[7],d[57]=a[8],d[58]=a[9],d[59]=a[10],d[60]=a[11],d[61]=a[12],d[62]=a[13],d[63]=a[14],d[64]=a[15],a}]))})},function(a){return a=[d[49],d[50],d[51],d[52],d[53],d[54],d[55],d[56],d[57],d[58],d[59],d[60],d[61],d[62],d[63],d[64]],d[11]=a[0],d[12]=a[1],d[13]=a[2],d[14]=a[3],d[15]=a[4],d[16]=a[5],d[17]=a[6],d[18]=a[7],d[19]=a[8],d[20]=a[9],d[21]=a[10],d[22]=a[11],d[23]=a[12],d[24]=a[13],d[25]=a[14],d[26]=a[15],a}]):c.resolve((d[7]===f||c.i64.eq(d[8],c.i64.cast([0,0]))||c.i64.eq(d[9],c.i64.cast([0,0]))?(e=[f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f],d[49]=e[0],d[50]=e[1],d[51]=e[2],d[52]=e[3],d[53]=e[4],d[54]=e[5],d[55]=e[6],d[56]=e[7],d[57]=e[8],d[58]=e[9],d[59]=e[10],d[60]=e[11],d[61]=e[12],d[62]=e[13],d[63]=e[14],d[64]=e[15],e):(e=[d[7],d[8],d[9],c.i64.cast([0,1]),f,f,f,f,f,f,f,f,f,f,f,f],d[49]=e[0],d[50]=e[1],d[51]=e[2],d[52]=e[3],d[53]=e[4],d[54]=e[5],d[55]=e[6],d[56]=e[7],d[57]=e[8],d[58]=e[9],d[59]=e[10],d[60]=e[11],d[61]=e[12],d[62]=e[13],d[63]=e[14],d[64]=e[15],e),e=[d[49],d[50],d[51],d[52],d[53],d[54],d[55],d[56],d[57],d[58],d[59],d[60],d[61],d[62],d[63],d[64]],d[11]=e[0],d[12]=e[1],d[13]=e[2],d[14]=e[3],d[15]=e[4],d[16]=e[5],d[17]=e[6],d[18]=e[7],d[19]=e[8],d[20]=e[9],d[21]=e[10],d[22]=e[11],d[23]=e[12],d[24]=e[13],d[25]=e[14],d[26]=e[15],e))},function(b){return d[27]=a[5].get("mention_data"),a[5],d[27]?d[28]=!1:d[28]=!0,d[28]?(b=[f,f,f,f],d[29]=b[0],d[30]=b[1],d[31]=b[2],d[32]=b[3],b):(d[49]=d[27].get("mention_offsets"),d[27],d[50]=d[27].get("mention_lengths"),d[27],d[51]=d[27].get("mention_ids"),d[27],d[52]=d[27].get("mention_types"),d[27],b=[d[49],d[50],d[51],d[52]],d[29]=b[0],d[30]=b[1],d[31]=b[2],d[32]=b[3],b),d[33]=a[5].get("magic_words_data"),a[5],d[33]?d[34]=!1:d[34]=!0,d[34]?(b=[f,f],d[35]=b[0],d[36]=b[1],b):(d[49]=d[33].get("magic_word_offsets"),d[33],d[50]=d[33].get("magic_word_lengths"),d[33],b=[d[49],d[50]],d[35]=b[0],d[36]=b[1],b),d[48]=c.i64.eq(d[10],c.i64.cast([0,1]))?d[17]:a[3],d[37]=a[5].get("sticker_id"),a[5],d[38]=a[5].get("sticker_alt_text"),a[5],d[39]=a[5].get("hot_emoji_size"),a[5],d[40]=a[5].get("is_forwarded"),a[5],d[41]=a[5].get("forward_score"),a[5],d[42]=a[5].get("power_up_style"),a[5],d[43]=a[5].get("local_data_id"),a[5],d[44]=a[5].get("command_type"),a[5],d[45]=a[5].get("reply_type"),a[5],d[46]=a[5].get("is_forwarded"),a[5],d[46]?d[47]=c.i64.cast([0,3]):d[47]=d[13],c.i64.eq(c.i64.cast([0,20]),c.i64.cast([0,20]))?c.db.table(12).add({threadKey:a[1],messageId:d[4],timestampMs:d[0],offlineThreadingId:d[4],primarySortKey:d[5],secondarySortKey:d[0],text:d[48],senderId:a[0],stickerId:d[37],hotEmojiSize:d[39],isForwarded:d[40],forwardScore:d[41],isAdminMessage:!1,sendStatus:c.i64.cast([0,1]),sendStatusV2:c.i64.cast([0,1]),authorityLevel:c.i64.cast([0,20]),localDataId:d[43],replyType:d[26],replySourceId:d[11],replySourceType:d[12],replySourceTypeV2:d[47],replyStatus:d[14],replySnippet:d[15],replyToUserId:d[16],replyMessageText:d[17],replyAttachmentId:d[18],replyAttachmentType:d[19],replyMediaUrl:d[20],replyMediaUrlFallback:d[21],replyMediaPreviewWidth:d[22],replyMediaPreviewHeight:d[23],replyMediaUrlMimeType:d[24],mentionOffsets:d[29],mentionLengths:d[30],mentionIds:d[31],mentionTypes:d[32]}):c.seq([function(a){return c.db.table(12).fetch([[[d[4]]],"optimistic"]).next().then(function(a,b){var c=a.done;a=a.value;return c?(c=[d[5],d[0],d[43]],d[49]=c[0],d[50]=c[1],d[51]=c[2],c):(b=a.item,c=[b.primarySortKey,b.secondarySortKey,b.localDataId],d[49]=c[0],d[50]=c[1],d[51]=c[2],c)})},function(a){return c.fe(c.ftr(c.db.table(12).fetch([[[d[4]]],"optimistic"]),function(a){return a.offlineThreadingId===d[4]&&c.i64.lt(a.authorityLevel,c.i64.cast([0,20]))}),function(a){return a["delete"]()})},function(b){return c.db.table(12).add({threadKey:a[1],messageId:d[4],timestampMs:d[0],offlineThreadingId:d[4],primarySortKey:d[49],secondarySortKey:d[50],text:d[48],senderId:a[0],stickerId:d[37],hotEmojiSize:d[39],isForwarded:d[40],forwardScore:d[41],isAdminMessage:!1,sendStatus:c.i64.cast([0,1]),sendStatusV2:c.i64.cast([0,1]),authorityLevel:c.i64.cast([0,20]),localDataId:d[51],replyType:d[26],replySourceId:d[11],replySourceType:d[12],replySourceTypeV2:d[47],replyStatus:d[14],replySnippet:d[15],replyToUserId:d[16],replyMessageText:d[17],replyAttachmentId:d[18],replyAttachmentType:d[19],replyMediaUrl:d[20],replyMediaUrlFallback:d[21],replyMediaPreviewWidth:d[22],replyMediaPreviewHeight:d[23],replyMediaUrlMimeType:d[24],mentionOffsets:d[29],mentionLengths:d[30],mentionIds:d[31],mentionTypes:d[32]})}])}])},function(e){return d[5]=c.createArray(),d[6]=(d[5].push("LSMailboxLocalApplyOptimisticMessageV2StoredProcedure"),d[5]),d[7]=(d[5].push("localApplyOptimisticMessage"),d[5]),d[8]=(d[5].push(a[1]),d[5]),d[9]=(d[5].push(d[4]),d[5]),d[10]=c.toJSON(d[5]),function(a){c.logger(a).info(a)}(d[10]),d[2]=a[5].get("calculate_denormalizations"),a[5],(d[2]==null?!0:d[2])?c.seq([function(e){return c.sp(b("LSSetMessageViewFlags"),a[1],d[4],d[0],c.i64.eq(a[2],c.i64.cast([0,1])))},function(e){return d[5]=a[5].get("sticker_id"),a[5],c.sp(b("LSSetMessageDisplayedContentTypes"),a[1],d[4],d[0],a[3],!1,c.i64.neq(d[5],f))}]):c.resolve()},function(a){return a=[d[4],d[0]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}c=a;f["default"]=c}),66);
__d("LSUpdateOptimisticAttachmentPreview",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[],d;return b.seq([function(c){return b.fe(b.ftr(b.db.table(16).fetch([[[a[0],a[1],a[2]]]]),function(c){return c.attachmentFbid===a[2]&&b.i64.eq(c.threadKey,a[0])&&c.messageId===a[1]&&b.i64.eq(c.authorityLevel,b.i64.cast([0,20]))}),function(b){var c=b.update;b.item;return c({playableUrl:a[3],playableUrlFallback:a[4],playableUrlExpirationTimestampMs:a[5],playableUrlMimeType:a[6],previewUrl:a[7],previewUrlFallback:a[8],previewUrlExpirationTimestampMs:a[9],previewUrlMimeType:a[10],previewWidth:a[11],previewHeight:a[12],imageUrl:d,imageUrlFallback:d,imageUrlExpirationTimestampMs:d,imageUrlMimeType:d})})},function(a){return b.resolve(c)}])}b=a;f["default"]=b}),66);
__d("LSOptimisticSendAttachmentForward",["LSInsertOptimisticAttachment","LSIssueNewTaskWithExtraOperationsAndGetTaskID","LSLocalApplyOptimisticMessage","LSUpdateOptimisticAttachmentPreview"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(g){return c.seq([function(e){return d[1]=a[3]===""?f:a[3],d[1]!==f?c.seq([function(b){return c.fe(c.ftr(c.db.table(16).fetch([[[a[1],d[1]]]]),function(b){return c.i64.eq(b.threadKey,a[1])&&b.messageId===d[1]&&c.i64.eq(b.authorityLevel,c.i64.cast([0,20]))}),function(b){var d=b.update;b.item;return d({attachmentFbid:c.i64.to_string(a[7])})})},function(a){return d[0]=d[1]}]):c.seq([function(e){return c.sp(b("LSLocalApplyOptimisticMessage"),a[0],a[1],a[2],a[4],a[5],a[6],f,f,f,f,c.i64.cast([0,3]),f,f,f,!0).then(function(a){return a=a,d[2]=a[0],d[3]=a[1],a})},function(e){return c.ftr(c.db.table(16).fetch(),function(b){return b.attachmentFbid===c.i64.to_string(a[7])}).next().then(function(e,h){var i=e.done;e=e.value;return i?c.sp(b("LSInsertOptimisticAttachment"),a[1],d[3],d[2],d[2],c.i64.to_string(a[7]),c.i64.cast([0,2]),f,f,!0,!1):(h=e.item,c.seq([function(e){return c.sp(b("LSInsertOptimisticAttachment"),a[1],d[3],d[2],d[2],c.i64.to_string(a[7]),h.attachmentType,h.filename,h.attributionAppId,!0,!1)},function(e){return c.sp(b("LSUpdateOptimisticAttachmentPreview"),a[1],d[2],c.i64.to_string(a[7]),h.playableUrl,h.playableUrlFallback,h.playableUrlExpirationTimestampMs,h.playableUrlMimeType,h.previewUrl,h.previewUrlFallback,h.previewUrlExpirationTimestampMs,h.previewUrlMimeType,h.previewWidth,h.previewHeight)}]))})},function(a){return d[0]=d[2]}])},function(e){return c.seq([function(e){return d[2]=c.createArray(),d[4]=(d[2].push(a[7]),d[2]),c.sp(b("LSIssueNewTaskWithExtraOperationsAndGetTaskID"),c.i64.to_string(a[1]),c.i64.cast([0,46]),"",f,f,c.i64.cast([0,0]),c.i64.cast([0,0]),c.i64.cast([0,1]),f,c.i64.cast([0,0]),f).then(function(a){return a=a,d[3]=a[0],a})},function(b){return c.db.table(31).add({taskId:d[3],threadKey:a[1],offlineThreadingId:d[0],threadAttributionSource:a[8],sendType:c.i64.cast([0,4]),markThreadRead:!1,initiatingSource:a[9]})}])},function(a){return e[0]=d[0]}])},function(a){return c.resolve(e)}])}c=a;f["default"]=c}),66);
__d("LSOptimisticSendMessageForward",["LSInsertOptimisticAttachment","LSIssueNewTaskWithExtraOperationsAndGetTaskID","LSLocalApplyOptimisticMessage","LSPredefineTraceForTask","LSUpdateOptimisticAttachmentPreview"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(g){return c.seq([function(e){return c.ftr(c.db.table(12).fetch([[[a[3],a[4],a[5]]]]),function(b){return c.i64.eq(b.threadKey,a[3])&&c.i64.eq(c.i64.cast([0,0]),c.i64.cast([0,0]))&&c.i64.eq(b.timestampMs,a[4])&&b.messageId===a[5]&&c.i64.eq(b.authorityLevel,c.i64.cast([0,80]))}).next().then(function(e,h){var i=e.done;e=e.value;return i?(d[2]=c.createArray(),d[3]=(d[2].push("optimisticSendMessageForward msg not found"),d[2]),d[4]=(d[2].push(a[5]),d[2]),d[5]=c.toJSON(d[2]),function(a){c.logger(a).mustfix(a)}(d[5]),d[0]=""):(h=e.item,c.seq([function(e){return d[8]=h.forwardScore,d[2]=h.text,d[3]=d[8],c.sp(b("LSLocalApplyOptimisticMessage"),a[0],a[1],a[2],d[2],f,f,h.stickerId,h.hotEmojiSize,f,f,c.i64.cast([0,3]),f,d[3],f,!0).then(function(a){return a=a,d[4]=a[0],d[5]=a[1],a})},function(e){return c.fe(c.db.table(16).fetch([[[h.threadKey,h.messageId]]]),function(e){var h=e.item;return c.seq([function(e){return d[13]=h.attachmentFbid,d[9]=c.createArray(),d[10]=(d[9].push(d[13]),d[9]),d[11]=(d[9].push(d[4]),d[9]),d[12]=c.toJSON(d[9]),c.sp(b("LSInsertOptimisticAttachment"),a[1],d[5],d[4],d[13],d[12],h.attachmentType,h.filename,f,h.hasMedia,h.hasXma)},function(e){return c.sp(b("LSUpdateOptimisticAttachmentPreview"),a[1],d[4],d[12],h.playableUrl,h.playableUrlFallback,h.playableUrlExpirationTimestampMs,h.playableUrlMimeType,h.previewUrl,h.previewUrlFallback,h.previewUrlExpirationTimestampMs,h.previewUrlMimeType,h.previewWidth,h.previewHeight)}])})},function(e){return c.sp(b("LSIssueNewTaskWithExtraOperationsAndGetTaskID"),c.i64.to_string(a[1]),c.i64.cast([0,46]),"",f,f,c.i64.cast([0,0]),c.i64.cast([0,0]),c.i64.cast([0,1]),f,c.i64.cast([0,0]),f).then(function(a){return a=a,d[6]=a[0],a})},function(a){return f!==f?c.sp(b("LSPredefineTraceForTask"),f,d[6],c.i64.to_string(c.i64.cast([0,46])),d[4]):c.resolve()},function(b){return c.db.table(31).add({taskId:d[6],threadKey:a[1],offlineThreadingId:d[4],messageId:a[5],threadAttributionSource:a[6],sendType:c.i64.cast([0,5]),markThreadRead:!1,initiatingSource:a[7]})},function(b){return d[9]=new c.Map(),d[10]=d[9].set("optimisticSendMessageForward",a[1]),d[11]=d[9].set("fwdMsgID",a[5]),d[12]=c.toJSON(d[9]),d[7]=d[12],function(a){c.logger(a).info(a)}(d[7]),d[0]=d[4]}]))})},function(a){return e[0]=d[0]}])},function(a){return c.resolve(e)}])}c=a;f["default"]=c}),66);
__d("LSAppendDataTraceAddon.nop",["LSAppendDataTraceAddon","LSFactory","Promise","killswitch"],(function(a,b,c,d,e,f,g){"use strict";a=function(a,d,e,f,g,h,i){return c("killswitch")("MESSENGER_WEB_DATA_TRACE_ID")?b("Promise").resolve():c("LSAppendDataTraceAddon")(e,f,g,(d=h)!=null?d:"",(e=i)!=null?e:"",c("LSFactory")(a))};g["default"]=a}),98);
__d("LSOptimisticSendMessageV2",["LSAppendDataTraceAddon.nop","LSInsertOptimisticAttachment","LSIssueNewTaskWithExtraOperationsAndGetTaskID","LSLocalApplyOptimisticMessageV2","LSLogEventAnnotate.nop","LSOptimisticMarkThreadReadV2","LSPredefineTraceForTask","LSUpdateOptimisticAttachmentPreview"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(g){return c.seq([function(e){return c.sp(b("LSLocalApplyOptimisticMessageV2"),a[0],a[1],a[2],a[4],a[5],a[6]).then(function(a){return a=a,d[0]=a[0],d[1]=a[1],a})},function(e){return c.seq([function(e){return d[4]=a[6].get("external_attachment_url"),a[6],d[28]=d[4]===""?f:d[4],d[28]!==f?c.seq([function(e){return d[29]=a[6].get("attribution_app_id"),a[6],d[30]=a[6].get("optimistic_attachment_preview"),a[6],c.sp(b("LSInsertOptimisticAttachment"),a[1],d[1],d[0],d[0],d[0],c.i64.cast([0,3]),d[28],d[29],!0,!1)},function(e){return d[30]?d[31]=!1:d[31]=!0,d[31]?c.resolve():(d[32]=d[30].get("playable_url"),d[30],d[33]=d[30].get("playable_url_fallback"),d[30],d[34]=d[30].get("playable_url_expiration_timestamp_ms"),d[30],d[35]=d[30].get("playable_url_mime_type"),d[30],d[36]=d[30].get("preview_url"),d[30],d[37]=d[30].get("preview_url_fallback"),d[30],d[38]=d[30].get("preview_url_expiration_timestamp_ms"),d[30],d[39]=d[30].get("preview_url_mime_type"),d[30],d[40]=d[30].get("preview_width"),d[30],d[41]=d[30].get("preview_height"),d[30],d[42]=d[30].get("image_url"),d[30],d[43]=d[30].get("image_url_fallback"),d[30],d[44]=d[30].get("image_url_expiration_timestamp_ms"),d[30],d[45]=d[30].get("image_url_mime_type"),d[30],c.sp(b("LSUpdateOptimisticAttachmentPreview"),a[1],d[0],d[0],d[32],d[33],d[34],d[35],d[36],d[37],d[38],d[39],d[40],d[41]))},function(a){return d[5]=c.i64.cast([0,7])}]):c.seq([function(e){return d[29]=a[6].get("sticker_id"),a[6],c.i64.neq(d[29],f)?c.seq([function(e){return c.i64.neq(d[29],c.i64.cast([53057,267535043]))&&c.i64.neq(d[29],c.i64.cast([85970,924785702]))&&c.i64.neq(d[29],c.i64.cast([85970,1004785694]))&&c.i64.neq(d[29],c.i64.cast([85970,1044785690]))?c.seq([function(e){return d[33]=c.i64.to_string(d[29]),d[31]=a[6].get("optimistic_attachment_preview"),a[6],c.sp(b("LSInsertOptimisticAttachment"),a[1],d[1],d[0],c.i64.to_string(d[29]),d[33],c.i64.cast([0,1]),f,f,!0,!1)},function(e){return d[31]?d[32]=!1:d[32]=!0,d[32]?c.resolve():(d[34]=d[31].get("playable_url"),d[31],d[35]=d[31].get("playable_url_fallback"),d[31],d[36]=d[31].get("playable_url_expiration_timestamp_ms"),d[31],d[37]=d[31].get("playable_url_mime_type"),d[31],d[38]=d[31].get("preview_url"),d[31],d[39]=d[31].get("preview_url_fallback"),d[31],d[40]=d[31].get("preview_url_expiration_timestamp_ms"),d[31],d[41]=d[31].get("preview_url_mime_type"),d[31],d[42]=d[31].get("preview_width"),d[31],d[43]=d[31].get("preview_height"),d[31],d[44]=d[31].get("image_url"),d[31],d[45]=d[31].get("image_url_fallback"),d[31],d[46]=d[31].get("image_url_expiration_timestamp_ms"),d[31],d[47]=d[31].get("image_url_mime_type"),d[31],c.sp(b("LSUpdateOptimisticAttachmentPreview"),a[1],d[0],d[33],d[34],d[35],d[36],d[37],d[38],d[39],d[40],d[41],d[42],d[43]))}]):c.resolve()},function(a){return d[30]=c.i64.cast([0,2])}]):c.resolve(d[30]=c.i64.cast([0,1]))},function(a){return d[5]=d[30]}])},function(e){return c.sp(b("LSIssueNewTaskWithExtraOperationsAndGetTaskID"),c.i64.to_string(a[1]),c.i64.cast([0,46]),"",f,f,c.i64.cast([0,0]),c.i64.cast([0,0]),c.i64.cast([0,1]),f,c.i64.cast([0,0]),f).then(function(a){return a=a,d[6]=a[0],a})},function(e){return d[7]=a[6].get("data_trace_id"),a[6],d[7]!==f?c.seq([function(a){return c.sp(b("LSPredefineTraceForTask"),d[7],d[6],c.i64.to_string(c.i64.cast([0,46])),d[0])},function(e){return d[29]=a[6].get("source"),a[6],d[32]=c.i64.to_string(d[29]),d[32]!==f?d[30]=d[32]:d[30]=c.i64.to_string(c.i64.cast([0,0])),d[31]=",",c.nop(b("LSAppendDataTraceAddon.nop"),d[7],c.i64.cast([0,20]),c.i64.cast([0,1]),f,[d[30],d[31],c.i64.to_string(d[5]),d[31],c.i64.to_string(a[2])].join(""))}]):c.resolve()},function(b){return d[8]=a[6].get("source"),a[6],d[9]=a[6].get("external_attachment_url"),a[6],d[10]=a[6].get("platform_ref"),a[6],d[11]=a[6].get("platform_token"),a[6],d[12]=a[6].get("reply_source_id"),a[6],d[13]=a[6].get("reply_source_type"),a[6],d[14]=a[6].get("mark_read"),a[6],d[15]=a[6].get("initiating_app_id"),a[6],d[16]=a[6].get("initiating_source"),a[6],d[17]=a[6].get("navigation_chain"),a[6],d[18]=a[6].get("dety_params"),a[6],d[19]=a[6].get("skip_url_preview_gen"),a[6],d[20]=a[6].get("text_has_links"),a[6],c.db.table(31).add({taskId:d[6],threadKey:a[1],offlineThreadingId:d[0],threadAttributionSource:d[8],externalAttachmentUrl:d[9],platformRef:d[10],platformToken:d[11],replySourceId:d[12],replySourceType:d[13],sendType:d[5],markThreadRead:d[14]==null?!1:d[14],initiatingSource:d[16],skipUrlPreviewGen:d[19],textHasLinks:d[20]})},function(e){return d[21]=a[6].get("mark_read"),a[6],(d[21]==null?!1:d[21])?c.sp(b("LSOptimisticMarkThreadReadV2"),a[1],d[1]):c.resolve()},function(e){return d[22]=c.createArray(),d[23]=(d[22].push("optimisticSendMessageV2"),d[22]),d[24]=(d[22].push(a[1]),d[22]),d[25]=(d[22].push(d[0]),d[22]),d[26]=c.toJSON(d[22]),function(a){c.logger(a).info(a)}(d[26]),d[27]=new c.Map(),d[27].set("offline_threading_id",d[0]),d[27].set("task_id",d[6]),d[27].set("task_queue_name",c.i64.to_string(a[1])),d[27].set("task_label",c.i64.to_string(c.i64.cast([0,46]))),c.nop(b("LSLogEventAnnotate.nop"),c.i64.cast([0,16]),c.i64.cast([0,23]),c.i64.cast([0,0]),d[27])},function(a){return a=[d[0],d[6]],d[2]=a[0],d[3]=a[1],a}])},function(a){return e[0]=d[2]}])},function(a){return c.resolve(e)}])}c=a;f["default"]=c}),66);
__d("LSGetMessageAttributionParams",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[],d=[],e;return b.seq([function(f){return b.seq([function(d){return b.ftr(b.db.table(31).fetch(),function(b){return b.offlineThreadingId===a[0]}).next().then(function(a,b){var d=a.done;a=a.value;return d?(d=[e,e,e],c[0]=d[0],c[1]=d[1],c[2]=d[2],d):(b=a.item,d=[b.threadAttributionSource,b.platformRef,b.platformToken],c[0]=d[0],c[1]=d[1],c[2]=d[2],d)})},function(a){return a=[c[0],c[1],c[2]],d[0]=a[0],d[1]=a[1],d[2]=a[2],a}])},function(a){return b.resolve(d)}])}b=a;f["default"]=b}),66);
__d("LSInsertPhase2PendingTask",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[],d=[],e;return b.seq([function(f){return b.seq([function(d){return b.db.table(12).fetch([[[a[0]]],"optimistic"]).next().then(function(a,b){var d=a.done;a=a.value;return d?c[0]=e:(b=a.item,c[0]=b.threadKey)})},function(d){return b.i64.neq(c[0],e)?b.seq([function(d){return c[3]=b.i64.of_float(Date.now()),b.db.table(2).add({taskId:void 0,taskValue:a[0],queueName:[b.i64.to_string(c[0]),"_multi_media"].join(""),context:"4",enqueueTimestampMs:c[3],pluginType:a[1]})},function(a){return c[2]=e}]):b.resolve(c[2]=b.i64.cast([0,1002]))},function(a){return d[0]=c[2]}])},function(a){return b.resolve(d)}])}b=a;f["default"]=b}),66);
__d("LSMarkSubJobCompletedV2",["LSArrayGetObjectAt"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(e){return c.seq([function(b){return d[0]=c.createArray(),c.db.table(51).fetch([[[a[0]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?0:(b=a.item,d[3]=new c.Map(),d[3].set("offline_attachment_id",b.offlineAttachmentId),d[3].set("offline_threading_id",b.offlineThreadingId),d[3].set("in_message_index",b.inMessageIndex),d[3].set("attachment_type",b.attachmentType),d[3].set("should_transcode",b.shouldTranscode),d[3].set("use_double_phase",b.useDoublePhase),d[3].set("send_by_server",b.sendByServer),d[3].set("is_secure",b.isSecure),d[3].set("state",b.state),d[3].set("fbid",b.fbid),d[3].set("metadata",b.metadata),d[3].set("error",b.error),d[3].set("message_id",b.messageId),d[4]=(d[0].push(d[3]),d[0]))})},function(e){return d[2]=c.i64.of_int32(d[0].length),c.i64.neq(d[2],c.i64.cast([0,0]))?c.seq([function(a){return c.ntop("Array",b("LSArrayGetObjectAt"),d[0],c.i64.cast([0,0])).then(function(a){return a=a,d[3]=a[0],d[4]=a[1],a})},function(b){return d[5]=d[3].get("state"),d[3],c.i64.neq(a[1],f)?a[2]!==f?(c.i64.eq(d[5],c.i64.cast([-1,4294967293]))?(d[7]=c.i64.cast([-1,4294967295]),d[6]=d[7]):(c.i64.eq(d[5],c.i64.cast([0,1]))?d[7]=c.i64.cast([0,2]):(c.i64.eq(d[5],c.i64.cast([0,3]))?d[8]=c.i64.cast([0,4]):(c.i64.eq(d[5],c.i64.cast([0,5]))?d[9]=c.i64.cast([0,6]):(c.i64.eq(d[5],c.i64.cast([0,13]))?d[10]=c.i64.cast([0,14]):(c.i64.eq(d[5],c.i64.cast([0,7]))?d[11]=c.i64.cast([0,8]):(c.i64.eq(d[5],c.i64.cast([0,9]))?d[12]=c.i64.cast([0,10]):(c.i64.eq(d[5],c.i64.cast([0,11]))?d[13]=c.i64.cast([0,12]):d[13]=d[5],d[12]=d[13]),d[11]=d[12]),d[10]=d[11]),d[9]=d[10]),d[8]=d[9]),d[7]=d[8]),d[6]=d[7]),c.fe(c.db.table(51).fetch([[[a[0]]]]),function(b){var c=b.update;b.item;return c({state:d[6],fbid:a[1],messageId:a[2],metadata:a[3]})})):(c.i64.eq(d[5],c.i64.cast([-1,4294967293]))?(d[7]=c.i64.cast([-1,4294967295]),d[6]=d[7]):(c.i64.eq(d[5],c.i64.cast([0,1]))?d[7]=c.i64.cast([0,2]):(c.i64.eq(d[5],c.i64.cast([0,3]))?d[8]=c.i64.cast([0,4]):(c.i64.eq(d[5],c.i64.cast([0,5]))?d[9]=c.i64.cast([0,6]):(c.i64.eq(d[5],c.i64.cast([0,13]))?d[10]=c.i64.cast([0,14]):(c.i64.eq(d[5],c.i64.cast([0,7]))?d[11]=c.i64.cast([0,8]):(c.i64.eq(d[5],c.i64.cast([0,9]))?d[12]=c.i64.cast([0,10]):(c.i64.eq(d[5],c.i64.cast([0,11]))?d[13]=c.i64.cast([0,12]):d[13]=d[5],d[12]=d[13]),d[11]=d[12]),d[10]=d[11]),d[9]=d[10]),d[8]=d[9]),d[7]=d[8]),d[6]=d[7]),c.fe(c.db.table(51).fetch([[[a[0]]]]),function(b){var c=b.update;b.item;return c({state:d[6],fbid:a[1],metadata:a[3]})})):c.i64.neq(a[4],f)?(c.i64.eq(d[5],c.i64.cast([-1,4294967293]))?(d[7]=c.i64.cast([-1,4294967295]),d[6]=d[7]):(c.i64.eq(d[5],c.i64.cast([0,1]))?d[7]=c.i64.cast([0,2]):(c.i64.eq(d[5],c.i64.cast([0,3]))?d[8]=c.i64.cast([0,4]):(c.i64.eq(d[5],c.i64.cast([0,5]))?d[9]=c.i64.cast([0,6]):(c.i64.eq(d[5],c.i64.cast([0,13]))?d[10]=c.i64.cast([0,14]):(c.i64.eq(d[5],c.i64.cast([0,7]))?d[11]=c.i64.cast([0,8]):(c.i64.eq(d[5],c.i64.cast([0,9]))?d[12]=c.i64.cast([0,10]):(c.i64.eq(d[5],c.i64.cast([0,11]))?d[13]=c.i64.cast([0,12]):d[13]=d[5],d[12]=d[13]),d[11]=d[12]),d[10]=d[11]),d[9]=d[10]),d[8]=d[9]),d[7]=d[8]),d[6]=d[7]),c.fe(c.db.table(51).fetch([[[a[0]]]]),function(b){var c=b.update;b.item;return c({state:d[6],error:a[4]})})):(c.i64.eq(d[5],c.i64.cast([-1,4294967293]))?(d[7]=c.i64.cast([-1,4294967295]),d[6]=d[7]):(c.i64.eq(d[5],c.i64.cast([0,1]))?d[7]=c.i64.cast([0,2]):(c.i64.eq(d[5],c.i64.cast([0,3]))?d[8]=c.i64.cast([0,4]):(c.i64.eq(d[5],c.i64.cast([0,5]))?d[9]=c.i64.cast([0,6]):(c.i64.eq(d[5],c.i64.cast([0,13]))?d[10]=c.i64.cast([0,14]):(c.i64.eq(d[5],c.i64.cast([0,7]))?d[11]=c.i64.cast([0,8]):(c.i64.eq(d[5],c.i64.cast([0,9]))?d[12]=c.i64.cast([0,10]):(c.i64.eq(d[5],c.i64.cast([0,11]))?d[13]=c.i64.cast([0,12]):d[13]=d[5],d[12]=d[13]),d[11]=d[12]),d[10]=d[11]),d[9]=d[10]),d[8]=d[9]),d[7]=d[8]),d[6]=d[7]),c.fe(c.db.table(51).fetch([[[a[0]]]]),function(a){var b=a.update;a.item;return b({state:d[6]})}))}]):c.resolve()}])},function(a){return c.resolve(e)}])}c=a;f["default"]=c}),66);
__d("LSRemoveMediaSendJobs",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[];return b.seq([function(c){return b.fe(b.ftr(b.db.table(51).fetch(),function(b){return b.offlineThreadingId===a[0]}),function(a){return a["delete"]()})},function(a){return b.resolve(c)}])}b=a;f["default"]=b}),66);
__d("LSSendPhase1MultiPhotoMessageV2",["LSArrayGetObjectAt","LSGetMessageAttributionParams","LSIssueSendAttachmentMessageTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(g){return c.seq([function(b){return d[0]=c.createArray(),d[1]=new c.Map(),d[2]=new c.Map(),d[3]=!1,d[4]=c.i64.cast([0,0]),c.fe(c.sb(c.ftr(c.db.table(51).fetch(),function(b){return b.offlineThreadingId===a[0]}),[["inMessageIndex","ASC"]]),function(a){a=a.item;return d[7]=a.fbid,d[4]=c.i64.add(d[4],c.i64.cast([0,1])),c.i64.neq(d[7],f)?d[8]=(d[0].push(d[7]),d[0]):0})},function(e){return d[5]=c.i64.of_int32(d[0].length),c.i64.neq(d[5],d[4])||c.i64.eq(d[4],c.i64.cast([0,0]))?c.resolve(d[6]=c.i64.cast([0,10002])):c.seq([function(b){return c.db.table(12).fetch([[[a[0]]],"optimistic"]).next().then(function(a,b){var c=a.done;a=a.value;return c?(c=[f,f,f,f,f],d[7]=c[0],d[8]=c[1],d[9]=c[2],d[10]=c[3],d[11]=c[4],c):(b=a.item,c=[b.threadKey,b.senderId,b.text,b.replySourceId,b.replySourceTypeV2],d[7]=c[0],d[8]=c[1],d[9]=c[2],d[10]=c[3],d[11]=c[4],c)})},function(e){return c.i64.eq(d[7],f)||c.i64.eq(d[8],f)?c.resolve((c.i64.eq(d[7],f)?d[14]=c.i64.cast([0,10003]):d[14]=c.i64.cast([0,10004]),d[13]=d[14])):c.seq([function(a){return c.db.table(9).fetch([[[d[7]]]]).next().then(function(a,b){var c=a.done;a=a.value;return c?d[14]=f:(b=a.item,d[14]=b.threadType)})},function(b){return c.ftr(c.db.table(31).fetch(),function(b){return b.offlineThreadingId===a[0]}).next().then(function(a,b){var c=a.done;a=a.value;return c?(c=[f,f,f,f,f,f],d[16]=c[0],d[17]=c[1],d[18]=c[2],d[19]=c[3],d[20]=c[4],d[21]=c[5],c):(b=a.item,c=[b.platformRef,b.platformToken,b.initiatingSource,f,f,f],d[16]=c[0],d[17]=c[1],d[18]=c[2],d[19]=c[3],d[20]=c[4],d[21]=c[5],c)})},function(e){return c.i64.neq(d[14],f)?c.seq([function(e){return d[24]=d[1].keys(),d[25]=c.i64.of_int32(d[24].length),c.i64.gt(d[25],c.i64.cast([0,0]))?c.loopAsync(d[25],function(e){return d[31]=e,c.seq([function(a){return c.ntop("Array",b("LSArrayGetObjectAt"),d[24],d[31]).then(function(a){return a=a,d[32]=a[0],d[33]=a[1],a})},function(e){return d[34]=d[2].get(d[32]),d[2],d[35]=c.i64.to_string(d[34]),d[35]!==f?c.seq([function(a){return c.ntop("Array",b("LSArrayGetObjectAt"),d[24],d[31]).then(function(a){return a=a,d[36]=a[0],d[37]=a[1],a})},function(b){return d[38]=d[1].get(d[32]),d[1],c.fe(c.ftr(c.db.table(16).fetch([[[d[7],a[0],d[36]]]]),function(b){return c.i64.eq(b.threadKey,d[7])&&c.i64.eq(c.i64.cast([0,0]),c.i64.cast([0,0]))&&b.messageId===a[0]&&b.attachmentFbid===d[36]}),function(a){var b=a.update;a.item;return b({attachmentFbid:d[35],originalFileHash:d[38]})})}]):c.resolve()}])}):c.resolve()},function(e){return c.sp(b("LSGetMessageAttributionParams"),a[0]).then(function(a){return a=a,d[26]=a[0],d[27]=a[1],d[28]=a[2],a})},function(e){return c.i64.neq(d[26],f)?d[29]=d[26]:d[29]=c.i64.cast([0,0]),c.sp(b("LSIssueSendAttachmentMessageTask"),d[8],d[7],d[14],a[0],d[9],d[0],d[29],d[10],d[11],d[3],d[16],d[17],a[1])},function(a){return c.i64.ge(c.i64.cast([0,0]),c.i64.cast([0,0]))?d[30]=f:d[30]=c.i64.cast([0,10006]),d[23]=d[30]}]):c.resolve(d[23]=c.i64.cast([0,10005]))},function(a){return d[13]=d[23]}])},function(a){return d[6]=d[13]}])},function(a){return e[0]=d[6]}])},function(a){return c.resolve(e)}])}c=a;f["default"]=c}),66);
__d("LSResumeMediaSendJob",["LSInsertPhase2PendingTask","LSSendPhase1MultiPhotoMessageV2"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(g){return c.seq([function(b){return d[0]=new c.Map(),d[1]=new c.Map(),d[1].set("main_job_succeeded",!1),d[1].set("resume_failed",!1),d[1].set("error",f),d[1].set("running_sub_job_states",d[0]),d[2]=new c.Map(),d[2].set("should_transcode",!1),d[2].set("use_double_phase",!1),d[2].set("send_by_server",!1),d[2].set("is_secure",!1),d[2].set("should_dedupe",!1),c.sb(c.ftr(c.db.table(51).fetch(),function(b){return b.offlineThreadingId===a[0]}),[["state","ASC"]]).next().then(function(a,b){var c=a.done;a=a.value;return c?0:(b=a.item,d[2].set("should_transcode",b.shouldTranscode),d[2].set("use_double_phase",b.useDoublePhase),d[2].set("send_by_server",b.sendByServer),d[2].set("is_secure",b.isSecure))})},function(b){return d[4]=new c.Map(),c.fe(c.sb(c.ftr(c.db.table(51).fetch(),function(b){return b.offlineThreadingId===a[0]}),[["inMessageIndex","ASC"]]),function(a){a=a.item;return d[13]=a.offlineAttachmentId,d[11]=a.state,d[12]=a.error,c.i64.eq(d[11],c.i64.cast([-1,4294967293]))?d[10]=!0:(c.i64.eq(d[11],c.i64.cast([0,1]))?d[14]=!0:(c.i64.eq(d[11],c.i64.cast([0,3]))?d[15]=!0:(c.i64.eq(d[11],c.i64.cast([0,5]))?d[16]=!0:(c.i64.eq(d[11],c.i64.cast([0,13]))?d[17]=!0:(c.i64.eq(d[11],c.i64.cast([0,7]))?d[18]=!0:(c.i64.eq(d[11],c.i64.cast([0,9]))?d[19]=!0:(c.i64.eq(d[11],c.i64.cast([0,11]))?d[20]=!0:d[20]=!1,d[19]=d[20]),d[18]=d[19]),d[17]=d[18]),d[16]=d[17]),d[15]=d[16]),d[14]=d[15]),d[10]=d[14]),d[10]?c.resolve(c.i64.eq(d[11],c.i64.cast([0,5]))||c.i64.eq(d[11],c.i64.cast([0,11]))?0:d[4].set(d[13],d[11])):c.i64.neq(d[12],f)?c.resolve((d[1].set("resume_failed",!0),d[1].set("error",d[12]))):(c.i64.eq(d[11],c.i64.cast([-1,4294967295]))?d[14]=c.i64.cast([0,5]):(c.i64.eq(d[11],c.i64.cast([-1,4294967294]))?(d[16]=d[2].get("should_transcode"),d[2],d[15]=d[16]?c.i64.cast([0,1]):c.i64.cast([0,3])):(c.i64.eq(d[11],c.i64.cast([0,2]))?d[16]=c.i64.cast([0,3]):(c.i64.eq(d[11],c.i64.cast([0,4]))?(d[18]=d[2].get("send_by_server"),d[2],d[19]=d[2].get("use_double_phase"),d[2],d[17]=d[18]?d[19]?c.i64.cast([0,13]):f:c.i64.cast([0,5])):(c.i64.eq(d[11],c.i64.cast([0,6]))?(d[19]=d[2].get("use_double_phase"),d[2],d[18]=d[19]?c.i64.cast([0,13]):f):(c.i64.eq(d[11],c.i64.cast([0,14]))?(d[20]=d[2].get("use_double_phase"),d[2],d[21]=d[2].get("should_transcode"),d[2],d[19]=d[20]?d[21]?c.i64.cast([0,7]):c.i64.cast([0,9]):f):(c.i64.eq(d[11],c.i64.cast([0,8]))?d[20]=c.i64.cast([0,9]):(c.i64.eq(d[11],c.i64.cast([0,10]))?(d[22]=d[2].get("send_by_server"),d[2],d[21]=d[22]?f:c.i64.cast([0,11])):(c.i64.eq(d[11],c.i64.cast([0,12]))?d[22]=f:d[22]=f,d[21]=d[22]),d[20]=d[21]),d[19]=d[20]),d[18]=d[19]),d[17]=d[18]),d[16]=d[17]),d[15]=d[16]),d[14]=d[15]),c.i64.neq(d[14],f)?c.seq([function(a){return c.fe(c.db.table(51).fetch([[[d[13]]]]),function(a){var b=a.update;a.item;return b({state:d[14]})})},function(a){return c.i64.eq(d[14],c.i64.cast([0,5]))||c.i64.eq(d[14],c.i64.cast([0,11]))?0:d[4].set(d[13],d[14])}]):c.resolve())})},function(b){return c.sb(c.ftr(c.db.table(51).fetch(),function(b){return b.offlineThreadingId===a[0]}),[["state","ASC"]]).next().then(function(a,b){var c=a.done;a=a.value;return c?d[5]=f:(b=a.item,d[5]=b.state)})},function(e){return c.i64.neq(d[5],f)?(d[10]=d[2].get("send_by_server"),d[2],d[11]=d[2].get("use_double_phase"),d[2],d[12]=d[2].get("use_double_phase"),d[2],(d[10]?d[11]?c.i64.eq(d[5],c.i64.cast([0,10])):c.i64.eq(d[5],c.i64.cast([0,4])):d[12]?c.i64.eq(d[5],c.i64.cast([0,12])):c.i64.eq(d[5],c.i64.cast([0,6])))?c.resolve(d[1].set("main_job_succeeded",!0)):c.i64.eq(d[5],c.i64.cast([0,5]))?c.seq([function(b){return d[13]=f,c.fe(c.ftr(c.db.table(51).fetch(),function(b){return b.offlineThreadingId===a[0]}),function(a){a=a.item;return d[15]=a.error,c.i64.eq(d[15],f)?(c.i64.neq(a.fbid,f)?d[16]=f:d[16]=c.i64.cast([0,9]),d[14]=d[16]):d[14]=d[15],c.i64.neq(d[14],f)?d[13]=d[14]:0})},function(e){return c.i64.neq(d[13],f)?c.resolve((d[1].set("resume_failed",!0),d[1].set("error",d[13]))):c.seq([function(e){return d[14]=d[2].get("is_secure"),d[2],d[14]?c.seq([function(b){return d[16]=c.createArray(),d[17]=new c.Map(),d[18]=new c.Map(),d[19]=!1,d[20]=c.i64.cast([0,0]),c.fe(c.sb(c.ftr(c.db.table(51).fetch(),function(b){return b.offlineThreadingId===a[0]}),[["inMessageIndex","ASC"]]),function(a){a=a.item;return d[25]=a.fbid,d[20]=c.i64.add(d[20],c.i64.cast([0,1])),c.i64.neq(d[25],f)?d[26]=(d[16].push(d[25]),d[16]):0})},function(b){return d[21]=c.createArray(),c.fe(c.sb(c.ftr(c.db.table(51).fetch(),function(b){return b.offlineThreadingId===a[0]}),[["inMessageIndex","ASC"]]),function(a){a=a.item;return d[25]=a.metadata,d[25]!==f?d[26]=(d[21].push(d[25]),d[21]):0})},function(a){return d[22]=c.i64.of_int32(d[16].length),d[23]=c.i64.of_int32(d[21].length),c.i64.neq(d[22],d[20])||c.i64.neq(d[23],d[20])?d[24]=c.i64.cast([0,11]):(function(a){c.logger(a).debug(a)}("[TincanLS][LSSecureMailboxSendSecureMediaMessageStoredProcedure] Started"),function(a){c.logger(a).debug(a)}("[TincanLS][LSSecureMailboxSendSecureMediaMessageStoredProcedure] Completed"),d[24]=f),d[15]=d[24]}]):c.seq([function(e){return c.sp(b("LSSendPhase1MultiPhotoMessageV2"),a[0],a[2]).then(function(a){return a=a,d[16]=a[0],a})},function(b){return c.i64.eq(d[16],f)?c.fe(c.ftr(c.db.table(51).fetch(),function(b){return b.offlineThreadingId===a[0]}),function(a){var b=a.update;a.item;return b({state:c.i64.cast([0,6])})}):c.resolve()},function(a){return d[15]=d[16]}])},function(b){return c.i64.eq(d[15],f)?(d[16]=d[2].get("send_by_server"),d[2],d[17]=d[2].get("use_double_phase"),d[2],d[18]=d[2].get("use_double_phase"),d[2],(d[16]?d[17]?c.i64.eq(c.i64.cast([0,6]),c.i64.cast([0,10])):c.i64.eq(c.i64.cast([0,6]),c.i64.cast([0,4])):d[18]?c.i64.eq(c.i64.cast([0,6]),c.i64.cast([0,12])):c.i64.eq(c.i64.cast([0,6]),c.i64.cast([0,6])))?c.resolve(d[1].set("main_job_succeeded",!0)):(c.i64.eq(c.i64.cast([0,6]),c.i64.cast([-1,4294967295]))?d[19]=c.i64.cast([0,5]):(c.i64.eq(c.i64.cast([0,6]),c.i64.cast([-1,4294967294]))?(d[21]=d[2].get("should_transcode"),d[2],d[20]=d[21]?c.i64.cast([0,1]):c.i64.cast([0,3])):(c.i64.eq(c.i64.cast([0,6]),c.i64.cast([0,2]))?d[21]=c.i64.cast([0,3]):(c.i64.eq(c.i64.cast([0,6]),c.i64.cast([0,4]))?(d[23]=d[2].get("send_by_server"),d[2],d[24]=d[2].get("use_double_phase"),d[2],d[22]=d[23]?d[24]?c.i64.cast([0,13]):f:c.i64.cast([0,5])):(c.i64.eq(c.i64.cast([0,6]),c.i64.cast([0,6]))?(d[24]=d[2].get("use_double_phase"),d[2],d[23]=d[24]?c.i64.cast([0,13]):f):(c.i64.eq(c.i64.cast([0,6]),c.i64.cast([0,14]))?(d[25]=d[2].get("use_double_phase"),d[2],d[26]=d[2].get("should_transcode"),d[2],d[24]=d[25]?d[26]?c.i64.cast([0,7]):c.i64.cast([0,9]):f):(c.i64.eq(c.i64.cast([0,6]),c.i64.cast([0,8]))?d[25]=c.i64.cast([0,9]):(c.i64.eq(c.i64.cast([0,6]),c.i64.cast([0,10]))?(d[27]=d[2].get("send_by_server"),d[2],d[26]=d[27]?f:c.i64.cast([0,11])):(c.i64.eq(c.i64.cast([0,6]),c.i64.cast([0,12]))?d[27]=f:d[27]=f,d[26]=d[27]),d[25]=d[26]),d[24]=d[25]),d[23]=d[24]),d[22]=d[23]),d[21]=d[22]),d[20]=d[21]),d[19]=d[20]),c.i64.neq(d[19],f)?c.seq([function(b){return c.fe(c.ftr(c.db.table(51).fetch(),function(b){return b.offlineThreadingId===a[0]}),function(a){var b=a.update;a.item;return b({state:d[19]})})},function(b){return c.fe(c.ftr(c.db.table(51).fetch(),function(b){return b.offlineThreadingId===a[0]}),function(a){a=a.item;return d[4].set(a.offlineAttachmentId,a.state)})}]):c.resolve())):c.resolve((d[1].set("resume_failed",!0),d[1].set("error",d[15])))}])}]):c.i64.eq(d[5],c.i64.cast([0,11]))?c.seq([function(b){return d[13]=f,c.fe(c.ftr(c.db.table(51).fetch(),function(b){return b.offlineThreadingId===a[0]}),function(a){a=a.item;return d[14]=a.error,c.i64.neq(d[14],f)?d[13]=d[14]:0})},function(a){return c.i64.neq(d[13],f)?(d[1].set("resume_failed",!0),d[1].set("error",d[13])):d[1].set("main_job_succeeded",!0)}]):c.i64.eq(d[5],c.i64.cast([0,13]))?c.seq([function(e){return c.sp(b("LSInsertPhase2PendingTask"),a[0],a[1]).then(function(a){return a=a,d[13]=a[0],a})},function(b){return c.i64.neq(d[13],f)?c.resolve((d[1].set("resume_failed",!0),d[1].set("error",d[13]))):c.seq([function(b){return c.fe(c.ftr(c.db.table(51).fetch(),function(b){return b.offlineThreadingId===a[0]}),function(a){var b=a.update;a.item;return b({state:c.i64.cast([0,14])})})},function(b){return d[1].set("main_job_succeeded",!0),c.fe(c.ftr(c.db.table(51).fetch(),function(b){return b.offlineThreadingId===a[0]}),function(a){a=a.item;return d[4].set(a.offlineAttachmentId,a.state)})}])}]):c.resolve(0)):c.resolve((d[1].set("resume_failed",!0),d[1].set("error",c.i64.cast([0,11]))))},function(a){return d[7]=d[1].get("main_job_succeeded"),d[1],d[8]=d[1].get("resume_failed"),d[1],d[9]=d[1].get("error"),d[1],a=[d[7],d[8],d[9],d[4]],e[0]=a[0],e[1]=a[1],e[2]=a[2],e[3]=a[3],a}])},function(a){return c.resolve(e)}])}c=a;f["default"]=c}),66);
__d("MWChatForwardDialogQuery$Parameters",["MWChatForwardDialogQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a={kind:"PreloadableConcreteRequest",params:{id:b("MWChatForwardDialogQuery_facebookRelayOperation"),metadata:{},name:"MWChatForwardDialogQuery",operationKind:"query",text:null}};e.exports=a}),null);
__d("MAWDbThread",["MAWHexUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return d("MAWHexUtils").orderPreservingHex(a)+"_"+b}g.craftThreadOrder=a}),98);
__d("dexie_maw",["dexie-4.0.1-alpha.22"],(function(a,b,c,d,e,f){e.exports=b("dexie-4.0.1-alpha.22")()}),null);
__d("MAWDexieTable",["Promise","dexie_maw"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return b("Promise").resolve(a)}function a(a){return a.reduce(function(a,b,c){return a.then(function(a){return b(c).then(function(b){a.push(b);return a})})},l([]))}function e(a){return c("dexie_maw").Promise.all(a)}function f(a){return c("dexie_maw").Promise.PSD[a]}function i(a,b){c("dexie_maw").Promise.PSD[a]=b}function j(a){c("dexie_maw").Promise.PSD[a]=void 0}var k=function(){function a(a,b,d,e){d===void 0&&(d=!0);e=new(c("dexie_maw"))(a,babelHelpers["extends"]({chromeTransactionDurability:"relaxed"},e));b(e);this.name=a;this.stores=e;d&&this.open()}var b=a.prototype;b.open=function(){this.stores.open()};b.close=function(){this.stores.close()};b.transact=function(a,b,c){var d=this;return h(this.stores.transaction(a,b.map(function(a){return d.stores[a]}),function(){return c()}))};return a}();function l(a){return c("dexie_maw").Promise.resolve(a)}function m(a){return c("dexie_maw").waitFor(a)}g.DEXIE_MIN_KEY=d("dexie_maw").Dexie.minKey;g.DEXIE_MAX_KEY=d("dexie_maw").Dexie.maxKey;g.dexieSequentialAll=a;g.dexieAll=e;g.getDexiePSDItem=f;g.setDexiePSDItem=i;g.clearDexiePSDItem=j;g.DexieTable=k;g.dexieResolve=l;g.dexieExpensiveAwait=m}),98);
__d("SignalDbTypes",[],(function(a,b,c,d,e,f){"use strict";function a(a,b,c){return a+"_"+b+"_"+c}b={abProps:"abProps",authKeyPair:"authKeyPair",cat:"cat",certificateChain:"certificateChain",clockSkew:"clockSkew",deviceId:"deviceId",deviceUUID:"deviceUUID",edgeInfo:"edgeInfo",fbid:"fbid",identityKeyPair:"identityKeyPair",lastPrekeyGenerationId:"lastPrekeyGenerationId",lastPrekeyId:"lastPrekeyId",lastSessionDeviceWasLinkedTo:"lastSessionDeviceWasLinkedTo",lastSignedPrekeyId:"lastSignedPrekeyId",regId:"regId",registrationVersion:"registrationVersion"};({msgrDeviceId:"msgrDeviceId"});f.buildSenderKeySessionId=a;f.MetaKeysEnum=b}),66);
__d("MAWDbSchema",["MAWDbMsg","MAWDbThread","MAWDexieTable","MAWFolderTypes","MAWLocalizationType","MAWMsgType","MAWODSProxy","MAWTimeUtils","MAWWaitForBackendSetup","SignalDbTypes","WAJids","WAOdsEnums","WAStanzaUtils","WATimeUtils","dexie_maw","promiseDone","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";a={appData:"++appDataId,&externalId",appMeta:"key",browserEncryptionMeta:"++id, &version",chunk:"++chunkId, &hashedPlaintextHash",contacts:"contactJid",existingUsers:"id",ftsBackloggedMessages:"rowId",ftsEncryptionMeta:"key",ftsIndexV3:"++ftsRowId,id,chatId,*prefixes",groupInfo:"groupJid,threadId",identity:"deviceJid",jobs:"++jobId,&uniqKey",media:"++mediaId, &hashedPlaintextHash, *msgIds",messages:"++rowId,externalId,thread,msgId,altIndex,messageExpirationTs,messageDeleteTs,quoteExternalId",meta:"key",participants:"id,threadId,userJid",pendingReceipts:"id",pendingStanzas:"++rowId,externalIdWithType",personalSenderKeyStatuses:"groupJid",prekey:"keyId",prekeyGeneration:"generationId",reactions:"++rowId,reactionId,externalId,reactToMsgId,threadJid,reactToExternalId",receipts:"msgId",senderKeySessions:"id,groupJid,userJid",session:"id",signedPrekey:"keyId",tasks:"taskName",threads:"++chatId,&jid,threadOrder",unrenderedMessages:"++rowId,externalId,thread,msgId"};b={messages:"++rowId,externalId,thread,msgId,altIndex,messageExpirationTs,messageDeleteTs,quoteExternalId,unsendMsgContentDeleteTs"};e={messages:"++rowId,externalId,thread,msgId,altIndex,messageExpirationTs,messageDeleteTs,quoteExternalId,unsendMsgContentDeleteTs,revokedExternalId"};f={isDualSend:"++rowId"};var h={historySyncQRCodeSecretKey:"key"},i={unrenderedMessages:"++rowId,externalId,thread,msgId,messageDeleteForMeTs"},j={messages:"++rowId,externalId,thread,msgId,altIndex,messageExpirationTs,messageDeleteTs,quoteExternalId,unsendMsgContentDeleteTs,revokedExternalId,threadJid",unrenderedMessages:"++rowId,externalId,thread,msgId,messageDeleteForMeTs,threadJid"},k={groupInvites:"invitedParticipantId, inviterJid"},l={pendingStanzas:"++rowId,externalIdWithType, deleteTs"},m={media:"++mediaId, &hashedPlaintextHash, *msgIds, &objectId, &fbid"},n={dualSendMedia:"++id"},o={xma:"++xmaId, associatedMessageId, faviconMediaId, headerMediaId, targetExpiringAtSec, defaultPreviewMediaId"},p={historySyncQRCodeData:"rowId"},q={xma:"++xmaId, externalId, associatedMessageId, faviconMediaId, headerMediaId, targetExpiringAtSec, defaultPreviewMediaId"},r={dyiBatch:"++batchId"},s={groupInfo:"groupJid,threadId,correspondingOpenThreadKey"},t=null;t={groupInvites:t};var u={groupInvites:"[invitedParticipantId+inviterJid], inviterJid"},v={messages:"++rowId,externalId,thread,msgId,altIndex,messageExpirationTs,messageDeleteTs,quoteExternalId,unsendMsgContentDeleteTs,revokedExternalId,threadJid,[thread+sortOrderMs]",unrenderedMessages:"++rowId,externalId,thread,msgId,messageDeleteForMeTs,threadJid,[thread+sortOrderMs]"},w={syncActions:"index,collection,actionState,indexMac,action,[modelId+modelType+actionState]"},x={missingKeys:"keyHex"},y={pendingMutations:"++id,action,index,collection"},z={collectionVersions:"++id,&collection"},A={syncKeys:"++id,&keyId,keyEpoch"},B={identity:"deviceJid,userJid"},C={uploadRetryStatus:"[externalId+lastRetryTs], lastRetryTs, traceId"},D={stanzaQueue:"++stanzaQueueId,stanzaId,jid,type"},E={deviceChangeAlerts:"++deviceChangeAlertsId"},F={retroactiveBackupsState:"threadId"},G={threads:"++chatId,&jid,threadOrder,&deduplicationKey"},H={mediaBackup:"++mediaBackupId,&objectId,mediaId,msgId"},I={threads:"++chatId,&jid,threadOrder,&deduplicationKey,&authoritativeThreadKey"},J={stanzaQueue:"++stanzaQueueId,stanzaId,jid,type,[jid+type]"},K={editMsgHistory:"++editMsgHistoryId,originalMsgExternalId,threadJid"},L=function(a){var b=function(a){var b;b=(b=a.quote)==null?void 0:b.content;return a.quoteExternalId!=null&&(b==null?void 0:b.media)!=null};return a.messages.where("quoteExternalId").between(d("WAStanzaUtils").toStanzaId("0"),d("WAStanzaUtils").toStanzaId("["),!0,!0).filter(b).toArray()["catch"](function(){return a.messages.filter(b).toArray()}).then(function(b){var c=new Set(b.map(function(a){a=(a=a.quote)==null?void 0:a.content;return a==null?void 0:(a=a.media)==null?void 0:a.plaintextHash}).filter(Boolean)),d=b.map(function(a){a=a.msgId;return a});return a.media.filter(function(a){a=a.plaintextHash;return c.has(a)}).toArray().then(function(b){var c=new Map(b.map(function(a){var b=a.mediaId;a=a.plaintextHash;return[a,b]}));return a.messages.where("msgId").anyOf(d).modify(function(a){var b;b=(b=a.quote)==null?void 0:b.content;a.quote.content.mediaId=c.get(b.media.plaintextHash);delete a.quote.content.media})})})},M=function(a){return a.groupInfo.toCollection().modify(function(a){typeof a.inviter==="number"&&delete a.inviter})},N=function(a){return a.meta.get(d("SignalDbTypes").MetaKeysEnum.deviceId).then(function(b){var c;if((b==null?void 0:(c=b.value)==null?void 0:c.deviceId)!=null&&typeof b.value.deviceId!=="number")return a.meta.clear()})},O=function(a){return a.threads.filter(function(a){return d("WAJids").switchOnMsgrChatJidType(a.jid,{group:function(){return!1},user:function(){return a.oldestMsg!=null}})}).toArray().then(function(b){var c=[];b.forEach(function(a){c.push(a.oldestMsg),c.push(a.newestMsg)});return a.messages.where("msgId").anyOf(c.filter(Boolean)).toArray().then(function(c){var e=new Map(),f=[],g=[];c.forEach(function(a){e.set(a.msgId,a)});b.forEach(function(b){var c=e.get(b.oldestMsg),h=e.get(b.newestMsg);(c==null?void 0:c.type)==="Admin"&&(h==null?void 0:h.type)==="Admin"&&(c.msgId===h.msgId?g.push(b.chatId):f.push(b));return d("MAWDexieTable").dexieAll(f.map(function(b){return a.messages.where("thread").equals(b.chatId).toArray()})).then(function(b){b.forEach(function(a){if(a.length===0)return;var b=a[0].thread;a=a.filter(function(a){return a.type!=="Admin"});if(a.length>0)return;g.push(b)});return d("MAWDexieTable").dexieAll([a.threads.bulkDelete(g),a.messages.where("thread").anyOf(g)["delete"]()])})})})})},P=function(a){return a.unrenderedMessages.toCollection().modify(function(a){if(a.type===d("MAWMsgType").MSG_TYPE.DELETE_FOR_ME){var b=a.messageDeleteForMeTs;a.messageDeleteForMeTs=b}})},Q=function(a){var b=0,e=0,f=c("dexie_maw").currentTransaction;if(f==null)throw c("unrecoverableViolation")("transaction does not exist","messenger_e2ee_web");f.on("complete",function(){c("promiseDone")(d("MAWWaitForBackendSetup").waitForBackendSetup("DB upgrade to V31").then(function(){b>0&&d("MAWODSProxy").odsBumpEntityKey({amount:b,entity:d("WAOdsEnums").Entity.MESSAGE_MISSING_THREAD_JID,key:"fail"}),e>0&&d("MAWODSProxy").odsBumpEntityKey({amount:e,entity:d("WAOdsEnums").Entity.MESSAGE_MISSING,key:"fail"})}))});f.on("complete",function(){b>0&&d("MAWODSProxy").odsBumpEntityKey({amount:b,entity:d("WAOdsEnums").Entity.MESSAGE_MISSING_THREAD_JID,key:"fail"}),e>0&&d("MAWODSProxy").odsBumpEntityKey({amount:e,entity:d("WAOdsEnums").Entity.MESSAGE_MISSING,key:"fail"})});return a.threads.toArray().then(function(c){var f=c.reduce(function(a,b){b!=null&&a.set(b.chatId,b);return a},new Map());return d("MAWDexieTable").dexieAll([a.messages.toCollection().modify(function(a){if(a!=null){var c=f.get(a.thread);c!=null?a.threadJid=c.jid:(a.threadJid=null,b+=1)}else e+=1}),a.unrenderedMessages.toCollection().modify(function(a){if(a!=null){var c=f.get(a.thread);c!=null?a.threadJid=c.jid:(a.threadJid=null,b+=1)}else e+=1})])})},R=function(a){return a.isDualSend.toCollection().modify(function(a){a.version==null&&(a.version=1)})},S=function(a){return a.messages.toCollection().modify(function(a){a.type===d("MAWMsgType").MSG_TYPE.ADMIN&&a.msgContent.adminType===d("MAWLocalizationType").LOCALIZATION_TYPE.E2EE_THREAD_DESCRIPTION&&(a.altIndex=d("MAWDbMsg").craftE2eeAdminMsgAltIndex(a.thread))})},T=function(a){return a.messages.toCollection().modify(function(a){a.sortOrderMs=d("MAWDbMsg").getSortOrderWithFallback(a)})},U=function(a){return a.threads.toCollection().modify(function(a){a.folder==null&&(a.folder=d("MAWFolderTypes").FOLDER_ID.INBOX)})},V=function(a){return a.messages.toCollection().modify(function(a){a.sortOrderMs=d("MAWDbMsg").getSortOrderWithFallback(a)})},W=function(a){return a.personalSenderKeyStatuses.toCollection().modify(function(a){a.rotateSenderKey=!0,a.hasSenderKey=new Set()})},X=function(a){return a.messages.toCollection().modify(function(a){a.type===d("MAWMsgType").MSG_TYPE.ADMIN&&a.msgContent.adminType===d("MAWLocalizationType").LOCALIZATION_TYPE.CUTOVER_THREAD_ADMIN_MESSAGE&&a.sortOrderMs!=null&&a.sortOrderMs>0&&(a.sortOrderMs=0)})},Y=function(a){return a.messages.toCollection().modify(function(a){!(a.type===d("MAWMsgType").MSG_TYPE.ADMIN&&(a.msgContent.adminType===d("MAWLocalizationType").LOCALIZATION_TYPE.CUTOVER_THREAD_ADMIN_MESSAGE||a.msgContent.adminType===d("MAWLocalizationType").LOCALIZATION_TYPE.E2EE_THREAD_DESCRIPTION))&&a.sortOrderMs!=null&&a.sortOrderMs<1661204086&&(a.sortOrderMs=d("MAWDbMsg").getCanonicalTsFromMsg(a)*1e3)})},Z=function(a){return a.threads.filter(function(a){return a.isMigratedLocally===!0&&a.newestMsg!=null}).toArray().then(function(b){var c=b.map(function(a){return a.chatId}),e=new Map();return d("MAWDexieTable").dexieAll(b.map(function(b){return a.messages.where(["thread","sortOrderMs"]).between([b.chatId,0],[b.chatId,Number.MAX_VALUE]).last().then(function(a){a!=null&&e.set(a.thread,a.msgId)})})).then(function(){return a.threads.where("chatId").anyOf(c).modify(function(a){var b=e.get(a.chatId);b!=null&&(a.newestMsg=b)})})})},$=function(a){return a.identity.toCollection().modify(function(a){a.userJid=d("WAJids").extractUserJid(a.deviceJid)})},aa=function(a){return a.threads.toCollection().modify(function(a){a.lastReadMsgTs!=null&&a.lastReadMsgTs<d("WATimeUtils").MAX_INT&&(a.lastReadMsgTs=d("MAWTimeUtils").ensureValidMillisTime(a.lastReadMsgTs));if(a.newestMsgTs!=null&&a.newestMsgTs<d("WATimeUtils").MAX_INT){var b=d("MAWTimeUtils").ensureValidMillisTime(a.newestMsgTs);a.newestMsgTs=b;b!=null&&(a.threadOrder=d("MAWDbThread").craftThreadOrder(b,a.jid))}})},ba=function(a){return a.messages.toCollection().modify(function(a){a.type===d("MAWMsgType").MSG_TYPE.ADMIN&&a.msgContent.adminType===d("MAWLocalizationType").LOCALIZATION_TYPE.CUTOVER_THREAD_ADMIN_MESSAGE&&(a.altIndex=d("MAWDbMsg").craftCutoverAdminMsgAltIndex(a.thread))})},ca=function(a){return a.meta.get(d("SignalDbTypes").MetaKeysEnum.fbid).then(function(b){var c;if((b==null?void 0:(c=b.value)==null?void 0:c.fbid)!=null&&b.value.fbid==="0")return a.meta.clear()})},da=function(a){return a.prekey.filter(function(a){return a.isDeleted===!0})["delete"]()};a=[{schema:a,version:21},{schema:b,version:22},{schema:e,version:23},{schema:f,version:24},{schema:h,version:25},{upgrade:L,version:26},{upgrade:M,version:27},{upgrade:N,version:28},{upgrade:O,version:29},{schema:i,upgrade:P,version:30},{schema:j,upgrade:Q,version:31},{schema:k,version:32},{schema:l,version:33},{schema:m,version:34},{schema:n,version:35},{schema:o,version:36},{schema:p,version:37},{schema:q,version:38},{schema:r,version:39},{schema:s,version:40},{schema:t,version:41},{schema:u,version:42},{upgrade:R,version:43},{upgrade:S,version:44},{schema:v,upgrade:T,version:45},{upgrade:U,version:46},{upgrade:V,version:47},{schema:w,version:48},{schema:x,version:49},{schema:y,version:50},{schema:z,version:51},{schema:A,version:52},{upgrade:W,version:53},{upgrade:X,version:54},{upgrade:Y,version:55},{upgrade:Z,version:56},{schema:B,upgrade:$,version:57},{upgrade:aa,version:58},{schema:C,version:59},{upgrade:ba,version:60},{schema:D,version:61},{schema:E,version:62},{schema:F,version:63},{schema:G,version:64},{schema:H,version:65},{upgrade:ca,version:66},{schema:I,version:67},{upgrade:da,version:68},{schema:J,version:69},{schema:K,version:70}];b=["messages","unrenderedMessages","groupInfo","meta","identity","prekey","prekeyGeneration","session","signedPrekey","senderKeySessions","receipts","pendingReceipts","threads","contacts","participants","tasks","personalSenderKeyStatuses","appData","appMeta","chunk","mediaBackup","media","reactions","groupInvites","dyiBatch","syncActions","missingKeys","pendingMutations","collectionVersions","syncKeys","deviceChangeAlerts","xma","retroactiveBackupsState","editMsgHistory"];g.MAW_DB_VERSION_CHANGES=a;g.TABLES_TO_ENCRYPT=b}),98);
__d("MAWDbVersion",["MAWDbSchema","MAWGating","Promise","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[DB] version is not set in QE"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[DB] maybe version: ",""]);i=function(){return a};return a}function j(a){return d("MAWDbSchema").MAW_DB_VERSION_CHANGES.filter(function(b){var c=b.schema;b=b.version;return b<=a&&c!=null}).reduce(function(a,b){b=b.schema;return Object.assign(a,b)},{})}e=d("MAWGating").getArmadilloDbVersion==null?void 0:d("MAWGating").getArmadilloDbVersion();f=j(Math.min(d("MAWDbSchema").MAW_DB_VERSION_CHANGES[d("MAWDbSchema").MAW_DB_VERSION_CHANGES.length-1].version,e!=null&&e>0?e:Infinity));function k(a,b){var c=b.schema,d=b.upgrade;b=b.version;c!=null&&d!=null?a.version(b).stores(c).upgrade(d):c!=null?a.version(b).stores(c):d!=null?a.version(b).upgrade(d):a.version(b);return b}function a(a){return new(b("Promise"))(function(b){if(!indexedDB){b();return}var c=indexedDB.open(a);c.onsuccess=function(a){a=a.target.result;var c=a==null?void 0:a.version;a==null?void 0:a.close();c!=null?b(c/10):b()};c.onerror=function(){b()}})}function l(a,b){if(b.upgrade!=null)return!0;a=Object.keys((a==null?void 0:a.schema)||{});b=Object.keys((b==null?void 0:b.schema)||{});a=[].concat(a,b);b=new Set(a);return b.size!==a.length}function m(a){return a.reduce(function(a,b,c){if(c===0)return[babelHelpers["extends"]({},b,{schema:j(b.version)})];c=a[a.length-1];if(l(c,b)){a.push(b);return a}a.splice(a.length-1,1,babelHelpers["extends"]({},b,{schema:babelHelpers["extends"]({},c==null?void 0:c.schema,b.schema)}));return a},[])}function c(a,b,c){var e=null,f=c!=null?c:d("MAWGating").getArmadilloDbVersion==null?void 0:d("MAWGating").getArmadilloDbVersion();d("WALogger").DEV(i(),f);f==null&&d("WALogger").WARN(h());c=d("MAWDbSchema").MAW_DB_VERSION_CHANGES.filter(function(a){a=a.version;return b==null||a>b}).filter(function(a){a=a.version;return f==null||f>=a});var g=d("MAWDbSchema").MAW_DB_VERSION_CHANGES.filter(function(a){a=a.version;return f==null||f>=a});if(c.length===0||c.length===g.length){g=d("MAWDbSchema").MAW_DB_VERSION_CHANGES[d("MAWDbSchema").MAW_DB_VERSION_CHANGES.length-1].version;g=Math.min(f!=null&&f>0?f:g,g);a.version(g).stores(j(g));return}g=m(c);g.forEach(function(b){e=Math.max((b=k(a,b))!=null?b:0,(b=e)!=null?b:0)});return e}g.CURRENT_MAW_STORES=f;g.getDexieDbVersion=a;g.updateDB=c}),98);
__d("MAWDexieError",[],(function(a,b,c,d,e,f){"use strict";a="ModifyError";b="BulkError";c="OpenFailedError";d="VersionChangeError";e="SchemaError";var g="UpgradeError",h="InvalidTableError",i="MissingAPIError",j="NoSuchDatabaseError",k="InvalidArgumentError",l="SubTransactionError",m="UnsupportedError",n="InternalError",o="DatabaseClosedError",p="PrematureCommitError",q="ForeignAwaitError",r="UnknownError",s="ConstraintError",t="DataError",u="TransactionInactiveError",v="ReadOnlyError",w="VersionError",x="NotFoundError",y="InvalidStateError",z="InvalidAccessError",A="AbortError",B="TimeoutError",C="QuotaExceededError",D="SyntaxError",E="DataCloneError";A={AbortError:A,BulkError:b,ConstraintError:s,DatabaseClosedError:o,DataCloneError:E,DataError:t,ForeignAwaitError:q,InternalError:n,InvalidAccessError:z,InvalidArgumentError:k,InvalidStateError:y,InvalidTableError:h,MissingAPIError:i,ModifyError:a,NoSuchDatabaseError:j,NotFoundError:x,OpenFailedError:c,PrematureCommitError:p,QuotaExceededError:C,ReadOnlyError:v,SchemaError:e,SubTransactionError:l,SyntaxError:D,TimeoutError:B,TransactionInactiveError:u,UnknownError:r,UnsupportedError:m,UpgradeError:g,VersionChangeError:d,VersionError:w};f.DEXIE_ERROR=A}),66);
__d("MAWIDbSetupQpl",["MAWQplProxy","qpl"],(function(a,b,c,d,e,f,g){"use strict";a=d("MAWQplProxy").startQplUserFlow(c("qpl")._(1056836116,"905"));b=a;g["default"]=b}),98);
__d("MAWIDbSetupQplEventListener",["MAWDexieError"],(function(a,b,c,d,e,f,g){"use strict";var h,i=null;function j(a){var b=new Set(Object.keys(d("MAWDexieError").DEXIE_ERROR));b.has(a.reason)&&h!=null&&(h.endFail(a.reason),i!=null&&(i(),i=null))}b=function(b,c){h=b,i=c,a.addEventListener("unhandledrejection",j)};g.trackDbSetupFailure=b}),98);
__d("MAWDataSyncQueue",["MAWQplProxy","Promise","WALogger","asyncToGeneratorRuntime","promiseDone","qex","qpl","throttle"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unhandled exception caught in middleware "," sync: ",""]);h=function(){return a};return a}var i=c("qex")._("853")||1e3;a=c("qex")._("855")||1e3;e=function(){l=!1,c("promiseDone")(q({isUnloading:!0}))};var j=[],k=[],l=!1,m=[],n=function(){var a,b=j.splice(0,j.length);(a=k).push.apply(a,b)},o=function(){return k.splice(0,i)},p=function a(c,e){var f=o();if(f.length===0)return;c.addPoint("processing_batch");return b("Promise").all(m.map(function(a,b){return a(f,e)["catch"](function(a){d("WALogger").ERROR(h(),b,a)})})).then(function(){return a(c,e)})},q=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(l)return;l=!0;var b=d("MAWQplProxy").startQplUserFlow(c("qpl")._(1056849784,"272"));b.addPoint("processing_queue",{"int":{queueSize:j.length}});n();try{yield p(b,a),b.endSuccess()}catch(a){b.endFail("handler_failed_execution");throw a}finally{l=!1,j.length>0&&r()}});return function(b){return a.apply(this,arguments)}}(),r=c("throttle")(q,a);f=function(a,b){j.push({type:a,value:b}),r()};a=function(a){m.some(function(b){return b===a})||m.push(a)};var s=function(){m=[]},t=function(){j=[],k=[]},u=function(){return j};g.forceFlushDataSyncQueue=e;g.addSyncItem=f;g.registerDataSyncCallback=a;g.clearDataSyncCallbacks=s;g.clearDataSyncQueue_FOR_TESTING_ONLY=t;g.getDataSyncQueue_FOR_TESTING_ONLY=u}),98);
__d("MAWDataSyncMiddleware",["FBLogger","MAWDataSyncQueue"],(function(a,b,c,d,e,f,g){"use strict";var h=new Set(["contacts","groupInfo","messages","participants","threads","reactions","dyiBatch","xma","pendingStanzas"]);function i(a,b){var c=a.table(b);return!h.has(b)?c:babelHelpers["extends"]({},c,{mutate:function(a){return c.mutate(a).then(function(c){if(a.type==="delete"){a.keys.forEach(function(c){d("MAWDataSyncQueue").addSyncItem(a.type,{key:c,tableName:b})});return c}else c.results!=null?c.results.forEach(function(c){d("MAWDataSyncQueue").addSyncItem(a.type,{key:c,tableName:b,values:a.values})}):c.lastResult!=null&&d("MAWDataSyncQueue").addSyncItem(a.type,{key:c.lastResult,tableName:b,values:a.values});return c})}})}function a(){return{create:function(a){try{return babelHelpers["extends"]({},a,{table:function(b){return i(a,b)}})}catch(b){c("FBLogger")("mpf_web_foundations").catching(b).mustfix("Error applying DataSync Middleware, messages made during this session will not be properly synced to registered consumers");return a}},name:"MAWDataSyncMiddleware",stack:"dbcore"}}g.getDataSyncMiddleware=a}),98);
__d("MAWIndexedDbParams",["justknobx"],(function(a,b,c,d,e,f,g){"use strict";a=function(){return c("justknobx")._("1462")};b=function(){return c("justknobx")._("1463")};g.getMaxAfterTransactionWaitMs=a;g.getMaxAfterTransactionBatchSize=b}),98);
__d("MAWIndexedDb",["Deferred","MAWBridge","MAWCurrentUser","MAWDataSyncMiddleware","MAWDbMutationMiddleware","MAWDbSchema","MAWDbVersion","MAWDexieTable","MAWIDbSetupQpl","MAWIDbSetupQplEventListener","MAWIndexedDBDeletion","MAWIndexedDbMetadata","MAWIndexedDbParams","MAWTransactor","Promise","WALogger","WAWorkerGlobalScope","asyncToGeneratorRuntime","cr:7096","dexie_maw","err","gkx","promiseDone","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[DB] actual version: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[afterTransaction] afterTransactionForThreadEvent called outside of dexie transaction"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[afterTransaction] AfterTransaction failed to sync data to the UI ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[afterTransaction] called outside of dexie transaction"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[afterTransactionEffect] called outside of dexie transaction"]);l=function(){return a};return a}var m=null,n=null,o=new(c("Deferred"))(),p=!1;function q(){o=null,p=!1}function a(a,b,c){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){b=b===void 0?{enableDataSyncMiddleware:!0}:b;var f=b.enableDataSyncMiddleware;b=babelHelpers.objectWithoutPropertiesLoose(b,["enableDataSyncMiddleware"]);var g=d("MAWCurrentUser").getID();if(m!=null)return;if(p){var i;return(i=o)==null?void 0:i.getPromise()}p=!0;o=(i=o)!=null?i:new(c("Deferred"))();d("MAWIDbSetupQplEventListener").trackDbSetupFailure(c("MAWIDbSetupQpl"),function(){var a;(a=o)==null?void 0:a.reject();q()});n=d("MAWIndexedDbMetadata").dbName(g);var j=(yield d("MAWDbVersion").getDexieDbVersion(n));m=new(d("MAWDexieTable").DexieTable)(n,function(b){f&&b.use(d("MAWDataSyncMiddleware").getDataSyncMiddleware());a!=null&&b.use(d("MAWDbMutationMiddleware").getMAWDbMutationMiddleware(a));var g=d("MAWDbVersion").updateDB(b,j,e);d("WALogger").DEV(h(),g);c("MAWIDbSetupQpl").addPoint("database_version_upgraded ",{"int":{dbVersion:g}});b.on("ready",function(a){var b;(b=o)==null?void 0:b.resolve();q();if(a==null){d("WALogger").ERROR(["DB is null"]);return}c("MAWIDbSetupQpl").endSuccess({"int":{dbVersion:g}})});b.on("versionchange",function(){var a=g!=null?g-1:0;c("MAWIDbSetupQpl").addPoint("database_version_upgraded ",{"int":{prev_db_version:a}});d("WAWorkerGlobalScope").workerGlobalScope.location.reload==null?void 0:d("WAWorkerGlobalScope").workerGlobalScope.location.reload()})},void 0,b)});return r.apply(this,arguments)}function s(a){if(m==null){throw c("err")('IndexDB has not been initialized before executing "'+((a=a)!=null?a:"unnamed")+'"')}return m}function t(a){var d;if(m!=null)return b("Promise").resolve(m);o=(d=o)!=null?d:new(c("Deferred"))();return o.getPromise().then(function(){return s(a)})}function e(){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield t());a!=null&&(a.close(),m=null)});return u.apply(this,arguments)}function f(a){m=a}var v=new WeakMap(),w=new WeakMap();function x(a){var b=c("dexie_maw").currentTransaction;if(b==null){d("WALogger").ERROR(l());throw c("unrecoverableViolation")("afterTransactionEffect called outside of dexie transaction","messenger_e2ee_web")}if(typeof a!=="function")return;var e=v.get(b)||[];e.push(a);v.set(b,e);e.length===1&&b.on("complete",function(){var a=v.get(b)||[];a.forEach(function(a){a()});v["delete"](b)})}function y(a){var b=new(c("Deferred"))();a.on("complete",function(){b.resolve()});return b.getPromise()}var z=function(a){return new(b("Promise"))(function(b){return window.setTimeout(b,a)})};function A(a){var c=w.get(a);c!=null&&c.length>0&&(w["delete"](a),b("cr:7096")==null?d("MAWBridge").getBridge().fireAndForget("event","uiUpdate",{events:c}):b("cr:7096").handleEvents(c))}function B(a){return b("Promise").race([y(a),z(d("MAWIndexedDbParams").getMaxAfterTransactionWaitMs())]).then(function(){A(a)})}function C(a){var e,f=c("dexie_maw").currentTransaction;if(f==null){d("WALogger").ERROR(k());throw c("unrecoverableViolation")("afterTransaction called outside of dexie transaction","messenger_e2ee_web")}if(typeof a.value==="object"&&(a==null?void 0:(e=a.value)==null?void 0:e.isDualSend)===!0)return;if(c("gkx")("1070")){e=w.get(f);if(e!=null)e.push(a),e.length>=d("MAWIndexedDbParams").getMaxAfterTransactionBatchSize()&&A(f);else{e=[a];w.set(f,e);b("cr:7096")==null?c("promiseDone")(B(f),function(){},function(a){d("WALogger").ERROR(j(),a)}):b("cr:7096").handleEvents(e)}return}e=w.get(f);if(e!=null)e.push(a);else{var g=[a];w.set(f,g);f.on("complete",function(){w["delete"](f),b("cr:7096")==null?d("MAWBridge").getBridge().fireAndForget("event","uiUpdate",{events:g}):b("cr:7096").handleEvents(g)})}}function D(a,b){var e=c("dexie_maw").currentTransaction;if(e==null){d("WALogger").ERROR(i());throw c("unrecoverableViolation")("afterTransactionForThreadEvent called outside of dexie transaction","messenger_e2ee_web")}e.on("complete",function(){d("MAWBridge").getBridge().fireAndForget("threadEvent",b,a)})}function E(a){m!=null&&(m.close(),m=null);var b=n;b===null&&a!=null&&(b=d("MAWIndexedDbMetadata").dbName(a));d("MAWIndexedDBDeletion").deleteDB(b)}g.TABLES_TO_ENCRYPT=d("MAWDbSchema").TABLES_TO_ENCRYPT;g.makeMsgrTransactor=d("MAWTransactor").makeMsgrTransactor;g.makeDB=a;g.getDBExn=s;g.getDB=t;g.closeDB_INTERNAL_USE_ONLY=e;g.setDB_INTERNAL_USE_ONLY=f;g.afterTransactionEffect=x;g.afterTransaction=C;g.afterTransactionThreadEvent=D;g.deleteDb=E}),98);
__d("MAWDexieCastToPromise",["Promise"],(function(a,b,c,d,e,f){"use strict";function a(a){return b("Promise").resolve(a)}function c(a){return a}f.dexieCastToPromise=a;f.promiseCastToDexiePromise=c}),66);
__d("MAWLLAMigrationUtils",["gkx","justknobx","qpl"],(function(a,b,c,d,e,f,g){"use strict";b=c("justknobx")._("652");var h=1/Math.max(b,10);d=1/(b/10);e=1/(5*b);f=1/(10*b);var i=new Map([["setClockSkew",f],["getRoutingInfo",e],["unknown",f],["writeOutgoingMsg",d],["processFutureProofMsgs",d],["markThreadAsReadUpTo",d],["handleMediaDownload",d],["getMsgForREquestReuploadMedia",d],["createGroup",d],["createGroups",d],["BulkProcessFutureProofMsgs",d]]);function a(a,b,d,e){b===void 0&&(b=!1);d===void 0&&(d={});e===void 0&&(e=!1);var f=i.get(a)||h;return c("gkx")("6226")&&Math.random()<f?[e?c("qpl")._(521475322,"1350"):c("qpl")._(1056839327,"560"),babelHelpers["extends"]({bool:{newLLA:b},string:{transactor:a}},d)]:[]}g.getTransactorQPLParam=a}),98);
__d("WAPromiseQueue",["Promise"],(function(a,b,c,d,e,f){a=function(){function a(a){a===void 0&&(a=-1),this.$1=b("Promise").resolve(),this.$3=0,this.$2=a}var c=a.prototype;c.wait=function(){return this.$1};c.enqueueHandlers=function(a,b,c){var d=this;this.$3++;b=this.$1.then(function(){return a}).then(b,c);c=b.then();this.$1=g(b,this.$2)["finally"](function(){d.$3--});return c};c.enqueue=function(a){var b=this;this.$3++;a=this.$1.then(a);var c=a.then();this.$1=g(a,this.$2)["finally"](function(){b.$3--});return c};c.size=function(){return this.$3};return a}();c=function(){function a(a){a===void 0&&(a=-1),this.$1=new Map(),this.$2=a}var c=a.prototype;c.waitIfPending=function(a){return this.$1.get(a)};c.wait=function(a){return this.$1.get(a)||b("Promise").resolve()};c.enqueueHandlers=function(a,b,c,d){c=this.wait(a).then(function(){return b}).then(c,d);return this.$3(a,c)};c.enqueue=function(a,b){b=this.wait(a).then(b);return this.$3(a,b)};c.$3=function(a,b){var c=this,d=b.then(),e,f=function(){c.$1.get(a)===e&&c.$1["delete"](a)};e=g(b,this.$2).then(f,f);this.$1.set(a,e);return d};return a}();function g(a,c){if(c>=0)return new(b("Promise"))(function(b){var d=function(){return void b()};a.then(d,d);setTimeout(d,c)});else return a.then(h,h)}function h(){}f.PromiseQueue=a;f.PromiseQueueMap=c}),66);
__d("MAWTransactor",["Deferred","MAWDexieCastToPromise","MAWDexieTable","MAWErrorObject","MAWIndexedDb","MAWLLAMigrationUtils","MAWQplProxy","MAWTransactionMode","WAPromiseQueue","WATagsLogger","dexie_maw","gkx","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Uncaught exception in runInBulkTransactor: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Running in bulk transaction"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Several transactions are trying to be executed at the same time: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["runInBulkTransaction cannot be called within another transaction"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bulking "," db operations together"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Finished bulk transaction"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Error completing bulk operation "," ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bulking "," db operations together"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["Finished bulk read/write transaction"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["Error completing bulk operation "," ",""]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["Finished bulk read transaction"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["Error completing bulk operation "," ",""]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["BulkTransactor cannot be called without a transaction id"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["makeMsgrTransactor "," cannot be called within another transaction"]);u=function(){return a};return a}var v=["MWPTransactor"],w=d("WATagsLogger").TAGS(v),x=1,y=new(d("WAPromiseQueue").PromiseQueue)(),z=new Map();function A(a,b,e,f,g){e!=null&&c("dexie_maw").currentTransaction!=null&&e.endFail("invoked_in_nested_transaction");if(c("dexie_maw").currentTransaction!=null){w.ERROR(u(),f);throw c("unrecoverableViolation")("makeMsgrTransactor cannot be called within another transaction","messenger_e2ee_web")}return d("MAWIndexedDb").getDB().then(function(c){return c.transact(a,b,g)})}function B(a,b,e,f,g){e=d("MAWDexieTable").getDexiePSDItem("transactionId");if(e==null){w.ERROR(t());throw c("unrecoverableViolation")("BulkTransactor cannot be called without a transaction id","messenger_e2ee_web")}var h=z.get(e)||[],i=new(c("Deferred"))();h.push({fn:g,mode:a,promise:i,stores:b,transactorName:f});z.set(e,h);return i.getPromise()}function C(a,b,c,e,f){var g=d("MAWDexieTable").getDexiePSDItem("transactor");return g==="bulk"?B(a,b,c,e,f):A(a,b,c,e,f)}function D(a,b,c){return c.length===0?d("MAWDexieTable").dexieResolve():d("MAWDexieCastToPromise").promiseCastToDexiePromise(a.transact(d("MAWTransactionMode").READONLY,b,function(){return d("MAWDexieTable").dexieAll(c.map(function(a){var b=a.fn,c=a.promise,d=a.transactorName;return b().then(function(a){return c.resolve(a)})["catch"](function(a){w.ERROR(s(),d,a);c.reject(a);throw a})}))}).then(function(){w.LOG(r())}))}function E(a,b,c){return c.length===0?d("MAWDexieTable").dexieResolve():d("MAWDexieCastToPromise").promiseCastToDexiePromise(a.transact(d("MAWTransactionMode").READWRITE,b,function(){return c.reduce(function(a,b){var c=b.fn,d=b.promise,e=b.transactorName;return a.then(function(){return c()}).then(function(a){return d.resolve(a)})["catch"](function(a){w.ERROR(q(),e,a);d.reject(a);throw a})},d("MAWDexieTable").dexieResolve())}).then(function(){d("MAWDexieTable").clearDexiePSDItem("transactionId"),w.LOG(p())}))}function F(a){var b=[].concat(z.get(a)||[]);z["delete"](a);if(b.length===0)return d("MAWDexieTable").dexieResolve();w.LOG(o(),b.length);a=b.some(function(a){a=a.mode;return a===d("MAWTransactionMode").READWRITE})?d("MAWTransactionMode").READWRITE:d("MAWTransactionMode").READONLY;var c=Array.from(new Set(b.flatMap(function(a){a=a.stores;return a}))),e=d("MAWIndexedDb").getDBExn("BulkTransaction");return d("MAWDexieCastToPromise").promiseCastToDexiePromise(e.transact(a,c,function(){return b.reduce(function(a,b){var c=b.fn,d=b.promise,e=b.transactorName;return a.then(function(){return c()}).then(function(a){return d.resolve(a)})["catch"](function(a){w.ERROR(n(),e,a);d.reject(a);throw a})},d("MAWDexieTable").dexieResolve())}).then(function(){d("MAWDexieTable").clearDexiePSDItem("transactionId"),w.LOG(m())}))}function G(a){var b=[].concat(z.get(a)||[]);z["delete"](a);if(b.length===0)return d("MAWDexieTable").dexieResolve();w.LOG(l(),b.length);a=b.filter(function(a){a=a.mode;return a===d("MAWTransactionMode").READONLY});var c=b.filter(function(a){a=a.mode;return a===d("MAWTransactionMode").READWRITE});b=Array.from(new Set(a.flatMap(function(a){a=a.stores;return a})));var e=Array.from(new Set(c.flatMap(function(a){a=a.stores;return a}))),f=d("MAWIndexedDb").getDBExn("BulkTransaction");return D(f,b,a).then(function(){return E(f,e,c)}).then(function(){return d("MAWDexieTable").dexieResolve()})}function a(a){var b=c("gkx")("5994")?G:F;return y.enqueue(function(){if(c("dexie_maw").currentTransaction!=null){w.ERROR(k());throw c("unrecoverableViolation")("runInBulkTransaction cannot be called within another transaction","messenger_e2ee_web")}if(d("MAWDexieTable").getDexiePSDItem("transactionId")!=null){w.ERROR(j(),d("MAWDexieTable").getDexiePSDItem("transactionId"));throw c("unrecoverableViolation")("runInBulkTransaction cannot schedule several transactions simultaneously","messenger_e2ee_web")}w.LOG(i());return d("MAWDexieCastToPromise").dexieCastToPromise(d("MAWDexieTable").dexieResolve().then(function(){var c=x++;d("MAWDexieTable").setDexiePSDItem("transactor","bulk");d("MAWDexieTable").setDexiePSDItem("transactionId",c);var e=a();d("MAWDexieTable").clearDexiePSDItem("transactor");return b(c).then(function(){return d("MAWDexieCastToPromise").promiseCastToDexiePromise(e)})["finally"](function(){d("MAWDexieTable").clearDexiePSDItem("transactionId")})}))})["catch"](function(a){w.ERROR(h(),a);throw c("unrecoverableViolation")("Uncaught exception in runInBulkTransactor:","messenger_e2ee_web",a instanceof Error?{error:a}:{error:void 0})})}function H(){var a=d("MAWLLAMigrationUtils").getTransactorQPLParam("unknown");a=a.length===2?a:[null,null];var b=a[0];a=a[1];return b!=null?d("MAWQplProxy").startQplUserFlow(b,a!=null?a:void 0):null}function b(a,b,e){var f=Object.keys(a),g=f.some(function(b){return a[b]===d("MAWTransactionMode").READWRITE})?d("MAWTransactionMode").READWRITE:d("MAWTransactionMode").READONLY;return function(a){return function(){var h;for(var i=arguments.length,j=new Array(i),k=0;k<i;k++)j[k]=arguments[k];var l=b!=null?d("MAWQplProxy").startQplUserFlow(b,e!=null?e:void 0):H(),m=e==null?void 0:(h=e.string)==null?void 0:h.transactor;return d("MAWIndexedDb").getDB(m).then(function(b){return C(g,f,l,m,function(){d("MAWDexieTable").setDexiePSDItem("transactorQPLEvent",l);var e=d("MAWDexieTable").getDexiePSDItem("transactor");l==null?void 0:l.addPoint("transaction_opened",{bool:{isBulkTransaction:e==="bulk"}});return a.apply(void 0,[b.stores].concat(j)).then(function(a){l==null?void 0:l.endSuccess();return a})["catch"](function(a){var b;l==null?void 0:l.endFail("transaction_fail");a=d("MAWErrorObject").getErrorObject(a);throw c("unrecoverableViolation")("["+v.join("|")+"] Error performing "+((b=m)!=null?b:"")+" transaction","messenger_e2ee_web",a?{error:a}:{})})})})}}}g.runInBulkTransaction=a;g.makeMsgrTransactor=b}),98);
__d("MAWDbMiddlewareMutations",["MAWDbObjEncryption","MAWGating","MAWVaultDb","MAWVaultDefinitions","gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,e){if(!d("MAWGating").isVaultingEnabled()&&!(d("MAWGating").isEncryptionAtRestEnabled()||c("gkx")("9017")===!0))return a;a=babelHelpers["extends"]({},a);a=d("MAWVaultDb").unvaultDbRow(a,b,d("MAWVaultDefinitions").ARMADILLO_IDB_VAULT_DEFINITIONS);a=d("MAWDbObjEncryption").encryptDbObj(a,b,e);return a}function b(a,b,c){a=babelHelpers["extends"]({},a);a=d("MAWDbObjEncryption").decryptDbObj(a,b,c);if(!d("MAWGating").isVaultingEnabled())return a;a=d("MAWVaultDb").vaultDbRow(a,b,d("MAWVaultDefinitions").ARMADILLO_IDB_VAULT_DEFINITIONS);return a}g.mutateValue=a;g.getValue=b}),98);
__d("MAWDbMutationMiddleware",["FBLogger","MAWDbMiddlewareMutations"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return{create:function(b){return babelHelpers["extends"]({},b,{table:function(e){var f=b.table(e);try{return babelHelpers["extends"]({},f,{get:function(b){return f.get(b).then(function(b){return b==null?void 0:d("MAWDbMiddlewareMutations").getValue(b,e,a)})},getMany:function(b){return f.getMany(b).then(function(b){return b.map(function(b){return b==null?void 0:d("MAWDbMiddlewareMutations").getValue(b,e,a)})})},mutate:function(b){var c=null;switch(b.type){case"add":case"put":c=b.values.map(function(b){return d("MAWDbMiddlewareMutations").mutateValue(b,e,a)});break;case"delete":break;case"deleteRange":break}if(b.type==="delete"||b.type==="deleteRange"||c==null)return f.mutate(b);b.values=c;return f.mutate(b).then(function(a){return a})},openCursor:function(b){return f.openCursor(b).then(function(b){return b==null||b.value==null?b:h(b,e,a)})},query:function(b){return f.query(b).then(function(b){if(b.result.length===0||typeof b.result[0]!=="object")return b;var c=b.result.map(function(b){return d("MAWDbMiddlewareMutations").getValue(b,e,a)});b.result=c;return b})}})}catch(a){c("FBLogger")("mpf_web_foundations").catching(a).mustfix("Error applying MAWDbMiddleware");return f}}})},name:"MAWDbMutationMiddleware",stack:"dbcore"}}function h(a,b,c){var e;return Object.create(a,{"continue":{get:function(){return a["continue"]}},continuePrimaryKey:{get:function(){return a.continuePrimaryKey}},key:{get:function(){return a.key}},primaryKey:{get:function(){return a.primaryKey}},start:{value:function(f){return a.start(function(){e=d("MAWDbMiddlewareMutations").getValue(a.value,b,c);try{a.value=e}catch(a){}f()})}},value:{get:function(){return e}}})}g.getMAWDbMutationMiddleware=a}),98);
__d("MAWArmadilloAppDataTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};c={};e={};f={};var h={},i={},j={},k={},l={},m={},n={},o={},p={},q={},r={},s={};a.internalSpec={externalId:[1,d("WAProtoConst").TYPES.STRING],author:[2,d("WAProtoConst").TYPES.STRING],chat:[3,d("WAProtoConst").TYPES.STRING]};b.internalSpec={fromMe:[1,d("WAProtoConst").TYPES.BOOL],id:[2,d("WAProtoConst").TYPES.STRING]};c.internalSpec={key:[1,d("WAProtoConst").TYPES.MESSAGE,b],ts:[2,d("WAProtoConst").TYPES.INT64]};e.internalSpec={lastMessageTimestamp:[1,d("WAProtoConst").TYPES.INT64],lastSystemMessageTimestamp:[2,d("WAProtoConst").TYPES.INT64],messages:[3,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.MESSAGE,c]};f.internalSpec={type:[1,d("WAProtoConst").TYPES.STRING],chatJid:[2,d("WAProtoConst").TYPES.STRING],archived:[3,d("WAProtoConst").TYPES.BOOL],ts:[4,d("WAProtoConst").TYPES.INT64],messageRange:[5,d("WAProtoConst").TYPES.MESSAGE,e],read:[6,d("WAProtoConst").TYPES.BOOL]};h.internalSpec={type:[1,d("WAProtoConst").TYPES.STRING],protocolMsgId:[2,d("WAProtoConst").TYPES.MESSAGE,a]};i.internalSpec={chatAction:[1,d("WAProtoConst").TYPES.MESSAGE,f],messageAction:[2,d("WAProtoConst").TYPES.MESSAGE,h],__oneofs__:{action:["chatAction","messageAction"]}};j.internalSpec={actions:[1,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.MESSAGE,i]};k.internalSpec={id:[1,d("WAProtoConst").TYPES.UINT64],anonId:[2,d("WAProtoConst").TYPES.BYTES],rootKey:[3,d("WAProtoConst").TYPES.BYTES],status:[4,d("WAProtoConst").TYPES.INT32]};l.internalSpec={backupId:[1,d("WAProtoConst").TYPES.UINT64],serverDataId:[2,d("WAProtoConst").TYPES.UINT64],epoch:[3,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.MESSAGE,k],tempOcmfClientState:[4,d("WAProtoConst").TYPES.BYTES],mailboxRootKey:[5,d("WAProtoConst").TYPES.BYTES],obliviousValidationToken:[6,d("WAProtoConst").TYPES.BYTES]};m.internalSpec={currentIndex:[1,d("WAProtoConst").TYPES.UINT32],deviceIndexes:[2,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.UINT32],rawId:[3,d("WAProtoConst").TYPES.UINT32]};n.internalSpec={keyId:[1,d("WAProtoConst").TYPES.BYTES],keyData:[2,d("WAProtoConst").TYPES.BYTES],keyEpoch:[3,d("WAProtoConst").TYPES.UINT32],timestamp:[4,d("WAProtoConst").TYPES.INT64],fingerprint:[5,d("WAProtoConst").TYPES.MESSAGE,m]};o.internalSpec={keys:[1,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.MESSAGE,n],orphanKeys:[2,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.BYTES]};p.internalSpec={keyIds:[1,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.BYTES]};q.internalSpec={type:[1,d("WAProtoConst").TYPES.STRING],actions:[2,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.MESSAGE,i],encryptedBackupsSecrets:[3,d("WAProtoConst").TYPES.MESSAGE,l],syncKeyShare:[4,d("WAProtoConst").TYPES.MESSAGE,o],syncKeyRequest:[5,d("WAProtoConst").TYPES.MESSAGE,p]};r.internalSpec={deviceJid:[1,d("WAProtoConst").TYPES.STRING],serializedPubKey:[2,d("WAProtoConst").TYPES.BYTES],baseKey:[3,d("WAProtoConst").TYPES.BYTES]};s.internalSpec={externalId:[1,d("WAProtoConst").TYPES.STRING],ts:[2,d("WAProtoConst").TYPES.INT64],contents:[3,d("WAProtoConst").TYPES.MESSAGE,q],permittedIdentitiesPerDevice:[4,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.MESSAGE,r],ack:[5,d("WAProtoConst").TYPES.INT32],appDataId:[6,d("WAProtoConst").TYPES.INT32],recipientDevices:[7,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.STRING],sendPartial:[8,d("WAProtoConst").TYPES.BOOL]};g.ProtocolMsgIdSpec=a;g.MetaSyncMessageKeyProtoSpec=b;g.MetaSyncMessageProtoSpec=c;g.MetaSyncMessageRangeProtoSpec=e;g.MetaSyncChatActionProtoSpec=f;g.MetaSyncMessageActionProtoSpec=h;g.MetaSyncActionProtoSpec=i;g.MetaSyncAppDataProtoSpec=j;g.EncryptedBackupsSecretsEpochProtoSpec=k;g.EncryptedBackupsSecretsProtoSpec=l;g.FingerprintProtoSpec=m;g.SyncKeyDataProtoSpec=n;g.SyncKeyShareProtoSpec=o;g.SyncKeyRequestProtoSpec=p;g.AppDataProtoSpec=q;g.IdentitiesPerDeviceProtoSpec=r;g.AppDataTableSchemaProtoSpec=s}),98);
__d("MAWArmadilloAppMetaTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};a.internalSpec={msgTypeVersion:[1,d("WAProtoConst").TYPES.INT32],hmacKey:[2,d("WAProtoConst").TYPES.BYTES],allowSecurityAlert:[3,d("WAProtoConst").TYPES.BOOL],hotlikeSticker:[4,d("WAProtoConst").TYPES.BYTES],isBackfilledForOccamadillo:[5,d("WAProtoConst").TYPES.BOOL],allowSecurityAlertForSelf:[11,d("WAProtoConst").TYPES.BOOL]};b.internalSpec={key:[1,d("WAProtoConst").TYPES.STRING],value:[2,d("WAProtoConst").TYPES.MESSAGE,a]};g.DbAppMetaValuesProtoSpec=a;g.AppMetaTableSchemaProtoSpec=b}),98);
__d("MAWArmadilloCollectionVersionsTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};a.internalSpec={collection:[1,d("WAProtoConst").TYPES.STRING],version:[2,d("WAProtoConst").TYPES.INT32],state:[3,d("WAProtoConst").TYPES.STRING],finiteFailureStartTime:[4,d("WAProtoConst").TYPES.INT64],ltHash:[5,d("WAProtoConst").TYPES.BYTES],isCollectionInMacMismatchFatal:[6,d("WAProtoConst").TYPES.BOOL]};g.CollectionVersionsTableSchemaProtoSpec=a}),98);
__d("MAWArmadilloContactsTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};c={};e={};f={};a.internalSpec={ephemeralExpirationInSec:[1,d("WAProtoConst").TYPES.UINT32],ephemeralLastUpdatedOrSetTimestamp:[2,d("WAProtoConst").TYPES.INT64]};b.internalSpec={syncResponseRetries:[1,d("WAProtoConst").TYPES.INT32],syncResponseSentTs:[2,d("WAProtoConst").TYPES.INT64]};c.internalSpec={sequence:[1,d("WAProtoConst").TYPES.INT64],timestamp:[2,d("WAProtoConst").TYPES.INT64],devices:[3,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.BYTES],signingDeviceIndex:[4,d("WAProtoConst").TYPES.INT64],dirty:[5,d("WAProtoConst").TYPES.BOOL]};e.internalSpec={timeBucket:[1,d("WAProtoConst").TYPES.INT64],alert:[2,d("WAProtoConst").TYPES.BOOL]};f.internalSpec={contactJid:[1,d("WAProtoConst").TYPES.STRING],dhash:[3,d("WAProtoConst").TYPES.STRING],nameForSearch:[4,d("WAProtoConst").TYPES.STRING],ephemeralSetting:[5,d("WAProtoConst").TYPES.MESSAGE,a],isBlocked:[6,d("WAProtoConst").TYPES.BOOL],lastSyncTs:[7,d("WAProtoConst").TYPES.INT64],icdcInfo:[8,d("WAProtoConst").TYPES.MESSAGE,c],ephemeralSyncResponseBackoffInfo:[9,d("WAProtoConst").TYPES.MESSAGE,b],icdcFails:[10,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.MESSAGE,e],relationship:[11,d("WAProtoConst").TYPES.INT32],isRestricted:[12,d("WAProtoConst").TYPES.BOOL]};g.EphemeralSettingProtoSpec=a;g.EphemeralSyncResponseBackoffInfoSpec=b;g.ICDCInfoProtoSpec=c;g.ICDCCheckFailSpec=e;g.ContactsTableSchemaProtoSpec=f}),98);
__d("MAWArmadilloDeviceChangeAlertsTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};a.internalSpec={action:[1,d("WAProtoConst").TYPES.STRING],isArchived:[2,d("WAProtoConst").TYPES.BOOL],deviceChangeAlertsId:[3,d("WAProtoConst").TYPES.INT64],location:[4,d("WAProtoConst").TYPES.STRING],model:[5,d("WAProtoConst").TYPES.STRING],ts:[6,d("WAProtoConst").TYPES.INT64],loggedOut:[7,d("WAProtoConst").TYPES.BOOL],deviceJid:[8,d("WAProtoConst").TYPES.STRING],identity:[9,d("WAProtoConst").TYPES.BYTES],platform:[10,d("WAProtoConst").TYPES.STRING],latitude:[11,d("WAProtoConst").TYPES.STRING],longitude:[12,d("WAProtoConst").TYPES.STRING]};g.DeviceChangeAlertsTableSchemaProtoSpec=a}),98);
__d("MAWArmadilloDyiBatchTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={BACKUP_RESTORE:0,E2E_DYI:1};b={};b.internalSpec={batchId:[1,d("WAProtoConst").TYPES.INT32],numMessages:[2,d("WAProtoConst").TYPES.INT32],oldestTs:[3,d("WAProtoConst").TYPES.INT64],threadId:[4,d("WAProtoConst").TYPES.STRING],isThread:[5,d("WAProtoConst").TYPES.BOOL],numMessagesRestored:[6,d("WAProtoConst").TYPES.INT32],qplInstanceKeyForThread:[7,d("WAProtoConst").TYPES.INT64],qplFlowDescriptor:[8,d("WAProtoConst").TYPES.ENUM,a],qplInstanceKeyE2E:[9,d("WAProtoConst").TYPES.INT64],numThreadsRestored:[10,d("WAProtoConst").TYPES.INT64]};g.DYI_BATCH_TABLE_SCHEMA_PROTO_QPL_FLOW_DESCRIPTOR=a;g.DyiBatchTableSchemaProtoSpec=b}),98);
__d("MAWArmadilloMessagesTableSchema.pb",["MAWArmadilloContactsTableSchema.pb","WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};c={};e={};f={};var h={},i={},j={},k={},l={};a.internalSpec={content:[1,d("WAProtoConst").TYPES.STRING],adminMsgContent:[2,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.STRING],adminType:[3,d("WAProtoConst").TYPES.STRING],obsoleteExpiration:[4,d("WAProtoConst").TYPES.INT32],obsoleteTs:[5,d("WAProtoConst").TYPES.INT64],subtype:[6,d("WAProtoConst").TYPES.STRING],protobuf:[7,d("WAProtoConst").TYPES.BYTES],screenshotActionType:[8,d("WAProtoConst").TYPES.INT32],authorName:[9,d("WAProtoConst").TYPES.STRING],version:[10,d("WAProtoConst").TYPES.INT32],mentionedJids:[11,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.STRING]};b.internalSpec={frankingTag:[1,d("WAProtoConst").TYPES.BYTES],frankingVersion:[2,d("WAProtoConst").TYPES.INT32],reportingContent:[3,d("WAProtoConst").TYPES.BYTES],reportingTag:[4,d("WAProtoConst").TYPES.BYTES],frankingKey:[5,d("WAProtoConst").TYPES.BYTES]};c.internalSpec={remoteJid:[1,d("WAProtoConst").TYPES.STRING],content:[2,d("WAProtoConst").TYPES.MESSAGE,k]};e.internalSpec={duration:[1,d("WAProtoConst").TYPES.INT32],width:[2,d("WAProtoConst").TYPES.INT32],height:[3,d("WAProtoConst").TYPES.INT32],mimetype:[4,d("WAProtoConst").TYPES.STRING],jpegThumbnail:[5,d("WAProtoConst").TYPES.BYTES],jpegThumbnailHeight:[6,d("WAProtoConst").TYPES.INT32],jpegThumbnailWidth:[7,d("WAProtoConst").TYPES.INT32]};f.internalSpec={width:[1,d("WAProtoConst").TYPES.UINT32],height:[2,d("WAProtoConst").TYPES.UINT32],jpegThumbnail:[3,d("WAProtoConst").TYPES.BYTES],jpegThumbnailHeight:[4,d("WAProtoConst").TYPES.INT32],jpegThumbnailWidth:[5,d("WAProtoConst").TYPES.INT32]};h.internalSpec={duration:[1,d("WAProtoConst").TYPES.INT32],mimetype:[2,d("WAProtoConst").TYPES.STRING],played:[3,d("WAProtoConst").TYPES.BOOL]};i.internalSpec={filename:[1,d("WAProtoConst").TYPES.STRING],mimetype:[2,d("WAProtoConst").TYPES.STRING]};j.internalSpec={mediaType:[1,d("WAProtoConst").TYPES.STRING],plaintextHash:[2,d("WAProtoConst").TYPES.STRING],size:[3,d("WAProtoConst").TYPES.INT32],ts:[4,d("WAProtoConst").TYPES.INT64],mediaEntry:[5,d("WAProtoConst").TYPES.BYTES],validatedVideoInfo:[6,d("WAProtoConst").TYPES.MESSAGE,e],validatedImageInfo:[7,d("WAProtoConst").TYPES.MESSAGE,f],validatedAudioInfo:[8,d("WAProtoConst").TYPES.MESSAGE,h],validatedDocumentFileInfo:[9,d("WAProtoConst").TYPES.MESSAGE,i]};k.internalSpec={type:[1,d("WAProtoConst").TYPES.STRING],ts:[2,d("WAProtoConst").TYPES.INT64],externalId:[3,d("WAProtoConst").TYPES.STRING],author:[4,d("WAProtoConst").TYPES.STRING],msgContent:[5,d("WAProtoConst").TYPES.MESSAGE,a],obsoleteMedia:[6,d("WAProtoConst").TYPES.MESSAGE,j],msgId:[7,d("WAProtoConst").TYPES.STRING],mediaId:[8,d("WAProtoConst").TYPES.INT32],sourceId:[9,d("WAProtoConst").TYPES.STRING],xmaMessageType:[10,d("WAProtoConst").TYPES.INT32],specialTextSize:[11,d("WAProtoConst").TYPES.INT32]};l.internalSpec={type:[1,d("WAProtoConst").TYPES.STRING],ts:[2,d("WAProtoConst").TYPES.INT64],externalId:[3,d("WAProtoConst").TYPES.STRING],msgId:[4,d("WAProtoConst").TYPES.STRING],author:[5,d("WAProtoConst").TYPES.STRING],ack:[6,d("WAProtoConst").TYPES.INT32],resendCount:[7,d("WAProtoConst").TYPES.INT32],msgContent:[8,d("WAProtoConst").TYPES.MESSAGE,a],altIndex:[9,d("WAProtoConst").TYPES.STRING],forwardingScore:[10,d("WAProtoConst").TYPES.INT32],quote:[11,d("WAProtoConst").TYPES.MESSAGE,c],messageExpirationTs:[12,d("WAProtoConst").TYPES.INT64],ephemeralSetting:[13,d("WAProtoConst").TYPES.MESSAGE,d("MAWArmadilloContactsTableSchema.pb").EphemeralSettingProtoSpec],revokedExternalId:[14,d("WAProtoConst").TYPES.STRING],isForwarded:[15,d("WAProtoConst").TYPES.BOOL],serverTs:[16,d("WAProtoConst").TYPES.INT64],originalTs:[17,d("WAProtoConst").TYPES.INT64],sortOrderMs:[18,d("WAProtoConst").TYPES.INT64],reportingMeta:[19,d("WAProtoConst").TYPES.MESSAGE,b],messageDeleteTs:[20,d("WAProtoConst").TYPES.INT64],ephemeralCounterStarted:[21,d("WAProtoConst").TYPES.BOOL],quoteExternalId:[22,d("WAProtoConst").TYPES.STRING],unsendMsgContentDeleteTs:[23,d("WAProtoConst").TYPES.INT64],rowId:[24,d("WAProtoConst").TYPES.INT32],thread:[25,d("WAProtoConst").TYPES.INT32],mediaId:[26,d("WAProtoConst").TYPES.INT32],ephemeralMsgDisappeared:[27,d("WAProtoConst").TYPES.BOOL],threadJid:[28,d("WAProtoConst").TYPES.STRING],xmaId:[29,d("WAProtoConst").TYPES.INT32],specialTextSize:[30,d("WAProtoConst").TYPES.INT32],xmaMessageType:[31,d("WAProtoConst").TYPES.INT32],isExpiredXmaMsg:[32,d("WAProtoConst").TYPES.BOOL],ravenEphemeralType:[33,d("WAProtoConst").TYPES.INT32],ravenEphemeralMediaState:[34,d("WAProtoConst").TYPES.INT32],editCount:[35,d("WAProtoConst").TYPES.INT32]};g.MsgContentProtoSpec=a;g.ReportingMetaProtoSpec=b;g.DbQuotedMsgProtoSpec=c;g.VideoMsgContentProtoSpec=e;g.ImageMsgContentProtoSpec=f;g.AudioMsgContentProtoSpec=h;g.DocumentFileMsgContentProtoSpec=i;g.QuotedDbMediaProtoSpec=j;g.DbQuotedMsgContentProtoSpec=k;g.MessagesTableSchemaProtoSpec=l}),98);
__d("MAWArmadilloEditMsgHistoryTableSchema.pb",["MAWArmadilloMessagesTableSchema.pb","WAProtoConst"],(function(a,b,c,d,e,f,g){a={};a.internalSpec={author:[1,d("WAProtoConst").TYPES.STRING],editMsgHistoryId:[2,d("WAProtoConst").TYPES.INT32],editTs:[3,d("WAProtoConst").TYPES.INT64],msgContent:[4,d("WAProtoConst").TYPES.MESSAGE,d("MAWArmadilloMessagesTableSchema.pb").MsgContentProtoSpec],originalMsgExternalId:[5,d("WAProtoConst").TYPES.STRING],specialTextSize:[6,d("WAProtoConst").TYPES.INT32],threadJid:[7,d("WAProtoConst").TYPES.STRING]};g.EditMsgHistoryTableSchemaProtoSpec=a}),98);
__d("MAWArmadilloGroupInfoTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};a.internalSpec={groupJid:[1,d("WAProtoConst").TYPES.STRING],threadId:[2,d("WAProtoConst").TYPES.INT32],creator:[3,d("WAProtoConst").TYPES.STRING],creationTs:[4,d("WAProtoConst").TYPES.INT64],name:[5,d("WAProtoConst").TYPES.STRING],nameOwner:[6,d("WAProtoConst").TYPES.STRING],nameTs:[7,d("WAProtoConst").TYPES.INT64],msgExpiration:[8,d("WAProtoConst").TYPES.INT32],participantVersion:[9,d("WAProtoConst").TYPES.STRING],inviter:[10,d("WAProtoConst").TYPES.STRING]};g.GroupInfoSchemaProtoSpec=a}),98);
__d("MAWArmadilloGroupInvitesTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};a.internalSpec={inviterJid:[1,d("WAProtoConst").TYPES.STRING],invitedParticipantId:[2,d("WAProtoConst").TYPES.STRING],inviteCode:[3,d("WAProtoConst").TYPES.STRING],inviteExpirationTs:[4,d("WAProtoConst").TYPES.INT64],caption:[5,d("WAProtoConst").TYPES.STRING]};g.GroupInvitesTableSchemaProtoSpec=a}),98);
__d("MAWArmadilloMediaTablesSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};c={};e={};f={};var h={},i={},j={};a.internalSpec={plaintextHash:[1,d("WAProtoConst").TYPES.STRING],blobData:[2,d("WAProtoConst").TYPES.BYTES],mimetype:[3,d("WAProtoConst").TYPES.STRING],hashedPlaintextHash:[4,d("WAProtoConst").TYPES.STRING],chunkId:[5,d("WAProtoConst").TYPES.INT32]};b.internalSpec={mediaBackupId:[1,d("WAProtoConst").TYPES.INT32],mediaId:[2,d("WAProtoConst").TYPES.INT32],objectId:[3,d("WAProtoConst").TYPES.STRING],msgId:[4,d("WAProtoConst").TYPES.STRING],fbid:[5,d("WAProtoConst").TYPES.STRING]};c.internalSpec={msgId:[1,d("WAProtoConst").TYPES.STRING],mediaEntryData:[2,d("WAProtoConst").TYPES.BYTES]};e.internalSpec={duration:[1,d("WAProtoConst").TYPES.INT32],width:[2,d("WAProtoConst").TYPES.INT32],height:[3,d("WAProtoConst").TYPES.INT32],mimetype:[4,d("WAProtoConst").TYPES.STRING],jpegThumbnail:[5,d("WAProtoConst").TYPES.BYTES],jpegThumbnailHeight:[6,d("WAProtoConst").TYPES.INT32],jpegThumbnailWidth:[7,d("WAProtoConst").TYPES.INT32]};f.internalSpec={width:[1,d("WAProtoConst").TYPES.UINT32],height:[2,d("WAProtoConst").TYPES.UINT32],jpegThumbnail:[3,d("WAProtoConst").TYPES.BYTES],jpegThumbnailHeight:[4,d("WAProtoConst").TYPES.INT32],jpegThumbnailWidth:[5,d("WAProtoConst").TYPES.INT32]};h.internalSpec={duration:[1,d("WAProtoConst").TYPES.INT32],mimetype:[2,d("WAProtoConst").TYPES.STRING],played:[3,d("WAProtoConst").TYPES.BOOL]};i.internalSpec={filename:[1,d("WAProtoConst").TYPES.STRING],mimetype:[2,d("WAProtoConst").TYPES.STRING]};j.internalSpec={mediaType:[1,d("WAProtoConst").TYPES.STRING],plaintextHash:[2,d("WAProtoConst").TYPES.STRING],size:[3,d("WAProtoConst").TYPES.INT32],mediaEntries:[4,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.MESSAGE,c],ts:[5,d("WAProtoConst").TYPES.INT64],validatedVideoInfo:[6,d("WAProtoConst").TYPES.MESSAGE,e],validatedImageInfo:[7,d("WAProtoConst").TYPES.MESSAGE,f],validatedAudioInfo:[8,d("WAProtoConst").TYPES.MESSAGE,h],hashedPlaintextHash:[9,d("WAProtoConst").TYPES.STRING],mediaId:[10,d("WAProtoConst").TYPES.INT32],msgIds:[11,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.STRING],objectId:[12,d("WAProtoConst").TYPES.STRING],fbid:[13,d("WAProtoConst").TYPES.STRING],validatedDocumentFileInfo:[14,d("WAProtoConst").TYPES.MESSAGE,i]};g.ChunkTableSchemaProtoSpec=a;g.MediaBackupSchemaProtoSpec=b;g.MediaEntriesProtoSpec=c;g.VideoMsgContentProtoSpec=e;g.ImageMsgContentProtoSpec=f;g.AudioMsgContentProtoSpec=h;g.DocumentFileMsgContentProtoSpec=i;g.MediaTableSchemaProtoSpec=j}),98);
__d("MAWArmadilloMetaRowTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};c={};e={};f={};var h={},i={},j={},k={},l={};a.internalSpec={encryptedSerializedCat:[1,d("WAProtoConst").TYPES.STRING],expirationTimeInSeconds:[2,d("WAProtoConst").TYPES.INT32]};b.internalSpec={publicKey:[1,d("WAProtoConst").TYPES.BYTES],privateKey:[2,d("WAProtoConst").TYPES.BYTES]};c.internalSpec={intValue:[1,d("WAProtoConst").TYPES.INT32],strValue:[2,d("WAProtoConst").TYPES.STRING],boolValue:[3,d("WAProtoConst").TYPES.BOOL],__oneofs__:{value:["intValue","strValue","boolValue"]}};e.internalSpec={name:[1,d("WAProtoConst").TYPES.STRING],value:[2,d("WAProtoConst").TYPES.MESSAGE,c]};f.internalSpec={expoKey:[1,d("WAProtoConst").TYPES.INT32],value:[2,d("WAProtoConst").TYPES.STRING]};h.internalSpec={abKey:[1,d("WAProtoConst").TYPES.STRING],abHash:[2,d("WAProtoConst").TYPES.STRING],lastSyncTime:[3,d("WAProtoConst").TYPES.INT64],expoKeyStr:[4,d("WAProtoConst").TYPES.STRING],refresh:[5,d("WAProtoConst").TYPES.INT64],internalExpoKeys:[6,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.STRING],propExpoKeys:[7,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.MESSAGE,f],propValues:[8,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.MESSAGE,e]};i.internalSpec={key:[1,d("WAProtoConst").FLAGS.REQUIRED|d("WAProtoConst").TYPES.BYTES],notAfter:[2,d("WAProtoConst").FLAGS.REQUIRED|d("WAProtoConst").TYPES.INT32],notBefore:[3,d("WAProtoConst").FLAGS.REQUIRED|d("WAProtoConst").TYPES.INT32]};j.internalSpec={leaf:[1,d("WAProtoConst").TYPES.MESSAGE,i],intermediate:[2,d("WAProtoConst").TYPES.MESSAGE,i]};k.internalSpec={cat:[1,d("WAProtoConst").TYPES.MESSAGE,a],deviceUUID:[2,d("WAProtoConst").TYPES.STRING],regId:[3,d("WAProtoConst").TYPES.INT32],identityKeyPair:[4,d("WAProtoConst").TYPES.MESSAGE,b],fbid:[5,d("WAProtoConst").TYPES.STRING],deviceId:[6,d("WAProtoConst").TYPES.INT32],lastSignedPrekeyId:[7,d("WAProtoConst").TYPES.INT32],lastPrekeyId:[8,d("WAProtoConst").TYPES.INT32],lastPrekeyGenerationId:[9,d("WAProtoConst").TYPES.INT32],edgeInfo:[10,d("WAProtoConst").TYPES.BYTES],clockSkew:[11,d("WAProtoConst").TYPES.INT32],msgrDeviceId:[12,d("WAProtoConst").TYPES.STRING],abProps:[13,d("WAProtoConst").TYPES.MESSAGE,h],registrationVersion:[14,d("WAProtoConst").TYPES.INT32],authKeyPair:[15,d("WAProtoConst").TYPES.MESSAGE,b],certificateChain:[16,d("WAProtoConst").TYPES.MESSAGE,j],lastSessionDeviceWasLinkedTo:[17,d("WAProtoConst").TYPES.STRING],__oneofs__:{value:["cat","deviceUUID","regId","identityKeyPair","fbid","deviceId","lastSignedPrekeyId","lastPrekeyId","lastPrekeyGenerationId","edgeInfo","clockSkew","msgrDeviceId","abProps","registrationVersion","authKeyPair","certificateChain","lastSessionDeviceWasLinkedTo"]}};l.internalSpec={key:[1,d("WAProtoConst").TYPES.STRING],value:[2,d("WAProtoConst").TYPES.MESSAGE,k]};g.ValidCatProtoSpec=a;g.KeyPairProtoSpec=b;g.AbPropTypeSpec=c;g.AbPropValueSpec=e;g.ExpoKeyMapSpec=f;g.AbPropsConfigSpec=h;g.CertificateDetailsSpec=i;g.CertificateChainSpec=j;g.ValueProtoSpec=k;g.MetaRowTableSchemaProtoSpec=l}),98);
__d("MAWArmadilloMissingKeysTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};a.internalSpec={deviceId:[1,d("WAProtoConst").TYPES.INT32],deviceResponse:[2,d("WAProtoConst").TYPES.BOOL]};b.internalSpec={keyHex:[1,d("WAProtoConst").TYPES.STRING],keyId:[2,d("WAProtoConst").TYPES.BYTES],timestamp:[3,d("WAProtoConst").TYPES.INT64],deviceResponses:[4,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.MESSAGE,a]};g.DeviceResponseSpec=a;g.MissingKeysTableSchemaProtoSpec=b}),98);
__d("MAWArmadilloParticipantsTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};a.internalSpec={id:[1,d("WAProtoConst").TYPES.STRING],userJid:[2,d("WAProtoConst").TYPES.STRING],deliveredWatermarkTs:[3,d("WAProtoConst").TYPES.INT64],lastReadWatermarkTs:[4,d("WAProtoConst").TYPES.INT64],type:[5,d("WAProtoConst").TYPES.STRING],addressable:[6,d("WAProtoConst").TYPES.BOOL],lastReadActionTs:[7,d("WAProtoConst").TYPES.INT64],nickname:[8,d("WAProtoConst").TYPES.STRING],threadId:[9,d("WAProtoConst").TYPES.INT32]};g.ParticipantsTableSchemaProtoSpec=a}),98);
__d("MAWArmadilloPendingMutationsTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={SET:0,REMOVE:1};b={};b.internalSpec={id:[1,d("WAProtoConst").TYPES.INT32],collection:[2,d("WAProtoConst").TYPES.STRING],index:[3,d("WAProtoConst").TYPES.STRING],binarySyncAction:[4,d("WAProtoConst").TYPES.BYTES],version:[5,d("WAProtoConst").TYPES.INT32],operation:[6,d("WAProtoConst").TYPES.ENUM,a],timestamp:[7,d("WAProtoConst").TYPES.INT64],action:[8,d("WAProtoConst").TYPES.STRING]};g.SYNCD_MUTATION_SYNCD_OPERATION=a;g.PendingMutationsTableSchemaProtoSpec=b}),98);
__d("MAWArmadilloPersonalSenderKeyStatusTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};a.internalSpec={groupJid:[1,d("WAProtoConst").TYPES.STRING],senderKeyId:[2,d("WAProtoConst").TYPES.INT32],rotateSenderKey:[4,d("WAProtoConst").TYPES.BOOL],senderKeyTs:[5,d("WAProtoConst").TYPES.INT64],hasSenderKey:[6,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.STRING]};g.PersonalSenderKeyStatusTableSchemaProtoSpec=a}),98);
__d("MAWArmadilloReactionsTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};a.internalSpec={ack:[1,d("WAProtoConst").TYPES.INT32],author:[2,d("WAProtoConst").TYPES.STRING],externalId:[3,d("WAProtoConst").TYPES.STRING],reactionId:[4,d("WAProtoConst").TYPES.STRING],reactToExternalId:[5,d("WAProtoConst").TYPES.STRING],reactToAuthor:[6,d("WAProtoConst").TYPES.STRING],reactToMsgId:[7,d("WAProtoConst").TYPES.STRING],threadJid:[8,d("WAProtoConst").TYPES.STRING],reaction:[9,d("WAProtoConst").TYPES.STRING],groupingKey:[10,d("WAProtoConst").TYPES.STRING],ts:[11,d("WAProtoConst").TYPES.INT64],rowId:[12,d("WAProtoConst").TYPES.INT32]};g.ReactionsTableSchemaProtoSpec=a}),98);
__d("MAWArmadilloReceiptTablesSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};c={};e={};f={};var h={},i={};a.internalSpec={deliveredTs:[1,d("WAProtoConst").TYPES.INT64],readTs:[2,d("WAProtoConst").TYPES.INT64]};b.internalSpec={userJid:[1,d("WAProtoConst").TYPES.STRING],dbUserStatusTs:[2,d("WAProtoConst").TYPES.MESSAGE,a]};c.internalSpec={deviceJid:[1,d("WAProtoConst").TYPES.STRING],serializedPubKey:[2,d("WAProtoConst").TYPES.BYTES],baseKey:[3,d("WAProtoConst").TYPES.BYTES]};e.internalSpec={deviceJid:[1,d("WAProtoConst").TYPES.STRING],count:[2,d("WAProtoConst").TYPES.INT32]};f.internalSpec={msgId:[1,d("WAProtoConst").TYPES.STRING],statusTsPerUser:[2,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.MESSAGE,b],permittedIdentitiesPerDevice:[3,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.MESSAGE,c],recipientDevices:[4,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.STRING],retryCountsPerDevice:[5,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.MESSAGE,e]};h.internalSpec={device:[1,d("WAProtoConst").TYPES.STRING],ts:[2,d("WAProtoConst").TYPES.INT64]};i.internalSpec={pendingReceiptId:[1,d("WAProtoConst").TYPES.STRING],thread:[2,d("WAProtoConst").TYPES.STRING],externalId:[3,d("WAProtoConst").TYPES.STRING],author:[4,d("WAProtoConst").TYPES.STRING],deliveryReceipts:[5,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.MESSAGE,h],readReceipts:[6,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.MESSAGE,h]};g.DbUserStatusTsProtoSpec=a;g.StatusTsPerUserProtoSpec=b;g.IdentitiesPerDeviceProtoSpec=c;g.RetryCountPerDeviceProtoSpec=e;g.ReceiptsTableSchemaProtoSpec=f;g.ReceiptsSpec=h;g.PendingReceiptsTableSchemaProtoSpec=i}),98);
__d("MAWArmadilloRetroactiveBackupsStateTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};a.internalSpec={threadId:[1,d("WAProtoConst").TYPES.INT64],msgId:[2,d("WAProtoConst").TYPES.STRING]};g.RetroactiveBackupsStateTableSchemaProtoSpec=a}),98);
__d("MAWArmadilloSignalTablesSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};c={};e={};f={};var h={};a.internalSpec={deviceJid:[1,d("WAProtoConst").TYPES.STRING],identity:[2,d("WAProtoConst").TYPES.BYTES],firstSeenTs:[3,d("WAProtoConst").TYPES.INT64],deviceName:[4,d("WAProtoConst").TYPES.STRING],platform:[5,d("WAProtoConst").TYPES.STRING],userJid:[6,d("WAProtoConst").TYPES.STRING]};b.internalSpec={keyId:[1,d("WAProtoConst").TYPES.INT32],encoded:[2,d("WAProtoConst").TYPES.BYTES],isDeleted:[3,d("WAProtoConst").TYPES.BOOL]};c.internalSpec={generationId:[1,d("WAProtoConst").TYPES.INT32],startingId:[2,d("WAProtoConst").TYPES.INT32],endingId:[3,d("WAProtoConst").TYPES.INT32],createdTs:[4,d("WAProtoConst").TYPES.INT64]};e.internalSpec={id:[1,d("WAProtoConst").TYPES.STRING],session:[2,d("WAProtoConst").TYPES.BYTES]};f.internalSpec={keyId:[1,d("WAProtoConst").TYPES.INT32],encoded:[2,d("WAProtoConst").TYPES.BYTES]};h.internalSpec={id:[1,d("WAProtoConst").TYPES.STRING],groupJid:[2,d("WAProtoConst").TYPES.STRING],userJid:[3,d("WAProtoConst").TYPES.STRING],deviceId:[4,d("WAProtoConst").TYPES.INT32],record:[5,d("WAProtoConst").TYPES.BYTES]};g.IdentityTableSchemaProtoSpec=a;g.PrekeyTableSchemaProtoSpec=b;g.PrekeyGenerationTableSchemaProtoSpec=c;g.SessionTableSchemaProtoSpec=e;g.SignedPrekeyTableSchemaProtoSpec=f;g.SenderKeySessionsTableSchemaProtoSpec=h}),98);
__d("MAWArmadilloSyncActionsTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};a.internalSpec={index:[1,d("WAProtoConst").TYPES.STRING],binarySyncData:[2,d("WAProtoConst").TYPES.BYTES],actionState:[3,d("WAProtoConst").TYPES.STRING],version:[4,d("WAProtoConst").TYPES.INT32],keyId:[5,d("WAProtoConst").TYPES.BYTES],modelId:[6,d("WAProtoConst").TYPES.STRING],modelType:[7,d("WAProtoConst").TYPES.STRING],indexMac:[8,d("WAProtoConst").TYPES.BYTES],valueMac:[9,d("WAProtoConst").TYPES.BYTES],collection:[10,d("WAProtoConst").TYPES.STRING],timestamp:[11,d("WAProtoConst").TYPES.INT64],action:[12,d("WAProtoConst").TYPES.STRING]};g.SyncActionsTableSchemaProtoSpec=a}),98);
__d("MAWArmadilloSyncKeysTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};a.internalSpec={currentIndex:[1,d("WAProtoConst").TYPES.INT32],deviceIndexes:[2,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.INT32],rawId:[3,d("WAProtoConst").TYPES.INT64]};b.internalSpec={id:[1,d("WAProtoConst").TYPES.BYTES],keyId:[2,d("WAProtoConst").TYPES.BYTES],keyData:[3,d("WAProtoConst").TYPES.BYTES],keyEpoch:[4,d("WAProtoConst").TYPES.INT64],timestamp:[5,d("WAProtoConst").TYPES.INT64],fingerprint:[6,d("WAProtoConst").TYPES.MESSAGE,a]};g.SyncKeyFingerprintSpec=a;g.SyncKeysTableSchemaProtoSpec=b}),98);
__d("MAWArmadilloTasksTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};a.internalSpec={taskName:[1,d("WAProtoConst").TYPES.STRING],scheduledTime:[2,d("WAProtoConst").TYPES.INT64]};g.TasksTableSchemaProtoSpec=a}),98);
__d("MAWArmadilloThreadsTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};a.internalSpec={jid:[1,d("WAProtoConst").TYPES.STRING],threadOrder:[2,d("WAProtoConst").TYPES.STRING],nextInChatMsgId:[3,d("WAProtoConst").TYPES.INT32],folder:[4,d("WAProtoConst").TYPES.INT32],newestMsg:[5,d("WAProtoConst").TYPES.STRING],oldestMsg:[6,d("WAProtoConst").TYPES.STRING],lastReadMsg:[7,d("WAProtoConst").TYPES.STRING],lastReadMsgReceiptSent:[8,d("WAProtoConst").TYPES.STRING],lastReadMsgTs:[9,d("WAProtoConst").TYPES.INT64],newestMsgTs:[10,d("WAProtoConst").TYPES.INT64],muteExpireTimeMs:[11,d("WAProtoConst").TYPES.INT64],muteCallsExpireTimeMs:[12,d("WAProtoConst").TYPES.INT64],archived:[13,d("WAProtoConst").TYPES.BOOL],cannotReplyReason:[14,d("WAProtoConst").TYPES.STRING],chatId:[15,d("WAProtoConst").TYPES.INT32],optimisticThreadKey:[16,d("WAProtoConst").TYPES.STRING],isMigratedLocally:[17,d("WAProtoConst").TYPES.BOOL],snippetMsg:[18,d("WAProtoConst").TYPES.STRING],deduplicationKey:[19,d("WAProtoConst").TYPES.STRING],authoritativeThreadKey:[20,d("WAProtoConst").TYPES.STRING]};g.ThreadsTableSchemaProtoSpec=a}),98);
__d("MAWArmadilloUnrenderedMessagesTableSchema.pb",["MAWArmadilloContactsTableSchema.pb","MAWArmadilloMessagesTableSchema.pb","WAProtoConst"],(function(a,b,c,d,e,f,g){a={};a.internalSpec={type:[1,d("WAProtoConst").TYPES.STRING],ts:[2,d("WAProtoConst").TYPES.INT64],externalId:[3,d("WAProtoConst").TYPES.STRING],msgId:[4,d("WAProtoConst").TYPES.STRING],author:[5,d("WAProtoConst").TYPES.STRING],ack:[6,d("WAProtoConst").TYPES.INT32],resendCount:[7,d("WAProtoConst").TYPES.INT32],ephemeralSetting:[8,d("WAProtoConst").TYPES.MESSAGE,d("MAWArmadilloContactsTableSchema.pb").EphemeralSettingProtoSpec],messageDeleteForMeTs:[9,d("WAProtoConst").TYPES.INT64],rowId:[10,d("WAProtoConst").TYPES.INT32],thread:[11,d("WAProtoConst").TYPES.INT32],mediaId:[12,d("WAProtoConst").TYPES.INT32],msgContent:[13,d("WAProtoConst").TYPES.STRING],threadJid:[14,d("WAProtoConst").TYPES.STRING],reportingMeta:[15,d("WAProtoConst").TYPES.MESSAGE,d("MAWArmadilloMessagesTableSchema.pb").ReportingMetaProtoSpec],invitedParticipantUserJid:[16,d("WAProtoConst").TYPES.STRING],groupName:[17,d("WAProtoConst").TYPES.STRING],quote:[18,d("WAProtoConst").TYPES.MESSAGE,d("MAWArmadilloMessagesTableSchema.pb").DbQuotedMsgProtoSpec],xmaMessageType:[19,d("WAProtoConst").TYPES.INT32],sortOrderMs:[20,d("WAProtoConst").TYPES.INT64]};g.UnrenderedMessagesTableSchemaProtoSpec=a}),98);
__d("MAWArmadilloXMATableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};a.internalSpec={associatedMessageId:[1,d("WAProtoConst").TYPES.STRING],author:[2,d("WAProtoConst").TYPES.STRING],ctas:[3,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.MESSAGE,b],defaultCTA:[4,d("WAProtoConst").TYPES.MESSAGE,b],defaultPreviewMediaId:[5,d("WAProtoConst").TYPES.INT32],externalId:[6,d("WAProtoConst").TYPES.STRING],faviconMediaId:[7,d("WAProtoConst").TYPES.INT32],headerMediaId:[8,d("WAProtoConst").TYPES.INT32],headerTitle:[9,d("WAProtoConst").TYPES.STRING],isTombstoned:[10,d("WAProtoConst").TYPES.BOOL],maxSubtitleNumOfLines:[11,d("WAProtoConst").TYPES.INT32],maxTitleNumOfLines:[12,d("WAProtoConst").TYPES.INT32],msgId:[13,d("WAProtoConst").TYPES.STRING],overlayDescription:[14,d("WAProtoConst").TYPES.STRING],overlayIconGlyph:[15,d("WAProtoConst").TYPES.INT32],overlayTitle:[16,d("WAProtoConst").TYPES.STRING],previewMediaIds:[17,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.INT32],subtitleText:[18,d("WAProtoConst").TYPES.STRING],targetExpiringAtSec:[19,d("WAProtoConst").TYPES.INT64],targetId:[20,d("WAProtoConst").TYPES.STRING],targetType:[21,d("WAProtoConst").TYPES.INT32],targetUsername:[22,d("WAProtoConst").TYPES.STRING],threadJid:[23,d("WAProtoConst").TYPES.STRING],titleText:[24,d("WAProtoConst").TYPES.STRING],xmaId:[25,d("WAProtoConst").TYPES.INT32],xmaLayoutType:[26,d("WAProtoConst").TYPES.INT32]};b.internalSpec={buttonType:[1,d("WAProtoConst").TYPES.INT32],title:[2,d("WAProtoConst").TYPES.STRING],actionUrl:[3,d("WAProtoConst").TYPES.STRING],nativeUrl:[4,d("WAProtoConst").TYPES.STRING],ctaType:[5,d("WAProtoConst").TYPES.STRING]};g.XMATableSchemaProtoSpec=a;g.CTAProtoSpec=b}),98);
__d("MAWXMACTAUtil",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b=a.actionUrl,c=a.buttonType,d=a.nativeUrl;a=a.title;return{actionUrl:b,buttonType:c,nativeUrl:d,title:a}}function b(a){var b=a.actionUrl,c=a.buttonType,d=a.nativeUrl;a=a.title;return{actionUrl:b,buttonType:c,nativeUrl:d,title:a}}f.toMAWCTAEncode=a;f.fromMAWCTAEncode=b}),66);
__d("WAServerSync.pb",["$InternalEnum","WAProtoConst"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({SET:0,REMOVE:1});c={};e={};f={};b={};var h={},i={},j={},k={},l={},m={},n={};c.internalSpec={version:[1,d("WAProtoConst").TYPES.UINT64]};e.internalSpec={code:[1,d("WAProtoConst").TYPES.UINT64],text:[2,d("WAProtoConst").TYPES.STRING]};f.internalSpec={blob:[1,d("WAProtoConst").TYPES.BYTES]};b.internalSpec={blob:[1,d("WAProtoConst").TYPES.BYTES]};h.internalSpec={id:[1,d("WAProtoConst").TYPES.BYTES]};i.internalSpec={index:[1,d("WAProtoConst").TYPES.MESSAGE,f],value:[2,d("WAProtoConst").TYPES.MESSAGE,b],keyId:[3,d("WAProtoConst").TYPES.MESSAGE,h]};j.internalSpec={mediaKey:[1,d("WAProtoConst").TYPES.BYTES],directPath:[2,d("WAProtoConst").TYPES.STRING],handle:[3,d("WAProtoConst").TYPES.STRING],fileSizeBytes:[4,d("WAProtoConst").TYPES.UINT64],fileSha256:[5,d("WAProtoConst").TYPES.BYTES],fileEncSha256:[6,d("WAProtoConst").TYPES.BYTES]};k.internalSpec={version:[1,d("WAProtoConst").TYPES.MESSAGE,c],records:[2,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.MESSAGE,i],mac:[3,d("WAProtoConst").TYPES.BYTES],keyId:[4,d("WAProtoConst").TYPES.MESSAGE,h]};l.internalSpec={mutations:[1,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.MESSAGE,m]};m.internalSpec={operation:[1,d("WAProtoConst").TYPES.ENUM,a],record:[2,d("WAProtoConst").TYPES.MESSAGE,i]};n.internalSpec={version:[1,d("WAProtoConst").TYPES.MESSAGE,c],mutations:[2,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.MESSAGE,m],externalMutations:[3,d("WAProtoConst").TYPES.MESSAGE,j],snapshotMac:[4,d("WAProtoConst").TYPES.BYTES],patchMac:[5,d("WAProtoConst").TYPES.BYTES],keyId:[6,d("WAProtoConst").TYPES.MESSAGE,h],exitCode:[7,d("WAProtoConst").TYPES.MESSAGE,e],deviceIndex:[8,d("WAProtoConst").TYPES.UINT32]};g.SyncdMutation$SyncdOperation=a;g.SyncdVersionSpec=c;g.ExitCodeSpec=e;g.SyncdIndexSpec=f;g.SyncdValueSpec=b;g.KeyIdSpec=h;g.SyncdRecordSpec=i;g.ExternalBlobReferenceSpec=j;g.SyncdSnapshotSpec=k;g.SyncdMutationsSpec=l;g.SyncdMutationSpec=m;g.SyncdPatchSpec=n}),98);
__d("WABinary",["WAErr","WAHex"],(function(a,b,c,d,e,f,g){var h=65533,i=10,j=new Uint8Array(i),k=new Uint8Array(0);a=function(){function a(b,c){var d=this;b===void 0&&(b=k);c===void 0&&(c=!1);this.$1=new Uint8Array(0);this.$2=0;this.$4=0;this.write=function(){for(var b=0;b<arguments.length;b++){var c=b<0||arguments.length<=b?void 0:arguments[b];typeof c==="string"?d.writeString(c):typeof c==="number"?d.writeUint8(c):c instanceof a?d.writeBinary(c):c instanceof ArrayBuffer?d.writeBuffer(c):c instanceof Uint8Array&&d.writeByteArray(c)}};b instanceof ArrayBuffer?(this.$1=new Uint8Array(b),this.$2=this.$4=b.byteLength):b instanceof Uint8Array&&(this.$1=b,this.$2=this.$4=b.length);this.$5=0;this.$6=this.$3=0;this.$7=null;this.$8=c;this.$9=0;this.$10=0}var b=a.prototype;b.size=function(){return this.$2-this.$3};b.peek=function(a,b){this.$9++;var c=this.$3,d=this.$5;try{return a(this,b)}finally{this.$9--,this.$3=c-(this.$5-d)}};b.advance=function(a){this.$11(a)};b.readWithViewParser=function(a,b,c,d){return b(this.$12(),this.$11(a),a,c,d)};b.readWithBytesParser=function(a,b,c,d){return b(this.$1,this.$11(a),a,c,d)};b.readUint8=function(){return p(this,1,r,!1)};b.readInt8=function(){return p(this,1,r,!0)};b.readUint16=function(a){a===void 0&&(a=this.$8);return p(this,2,s,a)};b.readInt32=function(a){a===void 0&&(a=this.$8);return p(this,4,t,a)};b.readUint32=function(a){a===void 0&&(a=this.$8);return p(this,4,u,a)};b.readInt64=function(a){a===void 0&&(a=this.$8);return p(this,8,v,U,a)};b.readUint64=function(a){a===void 0&&(a=this.$8);return p(this,8,v,V,a)};b.readLong=function(a,b){b===void 0&&(b=this.$8);return p(this,8,v,a,b)};b.readFloat32=function(a){a===void 0&&(a=this.$8);return p(this,4,w,a)};b.readFloat64=function(a){a===void 0&&(a=this.$8);return p(this,8,x,a)};b.readVarInt=function(a){var b=this.size();b=q(this,0,y,b);return q(this,b,z,a)};b.readBuffer=function(a){a===void 0&&(a=this.size());return a===0?new ArrayBuffer(0):q(this,a,A)};b.readByteArray=function(a){a===void 0&&(a=this.size());return a===0?new Uint8Array(0):q(this,a,B)};b.readBinary=function(b,c){b===void 0&&(b=this.size());c===void 0&&(c=this.$8);if(b===0)return new a(void 0,c);b=q(this,b,B);return new a(b,c)};b.indexOf=function(a){if(a.length===0)return 0;var b=this.$1,c=this.$2,d=this.$3,e=0,f=d;for(var g=d;g<c;g++)if(b[g]===a[e]){e===0&&(f=g);e++;if(e===a.byteLength)return g-d-a.byteLength+1}else e>0&&(e=0,g=f);return-1};b.readString=function(a){return q(this,a,C)};b.ensureCapacity=function(a){this.$13(this.$3+a)};b.ensureAdditionalCapacity=function(a){this.$13(this.$4+a)};b.writeToView=function(a,b,c,d){var e=this.$14(a);return b(this.$12(),e,a,c,d)};b.writeToBytes=function(a,b,c,d){var e=this.$14(a);return b(this.$1,e,a,c,d)};b.writeUint8=function(a){S(a,0,256,"uint8"),E(this,1,F,a,!1)};b.writeInt8=function(a){S(a,-128,128,"signed int8"),E(this,1,F,a,!0)};b.writeUint16=function(a,b){b===void 0&&(b=this.$8),S(a,0,65536,"uint16"),D(this,2,G,a,b)};b.writeInt16=function(a,b){b===void 0&&(b=this.$8),S(a,-32768,32768,"signed int16"),D(this,2,H,a,b)};b.writeUint32=function(a,b){b===void 0&&(b=this.$8),S(a,0,4294967296,"uint32"),D(this,4,I,a,b)};b.writeInt32=function(a,b){b===void 0&&(b=this.$8),S(a,-2147483648,2147483648,"signed int32"),D(this,4,J,a,b)};b.writeUint64=function(a,b){b===void 0&&(b=this.$8),S(a,0,18446744073709552e3,"uint64"),D(this,8,K,a,b)};b.writeInt64=function(a,b){b===void 0&&(b=this.$8),S(a,-9223372036854776e3,9223372036854776e3,"signed int64"),D(this,8,K,a,b)};b.writeFloat32=function(a,b){b===void 0&&(b=this.$8),D(this,4,L,a,b)};b.writeFloat64=function(a,b){b===void 0&&(b=this.$8),D(this,8,M,a,b)};b.writeVarInt=function(a){S(a,-9223372036854776e3,9223372036854776e3,"varint (signed int64)");var b=a<0;a=b?-a:a;var c=Math.floor(a/4294967296);a=a-c*4294967296;b&&(c=~c,a===0?c++:a=-a);b=R(c,a);E(this,b,N,c,a)};b.writeVarIntFromHexLong=function(a){var b=d("WAHex").hexLongIsNegative(a);a=b?d("WAHex").negateHexLong(a):a;a=d("WAHex").hexLongToHex(a);var c=0,e=0;for(var f=0;f<d("WAHex").NUM_HEX_IN_LONG;f++)c=c<<4|e>>>28,e=e<<4|d("WAHex").hexAt(a,f);b&&(c=~c,e===0?c++:e=-e);a=R(c,e);E(this,a,N,c,e)};b.writeBinary=function(a){a=a.peek(function(a){return a.readByteArray()});if(a.length){var b=this.$14(a.length);this.$1.set(a,b)}};b.writeBuffer=function(a){this.writeByteArray(new Uint8Array(a))};b.writeByteArray=function(a){var b=this.$14(a.length);this.$1.set(a,b)};b.writeBufferView=function(a){this.writeByteArray(new Uint8Array(a.buffer,a.byteOffset,a.byteLength))};b.writeString=function(a){E(this,n(a),O,a)};b.writeHexLong=function(a,b){b===void 0&&(b=this.$8),D(this,8,P,a,b)};b.writeBytes=function(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];for(var d=0;d<b.length;d++)S(b[d],0,256,"byte");E(this,b.length,Q,b)};b.writeAtomically=function(a,b){this.$10++;var c=this.$4,d=this.$5;try{a=a(this,b);c=this.$4;d=this.$5;return a}finally{this.$10--,this.$4=c-(this.$5-d)}};b.writeWithVarIntLength=function(a,b){var c=this.$4;a=this.writeAtomically(a,b);b=this.$4;this.writeVarInt(b-c);var d=this.$4-b,e=this.$1;for(var f=0;f<d;f++)j[f]=e[b+f];for(f=b-1;f>=c;f--)e[f+d]=e[f];for(b=0;b<d;b++)e[c+b]=j[b];return a};a.build=function(){for(var b=arguments.length,c=new Array(b),d=0;d<b;d++)c[d]=arguments[d];var e=0;for(var f=0;f<c.length;f++){var g=c[f];typeof g==="string"?e+=n(g):typeof g==="number"?e++:g instanceof a?e+=g.size():g instanceof ArrayBuffer?e+=g.byteLength:g instanceof Uint8Array&&(e+=g.length)}var h=new a();h.ensureCapacity(e);h.write.apply(h,arguments);return h};b.$12=function(){return this.$7||(this.$7=new DataView(this.$1.buffer,this.$1.byteOffset))};b.$11=function(a){if(a<0)throw c("WAErr")("ReadError: given negative number of bytes to read");var b=this.$3;a=b+a;if(a>this.$2)throw c("WAErr")(b===this.$2?"ReadError: tried to read from depleted binary":"ReadError: tried to read beyond end of binary");this.$3=a;this.$9||(this.$6=a);return b};b.$13=function(a){var b=this.$1;if(a<=b.length)return a;else{var c=this.$6;a=a-c;var d=Math.max(a,2*(b.length-c),64);d=new Uint8Array(d);c?(d.set(b.subarray(c)),this.$5+=c,this.$3-=c,this.$2-=c,this.$4-=c,this.$6=0):d.set(b);this.$1=d;this.$7=null;return a}};b.$14=function(a){a=this.$13(this.$4+a);var b=this.$4;this.$4=a;this.$10||(this.$2=a);return b};return a}();var l="",m=0;function n(a){if(a===l)return m;var b=a.length,c=0;for(var d=0;d<b;d++){var e=a.charCodeAt(d);if(e<128)c++;else if(e<2048)c+=2;else if(e<55296||57344<=e&&e<=65535)c+=3;else if(55296<=e&&e<56320&&d+1!==b){e=a.charCodeAt(d+1);56320<=e&&e<57344?(d++,c+=4):c+=3}else c+=3}l=a;return m=c}function o(a,b,c){var d=b>>21;if(!a)return d===0;else{a=b&2097151;b=Boolean(a||c);return d===0||d===-1&&b}}function p(a,b,c,d,e){return a.readWithViewParser(b,c,d,e)}function q(a,b,c,d,e){return a.readWithBytesParser(b,c,d,e)}function r(a,b,c,d){return d?a.getInt8(b):a.getUint8(b)}function s(a,b,c,d){return a.getUint16(b,d)}function t(a,b,c,d){return a.getInt32(b,d)}function u(a,b,c,d){return a.getUint32(b,d)}function v(a,b,c,d,e){c=a.getInt32(e?b+4:b,e);a=a.getInt32(e?b:b+4,e);return d(c,a)}function w(a,b,c,d){return a.getFloat32(b,d)}function x(a,b,c,d){return a.getFloat64(b,d)}function y(a,b,d,e){d=Math.min(e,i);e=0;var f=128;while(e<d&&f&128)f=a[b+e++];if(e===i&&f>1)throw c("WAErr")("ParseError: varint exceeds 64 bits");else if(f&128)return e+1;return e}function z(b,c,d,a){var e=0,f=0,g=d;d===i&&(g--,f=b[c+g]&1);for(d=g-1;d>=0;d--)e=e<<7|f>>>25,f=f<<7|b[c+d]&127;return a(e,f)}function A(a,b,c){b=b+a.byteOffset;a=a.buffer;return b===0&&c===a.byteLength?a:a.slice(b,b+c)}function B(a,b,c){return a.subarray(b,b+c)}function C(a,b,c){c=b+c;var d=[],e=null;for(b=b;b<c;b++){d.length>5e3&&(e||(e=[]),e.push(String.fromCharCode.apply(String,d)),d=[]);var f=a[b]|0;if((f&128)===0)d.push(f);else if((f&224)===192){var g=W(a,b+1,c);if(g){b++;g=(f&31)<<6|g&63;g>=128?d.push(g):d.push(h)}else d.push(h)}else if((f&240)===224){g=W(a,b+1,c);var i=W(a,b+2,c);if(g&&i){b+=2;i=(f&15)<<12|(g&63)<<6|i&63;i>=2048&&!(55296<=i&&i<57344)?d.push(i):d.push(h)}else g?(b++,d.push(h)):d.push(h)}else if((f&248)===240){i=W(a,b+1,c);g=W(a,b+2,c);var j=W(a,b+3,c);if(i&&g&&j){b+=3;f=(f&7)<<18|(i&63)<<12|(g&63)<<6|j&63;if(f>=65536&&f<=1114111){j=f-65536;d.push(55296|j>>10,56320|j&1023)}else d.push(h)}else i&&g?(b+=2,d.push(h)):i?(b++,d.push(h)):d.push(h)}else d.push(h)}f=String.fromCharCode.apply(String,d);if(e){e.push(f);return e.join("")}else return f}function D(a,b,c,d,e){return a.writeToView(b,c,d,e)}function E(a,b,c,d,e){return a.writeToBytes(b,c,d,e)}function F(a,b,c,d){a[b]=d}function G(a,b,c,d,e){a.setUint16(b,d,e)}function H(a,b,c,d,e){a.setInt16(b,d,e)}function I(a,b,c,d,e){a.setUint32(b,d,e)}function J(a,b,c,d,e){a.setInt32(b,d,e)}function K(a,b,c,d,e){c=d<0;d=c?-d:d;var f=Math.floor(d/4294967296);d=d-f*4294967296;c&&(f=~f,d===0?f++:d=-d);a.setUint32(e?b+4:b,f,e);a.setUint32(e?b:b+4,d,e)}function L(a,b,c,d,e){a.setFloat32(b,d,e)}function M(a,b,c,d,e){a.setFloat64(b,d,e)}function N(a,b,c,d,e){d=d;e=e;c=b+c-1;for(b=b;b<c;b++)a[b]=128|e&127,e=d<<25|e>>>7,d>>>=7;a[c]=e}function O(a,b,c,d){c=b;b=d.length;for(var e=0;e<b;e++){var f=d.charCodeAt(e);if(f<128)a[c++]=f;else if(f<2048)a[c++]=192|f>>6,a[c++]=128|f&63;else if(f<55296||57344<=f)a[c++]=224|f>>12,a[c++]=128|f>>6&63,a[c++]=128|f&63;else if(55296<=f&&f<56320&&e+1!==b){var g=d.charCodeAt(e+1);if(56320<=g&&g<57344){e++;f=65536+((f&1023)<<10|g&1023);a[c++]=240|f>>18;a[c++]=128|f>>12&63;a[c++]=128|f>>6&63;a[c++]=128|f&63}else a[c++]=239,a[c++]=191,a[c++]=189}else a[c++]=239,a[c++]=191,a[c++]=189}}function P(a,b,c,e,f){c=d("WAHex").hexLongIsNegative(e);e=d("WAHex").hexLongToHex(e);var g=0,h=0;for(var i=0;i<16;i++)g=g<<4|h>>>28,h=h<<4|d("WAHex").hexAt(e,i);c&&(g=~g,h===0?g++:h=-h);a.setUint32(f?b+4:b,g,f);a.setUint32(f?b:b+4,h,f)}function Q(a,b,c,d){for(var e=0;e<c;e++)a[b+e]=d[e]}function R(a,b){var c;a?(c=5,a=a>>>3):(c=1,a=b>>>7);while(a)c++,a>>>=7;return c}function S(a,b,d,e){if(typeof a!=="number"||a!==a||Math.floor(a)!==a||a<b||a>=d)throw c("WAErr")(typeof a==="string"?'TyperError WriteError: string "'+a+'" is not a valid '+e:"TypeError WriteError: "+String(a)+" is not a valid "+e)}function T(a,b,d){var e=o(a,b,d),f;b>=0?f=b:f=a?b:4294967296+b;a=d>=0?d:4294967296+d;b=f*4294967296+a;if(!e)throw c("WAErr")("ReadError: integer exceeded 53 bits ("+b+")");return b}function U(a,b){return T(!0,a,b)}function V(a,b){return T(!1,a,b)}function W(a,b,c){if(b>=c)return 0;c=a[b]|0;return(c&192)===128?c:0}g.Binary=a;g.numUtf8Bytes=n;g.longFitsInDouble=o;g.parseInt64OrThrow=U;g.parseUint64OrThrow=V}),98);
__d("WAHasProperty",[],(function(a,b,c,d,e,f){function a(a,b){return Object.prototype.hasOwnProperty.call(a,b)}f["default"]=a}),66);
__d("WAProtoCompile",["WAProtoConst"],(function(a,b,c,d,e,f,g){var h=function(a,b,c,d,e,f,g,h,i){this.names=a,this.fields=b,this.types=c,this.defaults=d,this.meta=e,this.oneofToFields=f,this.fieldToOneof=g,this.reservedTags=h?h.reduce(function(a,b){a[b]=!0;return a},{}):{},this.reservedFields=i?i.reduce(function(a,b){a[b]=!0;return a},{}):{}};function a(a){if(a.internalCompiledSpec)return a.internalCompiledSpec;var b=a.internalSpec;if(!b)throw new Error("Message Class "+String(a)+" does not have internalSpec");var c=a.internalDefaults||{},e=Object.keys(b).filter(function(a){return a!==d("WAProtoConst").KEYS.ONEOF}),f=new Array(e.length),g=[],j=[],k=new Array(e.length),l=b[d("WAProtoConst").KEYS.ONEOF]||{};e.sort(function(a,c){a=i(b,a);c=i(b,c);return a[0]-c[0]});for(var m=0;m<e.length;m++){var n=e[m],o=i(b,n);k[m]=c[n];n=o[1];var p=o[0];g.push(p);j.push(n);if((n&d("WAProtoConst").TYPE_MASK)===d("WAProtoConst").TYPES.MESSAGE)f[m]=o[2];else if((n&d("WAProtoConst").TYPE_MASK)===d("WAProtoConst").TYPES.ENUM){p=o[2];if(typeof p.cast==="function")f[m]=p;else{n=!0;o=0;for(var q in p)n&&q!==o++&&(n=!1);q=void 0;if(n){q=[];for(n=0;n<o;n++)q.push(!0)}else{q={};for(n in p)q[p[n]]=!0}f[m]=q}}else f[m]=null}var r={};o=function(a){l[a].forEach(function(b){r[b]||(r[b]=[]),r[b].push(a)})};for(n in l)o(n);p=b[d("WAProtoConst").KEYS.RESERVED]&&b[d("WAProtoConst").KEYS.RESERVED][d("WAProtoConst").KEYS.RESERVED_TAGS];q=b[d("WAProtoConst").KEYS.RESERVED]&&b[d("WAProtoConst").KEYS.RESERVED][d("WAProtoConst").KEYS.RESERVED_FIELDS];m=new h(e,g,j,k,f,l,r,p,q);a.internalCompiledSpec=m;return m}function i(a,b){a=a[b];if(a==null)throw new Error("fieldData of "+b+" is missing");return a}g.Spec=h;g.compileSpec=a}),98);
__d("WAProtoUtils",["WAProtoConst"],(function(a,b,c,d,e,f,g){function a(a){if(a&d("WAProtoConst").FLAGS.PACKED)return d("WAProtoConst").ENC.BINARY;a=a&d("WAProtoConst").TYPE_MASK;if(a<=d("WAProtoConst").TYPES.ENUM)return d("WAProtoConst").ENC.VARINT;else if(a<=d("WAProtoConst").TYPES.DOUBLE)return d("WAProtoConst").ENC.BIT64;else if(a<=d("WAProtoConst").TYPES.MESSAGE)return d("WAProtoConst").ENC.BINARY;else return d("WAProtoConst").ENC.BIT32}g.typeToEncType=a}),98);
__d("WAProtoValidate",["WAHasProperty","WALogger","WAProtoCompile","WAProtoConst"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(['"','" is not an array']);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(['"','" is not ',""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(['"','" is out of range']);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(['"','" is not a valid int']);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(['"','" is not a valid long']);l=function(){return a};return a}var m=Number.MAX_SAFE_INTEGER;function n(a,b){a=o(a,b);if(a){a.reverse();throw new TypeError("Message missing required value "+a.join("."))}}function a(a,b){n(a,b);b=u(b,a);if(b){b.path.reverse();throw new TypeError("Invalid value at "+b.path.join(".")+": "+b.error)}}function o(a,b){a=d("WAProtoCompile").compileSpec(a);var e=a.names,f=a.types;a=a.meta;var g=void 0;for(var h=0;h<f.length&&!g;h++){var i=f[h],j=e[h],k=c("WAHasProperty")(b,j)?b[j]:void 0;if(i&d("WAProtoConst").FLAGS.REQUIRED&&k==null)g=[j];else if((i&d("WAProtoConst").TYPE_MASK)===d("WAProtoConst").TYPES.MESSAGE&&i&d("WAProtoConst").FLAGS.REPEATED&&k!=null){var l=a[h],m=void 0;for(m=0;m<k.length&&!g;m++)g=o(l,k[m]);g&&g.push(j+"["+m+"]")}else(i&d("WAProtoConst").TYPE_MASK)===d("WAProtoConst").TYPES.MESSAGE&&k!=null&&(g=o(a[h],k),g&&g.push(j))}return g}function p(a,b,c){if(typeof a==="string")if(/^-?0x[0-9a-f]{16}$/i.test(a))return!1;else{d("WALogger").LOG(l(),s(a)).color("red");return{path:[],error:"value must be a hex string of the form '0x123...' or '-0x123...' where the tail is always 16 characters long"}}else return q(a,b,c)}function q(a,b,c){if(typeof a!=="number"||a!==a||Math.floor(a)!==a){d("WALogger").LOG(k(),s(a)).color("red");return{path:[],error:"value must be an int"}}else if(a<b||a>=c){d("WALogger").LOG(j(),s(a)).color("red");return{path:[],error:"value is out of range"}}else return!1}function r(a,b,c){if(a)return void 0;else{d("WALogger").LOG(i(),s(c),b).color("red");return{path:[],error:"value is invalid"}}}function s(a){if(typeof a==="string")return'"'+a+'"';else if(Array.isArray(a))return"["+a.join(", ")+"]";else return""+a}var t=[void 0,function(a){return q(a,-2147483648,2147483648)},function(a){return p(a,-m,m+1)},function(a){return q(a,0,4294967296)},function(a){return p(a,0,m+1)},function(a){return q(a,-2147483648,2147483648)},function(a){return p(a,-m,m+1)},function(a){return r(typeof a==="boolean","boolean",a)},function(a,b){return r(typeof a==="number"&&(b[a]||b.cast(a)!==void 0),"in enum",a)},function(a){return p(a,0,m+1)},function(a){return p(a,-m,m+1)},function(a){return r(typeof a==="number","number",a)},function(a){return r(typeof a==="string","string",a)},function(a){return r(a instanceof ArrayBuffer||a instanceof Uint8Array,"ArrayBuffer or Uint8Array",a)},u,function(a){return q(a,0,4294967296)},function(a){return q(a,-2147483648,2147483648)},function(a){return r(typeof a==="number","number",a)}];function u(a,b){b=d("WAProtoCompile").compileSpec(b);var c=b.names,e=b.fields,f=b.types,g=b.meta,i=b.oneofToFields,j=b.fieldToOneof,k=b.reservedTags,l=b.reservedFields,m=void 0;b=function(b){var n=c[b],o=f[b],p=a[n],q=o&d("WAProtoConst").TYPE_MASK,r=t[q];if(r===void 0)throw new Error("Can not find the validator for type "+q);if(o&(d("WAProtoConst").FLAGS.PACKED|d("WAProtoConst").FLAGS.REPEATED)&&p!=null)if(!Array.isArray(p))d("WALogger").LOG(h(),s(p)).color("red"),m={path:[n],error:"repeated field must be array"};else{q=g[b];for(o=0;o<p.length&&!m;o++)m=r(p[o],q),m&&m.path.push(n+"["+o+"]")}else if(p!=null){m=r(p,g[b]);m&&m.path.push(n);o=j[n];o&&o.forEach(function(b){var c=i[b].filter(function(a){return a!==n});c.forEach(function(c){typeof a[c]!=="undefined"&&(m={path:[b],error:"oneof '"+b+"' has fields '"+n+"' and '"+c+"' set"})})});k[e[b]]&&(m={path:[n],error:"tag "+e[b]+" is reserved"});l[n]&&(m={path:[n],error:"field "+n+" is reserved"})}};for(var n=0;n<c.length&&!m;n++)b(n);return m}g.checkRequirements=n;g.checkValid=a}),98);
__d("decodeProtobuf",["WABinary","WAHasProperty","WAHex","WAProtoCompile","WAProtoConst","WAProtoUtils","WAProtoValidate"],(function(a,b,c,d,e,f,g){function a(a,b){b=new(d("WABinary").Binary)(b);b=n(a,b,void 0,!1);d("WAProtoValidate").checkRequirements(a,b);return b}function b(a,b){b=new(d("WABinary").Binary)(b);b=n(a,b,void 0,!0);d("WAProtoValidate").checkRequirements(a,b);return b}function e(a){return c("WAHasProperty")(a,"$$unsafeUnknownFields")?a.$$unsafeUnknownFields:null}function h(a,b,c){if(a!==d("WAProtoUtils").typeToEncType(b))throw new Error("FormatError: "+c+" encoded with wire type "+a)}function i(a,b,c){switch(b){case d("WAProtoConst").TYPES.INT32:return j(c,-2147483648,2147483648,a,d("WABinary").parseInt64OrThrow);case d("WAProtoConst").TYPES.INT64:return c.readVarInt(k);case d("WAProtoConst").TYPES.UINT32:return j(c,0,4294967296,a,d("WABinary").parseUint64OrThrow);case d("WAProtoConst").TYPES.UINT64:return c.readVarInt(l);case d("WAProtoConst").TYPES.SINT32:b=j(c,0,4294967296,a,d("WABinary").parseInt64OrThrow);return b&1?~(b>>>1):b>>>1;case d("WAProtoConst").TYPES.SINT64:return c.readVarInt(m);case d("WAProtoConst").TYPES.BOOL:return!!j(c,0,2,a,d("WABinary").parseUint64OrThrow);case d("WAProtoConst").TYPES.ENUM:return c.readVarInt(d("WABinary").parseInt64OrThrow);case d("WAProtoConst").TYPES.FIXED64:return c.readLong(l,!0);case d("WAProtoConst").TYPES.SFIXED64:return c.readLong(k,!0);case d("WAProtoConst").TYPES.DOUBLE:return c.readFloat64(!0);case d("WAProtoConst").TYPES.STRING:return c.readString(c.readVarInt(d("WABinary").parseUint64OrThrow));case d("WAProtoConst").TYPES.BYTES:return c.readBuffer(c.readVarInt(d("WABinary").parseUint64OrThrow));case d("WAProtoConst").TYPES.FIXED32:return c.readUint32(!0);case d("WAProtoConst").TYPES.SFIXED32:return c.readInt32(!0);case d("WAProtoConst").TYPES.FLOAT:return c.readFloat32(!0)}}function j(a,b,c,d,e){a=a.readVarInt(e);if(a<b||a>=c)throw new Error("FormatError: "+d+" encoded with out-of-range value "+a);return a}function k(a,b){var c=d("WABinary").longFitsInDouble(!0,a,b);if(c){c=o(b);return a*4294967296+c}else{c=a<0;var e;c?e=b===0?-a:~a:e=a;a=c?-b:b;return d("WAHex").createHexLongFrom32Bits(e,a,c)}}function l(a,b){var c=d("WABinary").longFitsInDouble(!1,a,b);if(c){c=o(a);var e=o(b);return c*4294967296+e}else return d("WAHex").createHexLongFrom32Bits(a,b)}function m(a,b){var c=a>>>1;a=a<<31|b>>>1;b&1&&(c=~c,a=~a);return k(c,a)}function n(a,b,c,e){var f=d("WAProtoCompile").compileSpec(a),g=f.names,k=f.fields,l=f.types,m=f.meta,o=f.oneofToFields,p=f.fieldToOneof,q=f.reservedTags,r=f.reservedFields;f=a.internalDefaults;var s=c||babelHelpers["extends"]({},f)||{};s.$$unknownFieldCount=(a=c==null?void 0:c.$$unknownFieldCount)!=null?a:0;for(f=0;f<g.length;f++)l[f]&d("WAProtoConst").FLAGS.REPEATED&&(s[g[f]]=[]);var t=0;c=k.length>0;a=k[0];while(b.size()){f=j(b,0,4294967296,"field and enc type",d("WABinary").parseInt64OrThrow);var u=f&7,v=f>>>3;if(c&&v!==a){f=t;do++t===k.length&&(t=0),a=k[t];while(v!==a&&t!==f)}if(c&&v===a)(function(){var a=g[t],c=l[t];h(u,c,a);var f=c&d("WAProtoConst").TYPE_MASK,j=m[t];if(c&d("WAProtoConst").FLAGS.PACKED){var k=b.readVarInt(d("WABinary").parseUint64OrThrow);k=b.readBinary(k);while(k.size()){var w=i(a,f,k);(f!==d("WAProtoConst").TYPES.ENUM||j[w]||(j.cast==null?void 0:j.cast(w))!==void 0)&&s[a].push(w)}}else if(f===d("WAProtoConst").TYPES.MESSAGE){w=b.readVarInt(d("WABinary").parseUint64OrThrow);k=b.readBinary(w);if(c&d("WAProtoConst").FLAGS.REPEATED)s[a].push(n(j,k,void 0,e));else{w=s[a];s[a]=n(j,k,w,e)}}else{k=i(a,f,b);(f!==d("WAProtoConst").TYPES.ENUM||j[k]||(j.cast==null?void 0:j.cast(k))!==void 0)&&(c&d("WAProtoConst").FLAGS.REPEATED?s[a].push(k):s[a]=k)}w=p[a];w&&typeof s[a]!=="undefined"&&w.forEach(function(b){b=o[b].filter(function(b){return b!==a});b.forEach(function(a){delete s[a]})});(q[v]||r[a])&&delete s[a]})();else{s.$$unknownFieldCount++;if(e){s.$$unsafeUnknownFields||(s.$$unsafeUnknownFields={});f=void 0;switch(u){case d("WAProtoConst").ENC.VARINT:f=b.readVarInt(d("WABinary").parseInt64OrThrow);break;case d("WAProtoConst").ENC.BIT64:f=b.readBinary(8);break;case d("WAProtoConst").ENC.BINARY:f=b.readBinary(b.readVarInt(d("WABinary").parseUint64OrThrow));break;case d("WAProtoConst").ENC.BIT32:f=b.readBinary(4);break}s.$$unsafeUnknownFields[v]=f}else u===d("WAProtoConst").ENC.VARINT?b.readVarInt(d("WABinary").parseInt64OrThrow):u===d("WAProtoConst").ENC.BIT64?b.advance(8):u===d("WAProtoConst").ENC.BINARY?b.advance(b.readVarInt(d("WABinary").parseUint64OrThrow)):u===d("WAProtoConst").ENC.BIT32&&b.advance(4)}}return s}function o(a){return a>=0?a:4294967296+a}g.decodeProtobuf=a;g.decodeProtobufWithUnknowns=b;g.getUnknownFields=e}),98);
__d("MAWDbObjDecode",["MAWArmadilloAppDataTableSchema.pb","MAWArmadilloAppMetaTableSchema.pb","MAWArmadilloCollectionVersionsTableSchema.pb","MAWArmadilloContactsTableSchema.pb","MAWArmadilloDeviceChangeAlertsTableSchema.pb","MAWArmadilloDyiBatchTableSchema.pb","MAWArmadilloEditMsgHistoryTableSchema.pb","MAWArmadilloGroupInfoTableSchema.pb","MAWArmadilloGroupInvitesTableSchema.pb","MAWArmadilloMediaTablesSchema.pb","MAWArmadilloMessagesTableSchema.pb","MAWArmadilloMetaRowTableSchema.pb","MAWArmadilloMissingKeysTableSchema.pb","MAWArmadilloParticipantsTableSchema.pb","MAWArmadilloPendingMutationsTableSchema.pb","MAWArmadilloPersonalSenderKeyStatusTableSchema.pb","MAWArmadilloReactionsTableSchema.pb","MAWArmadilloReceiptTablesSchema.pb","MAWArmadilloRetroactiveBackupsStateTableSchema.pb","MAWArmadilloSignalTablesSchema.pb","MAWArmadilloSyncActionsTableSchema.pb","MAWArmadilloSyncKeysTableSchema.pb","MAWArmadilloTasksTableSchema.pb","MAWArmadilloThreadsTableSchema.pb","MAWArmadilloUnrenderedMessagesTableSchema.pb","MAWArmadilloXMATableSchema.pb","MAWMsgType","MAWXMACTAUtil","WAServerSync.pb","decodeProtobuf","err"],(function(a,b,c,d,e,f,g){var h={appData:function(a){return I(a)},appMeta:function(a){return J(a)},browserEncryptionMeta:function(a){throw c("err")("unexpected table for decryption")},chunk:function(a){return K(a)},collectionVersions:function(a){return T(a)},contacts:function(a){return D(a)},deviceChangeAlerts:function(a){return i(a)},dualSendMedia:function(a){throw c("err")("unexpected table for decryption")},dyiBatch:function(a){return O(a)},editMsgHistory:function(a){return W(a)},existingUsers:function(a){throw c("err")("unexpected table for decryption")},ftsBackloggedMessages:function(a){throw c("err")("unexpected table for decryption")},ftsEncryptionMeta:function(a){throw c("err")("unexpected table for decryption")},ftsIndexV3:function(a){throw c("err")("unexpected table for decryption")},groupInfo:function(a){return p(a)},groupInvites:function(a){return F(a)},historySyncQRCodeData:function(a){throw c("err")("unexpected table for decryption")},historySyncQRCodeSecretKey:function(a){throw c("err")("unexpected table for decryption")},identity:function(a){return s(a)},isDualSend:function(a){throw c("err")("unexpected table for decryption")},jobs:function(a){throw c("err")("unexpected table for decryption")},media:function(a){return M(a)},mediaBackup:function(a){return L(a)},messages:function(a){return m(a)},meta:function(a){return r(a)},missingKeys:function(a){return R(a)},participants:function(a){return E(a)},pendingMutations:function(a){return S(a)},pendingReceipts:function(a){return B(a)},pendingStanzas:function(a){throw c("err")("unexpected table for decryption")},personalSenderKeyStatuses:function(a){return H(a)},prekey:function(a){return t(a)},prekeyGeneration:function(a){return u(a)},reactions:function(a){return N(a)},receipts:function(a){return A(a)},retroactiveBackupsState:function(a){return P(a)},senderKeySessions:function(a){return x(a)},session:function(a){return v(a)},signedPrekey:function(a){return w(a)},stanzaQueue:function(a){throw c("err")("unexpected table for decryption")},syncActions:function(a){return Q(a)},syncKeys:function(a){return U(a)},tasks:function(a){return G(a)},threads:function(a){return C(a)},unrenderedMessages:function(a){return n(a)},uploadRetryStatus:function(a){throw c("err")("unexpected table for decryption")},xma:function(a){return V(a)}};function a(a,b){if(Object.prototype.hasOwnProperty.call(h,b))b=h[b](a);else throw c("err")("not a valid table name");return b}function i(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloDeviceChangeAlertsTableSchema.pb").DeviceChangeAlertsTableSchemaProtoSpec,a);return{action:a.action,deviceJid:a.deviceJid,identity:a.identity,isArchived:a.isArchived,latitude:a.latitude,location:a.location,loggedOut:a.loggedOut,longitude:a.longitude,model:a.model,platform:a.platform,ts:a.ts}}function j(a){a=a.quote;var b;if(a!=null){if(a.content==null)throw c("err")("QuotedMsgContent missing upon decoding");var d=a.content,e=d.author,f=d.externalId,g=d.mediaId,h=d.msgContent,i=d.msgId,j=d.sourceId,k=d.specialTextSize,l=d.ts,m=d.type;d=d.xmaMessageType;b={content:babelHelpers["extends"]({},a.content,{author:e,externalId:f,mediaId:g,msgContent:h,msgId:i,sourceId:j,specialTextSize:k,ts:l,type:m,xmaMessageType:d}),remoteJid:a.remoteJid}}return b}function k(a){if(a==null)return a;else return new Uint8Array(a)}function l(a){if(a==null||a.length===0)return new Set();else return new Set(a)}function m(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloMessagesTableSchema.pb").MessagesTableSchemaProtoSpec,a);var b=a.msgContent;if(a.type===d("MAWMsgType").MSG_TYPE.FUTUREPROOF){if(b==null)throw c("err")("MsgContent missing upon decoding futureproof message");b.subtype=b.subtype}var e=j(a),f=o(a.reportingMeta);return babelHelpers["extends"]({},a,{msgContent:b,quote:e,reportingMeta:f})}function n(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloUnrenderedMessagesTableSchema.pb").UnrenderedMessagesTableSchemaProtoSpec,a);var b=j(a),c=o(a.reportingMeta);return babelHelpers["extends"]({},a,{quote:b,reportingMeta:c})}function o(a){if(a==null)return;return{frankingKey:a.frankingKey!=null?new Uint8Array(a.frankingKey):a.frankingKey,frankingTag:a.frankingTag!=null?new Uint8Array(a.frankingTag):a.frankingTag,frankingVersion:a.frankingVersion,reportingContent:a.reportingContent,reportingTag:a.reportingTag!=null?new Uint8Array(a.reportingTag):a.reportingTag}}function p(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloGroupInfoTableSchema.pb").GroupInfoSchemaProtoSpec,a);return{creationTs:a.creationTs,creator:a.creator,inviter:a.inviter,msgExpiration:a.msgExpiration,name:a.name,nameOwner:a.nameOwner,nameTs:a.nameTs,participantVersion:a.participantVersion}}function q(a,b){var d;a=a;if(a==null)d=a;else{var e=a.privateKey;a=a.publicKey;if(e==null||a==null)throw c("err")("Decoding "+b+" private or public key missing");d={privateKey:new Uint8Array(e),publicKey:new Uint8Array(a)}}return d}function r(a){var b,c,e,f;a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloMetaRowTableSchema.pb").MetaRowTableSchemaProtoSpec,a);b=(b=a.value)==null?void 0:b.cat;if(b==null)b=b;else{var g;b={encrypted_serialized_cat:(g=a.value)==null?void 0:(g=g.cat)==null?void 0:g.encryptedSerializedCat,expiration_time_in_seconds:(g=a.value)==null?void 0:(g=g.cat)==null?void 0:g.expirationTimeInSeconds}}g=(g=a.value)==null?void 0:g.edgeInfo;g=k(g);c=q((c=a.value)==null?void 0:c.identityKeyPair,"identityKeyPair");e=q((e=a.value)==null?void 0:e.authKeyPair,"authKeyPair");return{value:{abProps:(f=a.value)==null?void 0:f.abProps,authKeyPair:e,cat:b,certificateChain:(f=a.value)==null?void 0:f.certificateChain,clockSkew:(e=a.value)==null?void 0:e.clockSkew,deviceId:(b=a.value)==null?void 0:b.deviceId,deviceUUID:(f=a.value)==null?void 0:f.deviceUUID,edgeInfo:g,fbid:(e=a.value)==null?void 0:e.fbid,identityKeyPair:c,lastPrekeyGenerationId:(b=a.value)==null?void 0:b.lastPrekeyGenerationId,lastPrekeyId:(f=a.value)==null?void 0:f.lastPrekeyId,lastSessionDeviceWasLinkedTo:(g=a.value)==null?void 0:g.lastSessionDeviceWasLinkedTo,lastSignedPrekeyId:(e=a.value)==null?void 0:e.lastSignedPrekeyId,regId:(c=a.value)==null?void 0:c.regId,registrationVersion:(b=a.value)==null?void 0:b.registrationVersion}}}function s(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloSignalTablesSchema.pb").IdentityTableSchemaProtoSpec,a);var b=a.identity,c=a.firstSeenTs;b=k(b);return{deviceName:a.deviceName,firstSeenTs:c,identity:b,platform:a.platform}}function t(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloSignalTablesSchema.pb").PrekeyTableSchemaProtoSpec,a);var b=a.encoded;b=k(b);return{encoded:b,isDeleted:a.isDeleted}}function u(a){return d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloSignalTablesSchema.pb").PrekeyGenerationTableSchemaProtoSpec,a)}function v(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloSignalTablesSchema.pb").SessionTableSchemaProtoSpec,a);a=a.session;a=k(a);return{session:a}}function w(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloSignalTablesSchema.pb").SignedPrekeyTableSchemaProtoSpec,a);a=a.encoded;a=k(a);return{encoded:a}}function x(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloSignalTablesSchema.pb").SenderKeySessionsTableSchemaProtoSpec,a);var b=a.record;b=k(b);return{deviceId:a.deviceId,record:b}}function y(a){if(a.length===0)return null;else return new Map(a.map(function(a){var b=a.deviceJid;if(b==null||a.serializedPubKey==null)throw c("err")("Expected deviceJid or serializedPubKey are missing ");var d=new Uint8Array(a.serializedPubKey);a=k(a.baseKey);a={baseKey:a,pubKey:d};return[b,a]}))}function z(a){if(a==null)return null;else return new Map(a.map(function(a){if(a.deviceJid==null)throw c("err")("Expected deviceJID is missing ");return[a.deviceJid,(a=a.count)!=null?a:0]}))}function A(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloReceiptTablesSchema.pb").ReceiptsTableSchemaProtoSpec,a);var b,e=a.statusTsPerUser;e==null?b=new Map():b=new Map(e.map(function(a){if(a.userJid==null||a.dbUserStatusTs==null)throw c("err")("Expected userJid or dbUserStatus are missing ");return[a.userJid,a.dbUserStatusTs]}));e=a.recipientDevices;e=l(e);return{permittedIdentitiesPerDevice:y(a.permittedIdentitiesPerDevice),recipientDevices:e,retryCountsPerDevice:z(a.retryCountsPerDevice),statusTsPerUser:b}}function B(a){return d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloReceiptTablesSchema.pb").PendingReceiptsTableSchemaProtoSpec,a)}function C(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloThreadsTableSchema.pb").ThreadsTableSchemaProtoSpec,a);return{archived:a.archived,cannotReplyReason:a.cannotReplyReason,folder:a.folder,isMigratedLocally:a.isMigratedLocally,lastReadMsg:a.lastReadMsg,lastReadMsgReceiptSent:a.lastReadMsgReceiptSent,lastReadMsgTs:a.lastReadMsgTs,muteCallsExpireTimeMs:a.muteCallsExpireTimeMs,muteExpireTimeMs:a.muteExpireTimeMs,newestMsg:a.newestMsg,newestMsgTs:a.newestMsgTs,nextInChatMsgId:a.nextInChatMsgId,oldestMsg:a.oldestMsg,optimisticThreadKey:a.optimisticThreadKey,snippetMsg:a.snippetMsg}}function D(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloContactsTableSchema.pb").ContactsTableSchemaProtoSpec,a);var b=a.icdcInfo,c;b!=null&&(c={devices:b.devices.map(function(a){return new Uint8Array(a)}),dirty:b.dirty,sequence:b.sequence,signingDeviceIndex:b.signingDeviceIndex,timestamp:b.timestamp});return{dhash:a.dhash,ephemeralSetting:a.ephemeralSetting,ephemeralSyncResponseBackoffInfo:a.ephemeralSyncResponseBackoffInfo,icdcFails:a.icdcFails,icdcInfo:c,isBlocked:a.isBlocked,isRestricted:a.isRestricted,lastSyncTs:a.lastSyncTs,nameForSearch:a.nameForSearch,relationship:a.relationship}}function E(a){return d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloParticipantsTableSchema.pb").ParticipantsTableSchemaProtoSpec,a)}function F(a){return d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloGroupInvitesTableSchema.pb").GroupInvitesTableSchemaProtoSpec,a)}function G(a){return d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloTasksTableSchema.pb").TasksTableSchemaProtoSpec,a)}function H(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloPersonalSenderKeyStatusTableSchema.pb").PersonalSenderKeyStatusTableSchemaProtoSpec,a);var b=a.hasSenderKey;b=l(b);return{hasSenderKey:b,rotateSenderKey:a.rotateSenderKey,senderKeyId:a.senderKeyId,senderKeyTs:a.senderKeyTs}}function I(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloAppDataTableSchema.pb").AppDataTableSchemaProtoSpec,a);return{ack:a.ack,contents:a.contents,permittedIdentitiesPerDevice:y(a.permittedIdentitiesPerDevice),recipientDevices:new Set(a.recipientDevices),sendPartial:a.sendPartial,ts:a.ts}}function J(a){return d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloAppMetaTableSchema.pb").AppMetaTableSchemaProtoSpec,a)}function K(a){return d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloMediaTablesSchema.pb").ChunkTableSchemaProtoSpec,a)}function L(a){return d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloMediaTablesSchema.pb").MediaBackupSchemaProtoSpec,a)}function M(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloMediaTablesSchema.pb").MediaTableSchemaProtoSpec,a);var b,e=a.mediaEntries;e==null?b=new Map():b=new Map(e.map(function(a){if(a.msgId==null||a.mediaEntryData==null)throw c("err")("Expected msgId or mediaEntryData are missing ");return[a.msgId,new Uint8Array(a.mediaEntryData)]}));return{mediaEntries:b,mediaType:a.mediaType,plaintextHash:a.plaintextHash,size:a.size,ts:a.ts,validatedAudioInfo:a.validatedAudioInfo,validatedDocumentFileInfo:a.validatedDocumentFileInfo,validatedImageInfo:a.validatedImageInfo,validatedVideoInfo:a.validatedVideoInfo}}function N(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloReactionsTableSchema.pb").ReactionsTableSchemaProtoSpec,a);return{ack:a.ack,author:a.author,groupingKey:a.groupingKey,reaction:a.reaction,reactToAuthor:a.reactToAuthor,ts:a.ts}}function O(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloDyiBatchTableSchema.pb").DyiBatchTableSchemaProtoSpec,a);return{isThread:a.isThread,numMessages:a.numMessages,numMessagesRestored:a.numMessagesRestored,numThreadsRestored:a.numThreadsRestored,oldestTs:a.oldestTs,qplFlowDescriptor:a.qplFlowDescriptor,qplInstanceKeyE2E:a.qplInstanceKeyE2E,qplInstanceKeyForThread:a.qplInstanceKeyForThread,threadId:a.threadId}}function P(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloRetroactiveBackupsStateTableSchema.pb").RetroactiveBackupsStateTableSchemaProtoSpec,a);return{msgId:a.msgId}}function Q(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloSyncActionsTableSchema.pb").SyncActionsTableSchemaProtoSpec,a);return{binarySyncData:a.binarySyncData,keyId:a.keyId,timestamp:a.timestamp,valueMac:a.valueMac,version:a.version}}function R(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloMissingKeysTableSchema.pb").MissingKeysTableSchemaProtoSpec,a);var b;a.deviceResponses==null?b=new Map():b=new Map(a.deviceResponses.map(function(a){if(a.deviceId==null)throw c("err")("Expected deviceId is missing");else return[a.deviceId,a.deviceResponse]}));return{deviceResponses:b,keyId:a.keyId,timestamp:a.timestamp}}function S(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloPendingMutationsTableSchema.pb").PendingMutationsTableSchemaProtoSpec,a);var b;switch(a.operation){case d("MAWArmadilloPendingMutationsTableSchema.pb").SYNCD_MUTATION_SYNCD_OPERATION.SET:b=d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET;break;case d("MAWArmadilloPendingMutationsTableSchema.pb").SYNCD_MUTATION_SYNCD_OPERATION.REMOVE:b=d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE;break;default:throw c("err")("operation missing when decoding PendingMutation")}return{binarySyncAction:a.binarySyncAction,operation:b,timestamp:a.timestamp,version:a.version}}function T(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloCollectionVersionsTableSchema.pb").CollectionVersionsTableSchemaProtoSpec,a);return{finiteFailureStartTime:a.finiteFailureStartTime,isCollectionInMacMismatchFatal:a.isCollectionInMacMismatchFatal,ltHash:a.ltHash,state:a.state,version:a.version}}function U(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloSyncKeysTableSchema.pb").SyncKeysTableSchemaProtoSpec,a);return{fingerprint:a.fingerprint,keyData:a.keyData,timestamp:a.timestamp}}function V(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloXMATableSchema.pb").XMATableSchemaProtoSpec,a);return{author:a.author,ctas:a.ctas.map(function(a){return d("MAWXMACTAUtil").fromMAWCTAEncode(a)}),defaultCTA:a.defaultCTA==null?a.defaultCTA:d("MAWXMACTAUtil").fromMAWCTAEncode(a.defaultCTA),headerTitle:a.headerTitle,isTombstoned:a.isTombstoned,maxSubtitleNumOfLines:a.maxSubtitleNumOfLines,maxTitleNumOfLines:a.maxTitleNumOfLines,msgId:a.msgId,overlayDescription:a.overlayDescription,overlayIconGlyph:a.overlayIconGlyph,overlayTitle:a.overlayTitle,previewMediaIds:a.previewMediaIds,subtitleText:a.subtitleText,targetId:a.targetId,targetType:a.targetType,targetUsername:a.targetUsername,threadJid:a.threadJid,titleText:a.titleText,xmaLayoutType:a.xmaLayoutType}}function W(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloEditMsgHistoryTableSchema.pb").EditMsgHistoryTableSchemaProtoSpec,a);return{author:a.author,editTs:a.editTs,msgContent:a.msgContent,specialTextSize:a.specialTextSize}}g.decodeDbObj=a}),98);
__d("WASyncdConst",["$InternalEnum","WATimeUtils"],(function(a,b,c,d,e,f,g){a=1e3;c=1e3*60*60;e=2;f=d("WATimeUtils").DAY_MILLISECONDS*2;d=100;var h=2e3,i=10,j=100,k=0,l=3,m=7,n=(b=b("$InternalEnum"))({Star:"star",Contact:"contact",Mute:"mute",PinDEPRECATED:"pin",Pin:"pin_v1",SettingPushName:"setting_pushName",LabelEdit:"label_edit",LabelMessage:"label_message",LabelJid:"label_jid",QuickReply:"quick_reply",LocaleSetting:"setting_locale",Archive:"archive",MarkChatAsRead:"markChatAsRead",ClearChat:"clearChat",DeleteMessageForMe:"deleteMessageForMe",Sentinel:"sentinel",UnarchiveChatsSetting:"setting_unarchiveChats",DeleteChat:"deleteChat",AndroidUnsupportedActions:"android_unsupported_actions",PrimaryFeature:"primary_feature",Subscription:"subscription",Nux:"nux",Agent:"deviceAgent",TimeFormat:"time_format",UserStatusMute:"userStatusMute",PrimaryVersion:"primary_version",RemoveRecentSticker:"removeRecentSticker",ChatAssignment:"agentChatAssignment",ChatAssignmentOpenedStatus:"agentChatAssignmentOpenedStatus",FavoriteSticker:"favoriteSticker",PnForLidChat:"pnForLidChat",ShareOwnPn:"shareOwnPn",ExternalWebBeta:"external_web_beta",MarketingMessage:"marketingMessage",MarketingMessageBroadcast:"marketingMessageBroadcast"}),o=b({Regular:"regular",RegularLow:"regular_low",RegularHigh:"regular_high",CriticalBlock:"critical_block",CriticalUnblockLow:"critical_unblock_low"}),p=b.Mirrored(["Success","SuccessHasMore","Conflict","ConflictHasMore","ErrorRetry","ErrorFatal","Blocked"]),q=b.Mirrored(["UpToDate","Dirty","FailingFiniteRetry","Fatal","Blocked"]),r=b.Mirrored(["Success","Malformed","Orphan","Unsupported","Skipped","Failed"]),s=b.Mirrored(["Msg","Chat","Agent","ChatAssignment","UserStatusMute"]),t=b.Mirrored(["ApplyRemoteAndDropLocal","SkipRemote","SkipRemoteAndDropLocal"]);b=b.Mirrored(["Patch","Snapshot","Local"]);g.BACKOFF_MIN_TIMEOUT=a;g.BACKOFF_MAX_TIMEOUT=c;g.BACKOFF_BASE=e;g.FINITE_FAILURE_EXPIRY_DURATION=f;g.MIN_INLINE_MUTATIONS=d;g.MAX_INLINE_MUTATIONS=h;g.MIN_PATCH_SIZE=i;g.MAX_PATCH_SIZE=j;g.DEFAULT_COLLECTION_VERSION=k;g.LABEL_ASSOCIATION_SYNC_VERSION=l;g.CHAT_ASSIGNMENT_SYNC_VERSION=m;g.Actions=n;g.CollectionName=o;g.CollectionState=p;g.CollectionSyncState=q;g.SyncActionState=r;g.SyncModelType=s;g.ConflictResolutionState=t;g.SyncDataType=b}),98);
__d("WASyncdKeyTypes",[],(function(a,b,c,d,e,f){function a(a){return a}function b(a){return a}function c(a){return a}function d(a){return a}f.toSyncKeyId=a;f.fromSyncKeyId=b;f.toSyncKeyData=c;f.fromSyncKeyData=d}),66);
__d("encodeProtobuf",["WABinary","WAHex","WAProtoCompile","WAProtoConst","WAProtoUtils","WAProtoValidate"],(function(a,b,c,d,e,f,g){var h=void 0,i=128;function a(a,b,c){c===void 0&&(c=new(d("WABinary").Binary)());d("WAProtoValidate").checkValid(a,b);o(c,b,a);h=void 0;return c}function b(){return h!==void 0?"Last encoded value for "+h:"No information known"}function c(a,b){a.writeVarInt(b)}function e(a,b){if(typeof b==="number"&&b<4503599627370496&&b>=-4503599627370496)a.writeVarInt(b>=0?2*b:2*-b-1);else{var c=new(d("WABinary").Binary)(),e;typeof b==="number"?(e=b<0,c.writeVarInt(e?-b:b)):(e=d("WAHex").hexLongIsNegative(b),c.writeVarIntFromHexLong(e?d("WAHex").negateHexLong(b):b));b=c.peek(function(){return c.readByteArray()});var f=b.byteLength;if(e){var g=0,h;do h=b[g],b[g]=h&i|(h&127)-1&127,g++;while(b[g-1]===255)}h=e?1:0;for(g=0;g<f;g++){e=b[g];var j=e&i|(e&63)<<1|h;h=(e&64)>>6;b[g]=j}h===1&&(b[f-1]|=i,c.writeInt8(1));a.writeBinary(c)}}function f(a,b){typeof b==="number"?a.writeVarInt(b):a.writeVarIntFromHexLong(b)}function j(a,b){a.writeVarInt(d("WABinary").numUtf8Bytes(b)),a.writeString(b)}function k(a,b){a.writeVarInt(b.byteLength),a.writeBuffer(b)}function l(a,b,c){a.writeWithVarIntLength(function(a,b){return o(a,b,c)},b)}var m=[void 0,c,f,c,f,e,e,function(a,b){a.writeVarInt(b?1:0)},c,function(a,b){typeof b==="number"?a.writeUint64(b,!0):a.writeHexLong(b,!0)},function(a,b){typeof b==="number"?a.writeInt64(b,!0):a.writeHexLong(b,!0)},function(a,b){a.writeFloat64(b,!0)},j,k,l,function(a,b){a.writeUint32(b,!0)},function(a,b){a.writeInt32(b,!0)},function(a,b){a.writeFloat32(b,!0)}];f=function(a){if(a==null)return void 0;var b=a;function c(a,c){for(var d=0;d<c.length;d++)b(a,c[d])}return function(a,b){a.writeWithVarIntLength(c,b)}};var n=m.map(f);function o(a,b,c){var e=d("WAProtoCompile").compileSpec(c),f=e.names,g=e.fields,i=e.types;e=e.meta;c=c.internalDefaults;for(var j=0;j<f.length;j++){var k=f[j],l=b[k];l==null&&c&&(l=c[k]);if(l!=null){h=k;k=g[j];var o=i[j],p=o&d("WAProtoConst").TYPE_MASK,q=e[j];k=k*8|d("WAProtoUtils").typeToEncType(o);if(o&d("WAProtoConst").FLAGS.PACKED){if(l.length>0){a.writeVarInt(k);var r=n[p];r(a,l,q)}}else if(o&d("WAProtoConst").FLAGS.REPEATED)for(r=0;r<l.length;r++){a.writeVarInt(k);o=m[p];o(a,l[r],q)}else{a.writeVarInt(k);o=m[p];o(a,l,q)}}}}g.encodeProtobuf=a;g.encodeErrorInfo=b}),98);
__d("MAWDbObjEncode",["MAWArmadilloAppDataTableSchema.pb","MAWArmadilloAppMetaTableSchema.pb","MAWArmadilloCollectionVersionsTableSchema.pb","MAWArmadilloContactsTableSchema.pb","MAWArmadilloDeviceChangeAlertsTableSchema.pb","MAWArmadilloDyiBatchTableSchema.pb","MAWArmadilloEditMsgHistoryTableSchema.pb","MAWArmadilloGroupInfoTableSchema.pb","MAWArmadilloGroupInvitesTableSchema.pb","MAWArmadilloMediaTablesSchema.pb","MAWArmadilloMessagesTableSchema.pb","MAWArmadilloMetaRowTableSchema.pb","MAWArmadilloMissingKeysTableSchema.pb","MAWArmadilloParticipantsTableSchema.pb","MAWArmadilloPendingMutationsTableSchema.pb","MAWArmadilloPersonalSenderKeyStatusTableSchema.pb","MAWArmadilloReactionsTableSchema.pb","MAWArmadilloReceiptTablesSchema.pb","MAWArmadilloRetroactiveBackupsStateTableSchema.pb","MAWArmadilloSignalTablesSchema.pb","MAWArmadilloSyncActionsTableSchema.pb","MAWArmadilloSyncKeysTableSchema.pb","MAWArmadilloTasksTableSchema.pb","MAWArmadilloThreadsTableSchema.pb","MAWArmadilloUnrenderedMessagesTableSchema.pb","MAWArmadilloXMATableSchema.pb","MAWMsgType","MAWXMACTAUtil","WAServerSync.pb","WASyncdConst","WASyncdKeyTypes","encodeProtobuf","err"],(function(a,b,c,d,e,f,g){"use strict";var h={appData:B,appMeta:C,browserEncryptionMeta:b,chunk:D,collectionVersions:P,contacts:w,deviceChangeAlerts:a,dualSendMedia:b,dyiBatch:H,editMsgHistory:S,existingUsers:b,ftsBackloggedMessages:b,ftsEncryptionMeta:b,ftsIndexV3:b,groupInfo:j,groupInvites:y,historySyncQRCodeData:b,historySyncQRCodeSecretKey:b,identity:l,isDualSend:b,jobs:b,media:F,mediaBackup:E,messages:f,meta:k,missingKeys:L,participants:x,pendingMutations:N,pendingReceipts:u,pendingStanzas:b,personalSenderKeyStatuses:A,prekey:m,prekeyGeneration:n,reactions:G,receipts:t,retroactiveBackupsState:I,senderKeySessions:q,session:o,signedPrekey:p,stanzaQueue:b,syncActions:J,syncKeys:Q,tasks:z,threads:v,unrenderedMessages:i,uploadRetryStatus:b,xma:R};function a(a){a={action:a.action,deviceJid:a.deviceJid,identity:a.identity,isArchived:a.isArchived,latitude:a.latitude,location:a.location,loggedOut:a.loggedOut,longitude:a.longitude,model:a.model,platform:a.platform,ts:a.ts};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloDeviceChangeAlertsTableSchema.pb").DeviceChangeAlertsTableSchemaProtoSpec,a).readByteArray()}}function b(a){throw c("err")("unexpected table for encryption")}function e(a,b){if(Object.prototype.hasOwnProperty.call(h,b))b=h[b](a);else throw c("err")("not a valid table name");return b}function f(a){a.altIndex;a.externalId;a.messageDeleteTs;a.messageExpirationTs;a.msgId;a.quoteExternalId;a.revokedExternalId;a.rowId;a.sortOrderMs;a.thread;a.threadJid;a.unsendMsgContentDeleteTs;a=babelHelpers.objectWithoutPropertiesLoose(a,["altIndex","externalId","messageDeleteTs","messageExpirationTs","msgId","quoteExternalId","revokedExternalId","rowId","sortOrderMs","thread","threadJid","unsendMsgContentDeleteTs"]);a=a;var b;if(a.quote==null)b=a.quote;else{var c;c={author:a.quote.content.author,externalId:(c=a.quote)==null?void 0:c.content.externalId,mediaId:a.quote.content.mediaId,msgContent:a.quote.content.msgContent,msgId:a.quote.content.msgId,sourceId:a.quote.content.sourceId,specialTextSize:a.quote.content.specialTextSize,ts:a.quote.content.ts,type:a.quote.content.type,xmaMessageType:a.quote.content.xmaMessageType};c={content:c,remoteJid:a.quote.remoteJid};b=c}c=a.msgContent;a.type===d("MAWMsgType").MSG_TYPE.FUTUREPROOF&&(c={protobuf:a.msgContent.protobuf,subtype:a.msgContent.subtype});var e=a.ravenEphemeralType,f=a.ravenEphemeralMediaState;e=e!=null?e:null;f=f!=null?f:null;c={ack:a.ack,author:a.author,editCount:a.editCount,ephemeralCounterStarted:a.ephemeralCounterStarted,ephemeralMsgDisappeared:a.ephemeralMsgDisappeared,ephemeralSetting:a.ephemeralSetting,forwardingScore:a.forwardingScore,isExpiredXmaMsg:a.isExpiredXmaMsg,isForwarded:a.isForwarded,mediaId:a.mediaId,msgContent:c,originalTs:a.originalTs,quote:b,ravenEphemeralMediaState:f,ravenEphemeralType:e,reportingMeta:a.reportingMeta,resendCount:a.resendCount,serverTs:a.serverTs,specialTextSize:a.specialTextSize,ts:a.ts,type:a.type,xmaMessageType:a.xmaMessageType};return{encodedFields:c,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloMessagesTableSchema.pb").MessagesTableSchemaProtoSpec,c).readByteArray()}}function i(a){var b;if(a.quote==null)b=a.quote;else{var c;c={author:a.quote.content.author,externalId:(c=a.quote)==null?void 0:c.content.externalId,mediaId:a.quote.content.mediaId,msgContent:a.quote.content.msgContent,msgId:a.quote.content.msgId,sourceId:a.quote.content.sourceId,ts:a.quote.content.ts,type:a.quote.content.type,xmaMessageType:a.quote.content.xmaMessageType};c={content:c,remoteJid:a.quote.remoteJid};b=c}c={ack:a.ack,author:a.author,ephemeralSetting:a.ephemeralSetting,groupName:a.groupName,invitedParticipantUserJid:a.invitedParticipantUserJid,mediaId:a.mediaId,msgContent:a.msgContent,quote:b,reportingMeta:a.reportingMeta,resendCount:a.resendCount,ts:a.ts,type:a.type,xmaMessageType:a.xmaMessageType};return{encodedFields:c,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloUnrenderedMessagesTableSchema.pb").UnrenderedMessagesTableSchemaProtoSpec,c).readByteArray()}}function j(a){a={creationTs:a.creationTs,creator:a.creator,inviter:a.inviter,msgExpiration:a.msgExpiration,name:a.name,nameOwner:a.nameOwner,nameTs:a.nameTs,participantVersion:a.participantVersion};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloGroupInfoTableSchema.pb").GroupInfoSchemaProtoSpec,a).readByteArray()}}function k(a){var b=a.value.cat==null?a.value.cat:{encryptedSerializedCat:a.value.cat.encrypted_serialized_cat,expirationTimeInSeconds:a.value.cat.expiration_time_in_seconds};b={value:{abProps:a.value.abProps,authKeyPair:a.value.authKeyPair,cat:b,certificateChain:a.value.certificateChain,clockSkew:a.value.clockSkew,deviceId:a.value.deviceId,deviceUUID:a.value.deviceUUID,edgeInfo:a.value.edgeInfo,fbid:a.value.fbid,identityKeyPair:a.value.identityKeyPair,lastPrekeyGenerationId:a.value.lastPrekeyGenerationId,lastPrekeyId:a.value.lastPrekeyId,lastSessionDeviceWasLinkedTo:a.value.lastSessionDeviceWasLinkedTo,lastSignedPrekeyId:a.value.lastSignedPrekeyId,regId:a.value.regId,registrationVersion:a.value.registrationVersion}};return{encodedFields:b,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloMetaRowTableSchema.pb").MetaRowTableSchemaProtoSpec,b).readByteArray()}}function l(a){a={deviceName:a.deviceName,firstSeenTs:a.firstSeenTs,identity:a.identity,platform:a.platform};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloSignalTablesSchema.pb").IdentityTableSchemaProtoSpec,a).readByteArray()}}function m(a){a={encoded:a.encoded,isDeleted:a.isDeleted};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloSignalTablesSchema.pb").PrekeyTableSchemaProtoSpec,a).readByteArray()}}function n(a){a={createdTs:a.createdTs,endingId:a.endingId,startingId:a.startingId};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloSignalTablesSchema.pb").PrekeyGenerationTableSchemaProtoSpec,a).readByteArray()}}function o(a){a={session:a.session};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloSignalTablesSchema.pb").SessionTableSchemaProtoSpec,a).readByteArray()}}function p(a){a={encoded:a.encoded};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloSignalTablesSchema.pb").SignedPrekeyTableSchemaProtoSpec,a).readByteArray()}}function q(a){a={deviceId:a.deviceId,record:a.record};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloSignalTablesSchema.pb").SenderKeySessionsTableSchemaProtoSpec,a).readByteArray()}}function r(a){if(a==null)return a;else return Array.from(a,function(a){var b=a[0];a=a[1];return{baseKey:a.baseKey,deviceJid:b,serializedPubKey:a.pubKey}})}function s(a){if(a==null)return null;else return Array.from(a,function(a){var b=a[0];a=a[1];return{count:a,deviceJid:b}})}function t(a){var b=Array.from(a.statusTsPerUser,function(a){var b=a[0];a=a[1];return{dbUserStatusTs:a,userJid:b}}),c=Array.from(a.recipientDevices);c={permittedIdentitiesPerDevice:r(a.permittedIdentitiesPerDevice),recipientDevices:c,retryCountsPerDevice:s(a.retryCountsPerDevice),statusTsPerUser:b};return{encodedFields:c,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloReceiptTablesSchema.pb").ReceiptsTableSchemaProtoSpec,c).readByteArray()}}function u(a){a={author:a.author,deliveryReceipts:a.deliveryReceipts,externalId:a.externalId,readReceipts:a.readReceipts,thread:a.thread};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloReceiptTablesSchema.pb").PendingReceiptsTableSchemaProtoSpec,a).readByteArray()}}function v(a){a={archived:a.archived,cannotReplyReason:a.cannotReplyReason,folder:a.folder,isMigratedLocally:a.isMigratedLocally,lastReadMsg:a.lastReadMsg,lastReadMsgReceiptSent:a.lastReadMsgReceiptSent,lastReadMsgTs:a.lastReadMsgTs,muteCallsExpireTimeMs:a.muteCallsExpireTimeMs,muteExpireTimeMs:a.muteExpireTimeMs,newestMsg:a.newestMsg,newestMsgTs:a.newestMsgTs,nextInChatMsgId:a.nextInChatMsgId,oldestMsg:a.oldestMsg,optimisticThreadKey:a.optimisticThreadKey,snippetMsg:a.snippetMsg};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloThreadsTableSchema.pb").ThreadsTableSchemaProtoSpec,a).readByteArray()}}function w(a){a={dhash:a.dhash,ephemeralSetting:a.ephemeralSetting,ephemeralSyncResponseBackoffInfo:a.ephemeralSyncResponseBackoffInfo,icdcFails:a.icdcFails,icdcInfo:a.icdcInfo,isBlocked:a.isBlocked,isRestricted:a.isRestricted,lastSyncTs:a.lastSyncTs,nameForSearch:a.nameForSearch,relationship:a.relationship};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloContactsTableSchema.pb").ContactsTableSchemaProtoSpec,a).readByteArray()}}function x(a){a={addressable:a.addressable,deliveredWatermarkTs:a.deliveredWatermarkTs,lastReadActionTs:a.lastReadActionTs,lastReadWatermarkTs:a.lastReadWatermarkTs,nickname:a.nickname,type:a.type};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloParticipantsTableSchema.pb").ParticipantsTableSchemaProtoSpec,a).readByteArray()}}function y(a){a={caption:a.caption,inviteCode:a.inviteCode,inviteExpirationTs:a.inviteExpirationTs};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloGroupInvitesTableSchema.pb").GroupInvitesTableSchemaProtoSpec,a).readByteArray()}}function z(a){a={scheduledTime:a.scheduledTime};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloTasksTableSchema.pb").TasksTableSchemaProtoSpec,a).readByteArray()}}function A(a){var b=Array.from(a.hasSenderKey);b={hasSenderKey:b,rotateSenderKey:a.rotateSenderKey,senderKeyId:a.senderKeyId,senderKeyTs:a.senderKeyTs};return{encodedFields:b,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloPersonalSenderKeyStatusTableSchema.pb").PersonalSenderKeyStatusTableSchemaProtoSpec,b).readByteArray()}}function B(a){var b;switch(a.contents.type){case"meta_sync":var e=[];for(var f=a.contents.actions,g=Array.isArray(f),h=0,f=g?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var i;if(g){if(h>=f.length)break;i=f[h++]}else{h=f.next();if(h.done)break;i=h.value}i=i;i.chatAction?e.push({chatAction:i.chatAction}):i.messageAction&&e.push({messageAction:i.messageAction})}b={actions:e,type:"meta_sync"};break;case"backups_secrets":b={encryptedBackupsSecrets:a.contents.encryptedBackupsSecrets,type:"backups_secrets"};break;case"sync_key_share":b={syncKeyShare:{keys:a.contents.syncKeyShare.keys,orphanKeys:(i=a.contents.syncKeyShare)==null?void 0:(h=i.orphanKeys)==null?void 0:h.map(d("WASyncdKeyTypes").fromSyncKeyId)},type:"sync_key_share"};break;case"sync_key_request":b={syncKeyRequest:{keyIds:a.contents.syncKeyRequest.keyIds.map(d("WASyncdKeyTypes").fromSyncKeyId)},type:"sync_key_request"};break;default:a.contents.type;throw c("err")("Unknown appdata type: "+a.contents.type)}g={ack:a.ack,contents:b,permittedIdentitiesPerDevice:r(a.permittedIdentitiesPerDevice),recipientDevices:Array.from(a.recipientDevices),sendPartial:a.sendPartial,ts:a.ts};return{encodedFields:g,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloAppDataTableSchema.pb").AppDataTableSchemaProtoSpec,g).readByteArray()}}function C(a){a={value:a.value};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloAppMetaTableSchema.pb").AppMetaTableSchemaProtoSpec,a).readByteArray()}}function D(a){a={blobData:a.blobData,mimetype:a.mimetype,plaintextHash:a.plaintextHash};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloMediaTablesSchema.pb").ChunkTableSchemaProtoSpec,a).readByteArray()}}function E(a){a={fbid:a.fbid};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloMediaTablesSchema.pb").MediaBackupSchemaProtoSpec,a).readByteArray()}}function F(a){var b=Array.from(a.mediaEntries,function(a){var b=a[0];a=a[1];return{mediaEntryData:a,msgId:b}});b={mediaEntries:b,mediaType:a.mediaType,plaintextHash:a.plaintextHash,size:a.size,ts:a.ts,validatedAudioInfo:a.validatedAudioInfo,validatedDocumentFileInfo:a.validatedDocumentFileInfo,validatedImageInfo:a.validatedImageInfo,validatedVideoInfo:a.validatedVideoInfo};return{encodedFields:b,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloMediaTablesSchema.pb").MediaTableSchemaProtoSpec,b).readByteArray()}}function G(a){a={ack:a.ack,author:a.author,groupingKey:a.groupingKey,reaction:a.reaction,reactToAuthor:a.reactToAuthor,ts:a.ts};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloReactionsTableSchema.pb").ReactionsTableSchemaProtoSpec,a).readByteArray()}}function H(a){a={isThread:a.isThread,numMessages:a.numMessages,numMessagesRestored:a.numMessagesRestored,numThreadsRestored:a.numThreadsRestored,oldestTs:a.oldestTs,qplFlowDescriptor:a.qplFlowDescriptor,qplInstanceKeyE2E:a.qplInstanceKeyE2E,qplInstanceKeyForThread:a.qplInstanceKeyForThread,threadId:a.threadId};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloDyiBatchTableSchema.pb").DyiBatchTableSchemaProtoSpec,a).readByteArray()}}function I(a){a={msgId:a.msgId};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloRetroactiveBackupsStateTableSchema.pb").RetroactiveBackupsStateTableSchemaProtoSpec,a).readByteArray()}}function J(a){a={binarySyncData:a.binarySyncData,keyId:d("WASyncdKeyTypes").fromSyncKeyId(a.keyId),timestamp:a.timestamp,valueMac:a.valueMac,version:a.version};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloSyncActionsTableSchema.pb").SyncActionsTableSchemaProtoSpec,a).readByteArray()}}function K(a){return Array.from(a,function(a){var b=a[0];a=a[1];return{deviceId:b,deviceResponse:a}})}function L(a){a={deviceResponses:K(a.deviceResponses),keyId:d("WASyncdKeyTypes").fromSyncKeyId(a.keyId),timestamp:a.timestamp};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloMissingKeysTableSchema.pb").MissingKeysTableSchemaProtoSpec,a).readByteArray()}}function M(a){switch(a){case d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET:return d("MAWArmadilloPendingMutationsTableSchema.pb").SYNCD_MUTATION_SYNCD_OPERATION.SET;case d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE:return d("MAWArmadilloPendingMutationsTableSchema.pb").SYNCD_MUTATION_SYNCD_OPERATION.REMOVE}}function N(a){a={binarySyncAction:a.binarySyncAction,operation:M(a.operation),timestamp:a.timestamp,version:a.version};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloPendingMutationsTableSchema.pb").PendingMutationsTableSchemaProtoSpec,a).readByteArray()}}function O(a){switch(a){case d("WASyncdConst").CollectionSyncState.UpToDate:return"UpToDate";case d("WASyncdConst").CollectionSyncState.Dirty:return"Dirty";case d("WASyncdConst").CollectionSyncState.FailingFiniteRetry:return"FailingFiniteRetry";case d("WASyncdConst").CollectionSyncState.Fatal:return"Fatal";case d("WASyncdConst").CollectionSyncState.Blocked:return"Blocked"}}function P(a){a={finiteFailureStartTime:a.finiteFailureStartTime,isCollectionInMacMismatchFatal:a.isCollectionInMacMismatchFatal,ltHash:a.ltHash,state:O(a.state),version:a.version};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloCollectionVersionsTableSchema.pb").CollectionVersionsTableSchemaProtoSpec,a).readByteArray()}}function Q(a){a={fingerprint:a.fingerprint,keyData:d("WASyncdKeyTypes").fromSyncKeyData(a.keyData),timestamp:a.timestamp};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloSyncKeysTableSchema.pb").SyncKeysTableSchemaProtoSpec,a).readByteArray()}}function R(a){var b=a.ctas==null?[]:a.ctas.map(function(a){return d("MAWXMACTAUtil").toMAWCTAEncode(a)});b={author:a.author,ctas:b,defaultCTA:a.defaultCTA==null?a.defaultCTA:d("MAWXMACTAUtil").toMAWCTAEncode(a.defaultCTA),headerTitle:a.headerTitle,isTombstoned:a.isTombstoned,maxSubtitleNumOfLines:a.maxSubtitleNumOfLines,maxTitleNumOfLines:a.maxTitleNumOfLines,msgId:a.msgId,overlayDescription:a.overlayDescription,overlayIconGlyph:a.overlayIconGlyph,overlayTitle:a.overlayTitle,previewMediaIds:a.previewMediaIds,subtitleText:a.subtitleText,targetId:a.targetId,targetType:a.targetType,targetUsername:a.targetUsername,threadJid:a.threadJid,titleText:a.titleText,xmaLayoutType:a.xmaLayoutType};return{encodedFields:b,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloXMATableSchema.pb").XMATableSchemaProtoSpec,b).readByteArray()}}function S(a){a={author:a.author,editTs:a.editTs,msgContent:a.msgContent,specialTextSize:a.specialTextSize};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloEditMsgHistoryTableSchema.pb").EditMsgHistoryTableSchemaProtoSpec,a).readByteArray()}}g.encodeDbObj=e}),98);
__d("MAWDbObjEncryption",["MAWCryptoConsts","MAWDbObjDecode","MAWDbObjEncode","MAWGating","MAWIndexedDb","MAWKeychainCrypto","MAWKeychainNaClCrypto","MAWKeychainUtil","MAWQplProxy","err","gkx","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h=1/1e3,i="_encryptedContent";function a(a,b,e){if(!(d("MAWGating").isEncryptionAtRestEnabled()||c("gkx")("9017")===!0)||!d("MAWIndexedDb").TABLES_TO_ENCRYPT.includes(b))return a;var f=Math.random()<h;f=f?d("MAWQplProxy").startQplUserFlow(c("qpl")._(25300256,"115")):null;try{var g=babelHelpers["extends"]({},a);e=e();var j=e.key;e=e.version;e=d("MAWKeychainUtil").makeAAD(e,d("MAWCryptoConsts").CIPHER_ID);var k=d("MAWDbObjEncode").encodeDbObj(a,b),l=k.encodedFields;k=k.proto;Object.keys(l).forEach(function(b){Object.prototype.hasOwnProperty.call(a,b)&&delete g[b]});l=d("MAWKeychainNaClCrypto").encrypt(j,k,e);g[i]=l;f==null?void 0:f.endSuccess();return g}catch(a){f==null?void 0:f.endFail("ear_encrypt_fail");throw c("err")(a.message+" - Encrypted dexie was unable to encrypt an entity for table "+b)}}function b(a,b,e){if(!d("MAWIndexedDb").TABLES_TO_ENCRYPT.includes(b)||!Object.prototype.hasOwnProperty.call(a,i))return a;var f=Math.random()<h;f=f?d("MAWQplProxy").startQplUserFlow(c("qpl")._(25313004,"118")):null;try{var g=a[i];a=babelHelpers["extends"]({},a);var j=d("MAWKeychainCrypto").getKeyVersionFromCipherDataString(g);e=e(j);e=e.key;var k={};e=d("MAWKeychainNaClCrypto").decrypt(e,g,j);var l=d("MAWDbObjDecode").decodeDbObj(e,b);Object.keys(l).forEach(function(a){k[a]=l[a]});delete a[i];g=babelHelpers["extends"]({},a,k);f==null?void 0:f.endSuccess();return g}catch(a){f==null?void 0:f.endFail("ear_decrypt_fail");a instanceof d("MAWKeychainNaClCrypto").EARDecryptionError&&d("MAWGating").isDbCleanupEnabled()&&d("MAWIndexedDb").deleteDb();throw c("err")(a.message+" - Encrypted dexie was unable to decrypt an entity for table "+b)}}g.ENCRYPTED_COLUMN_NAME=i;g.encryptDbObj=a;g.decryptDbObj=b}),98);
__d("MAWDbAppMeta",[],(function(a,b,c,d,e,f){"use strict";a={allowSecurityAlert:"allowSecurityAlert",allowSecurityAlertForSelf:"allowSecurityAlertForSelf",hmacKey:"hmacKey",hotlikeSticker:"hotlikeSticker",isBackfilledForOccamadillo:"isBackfilledForOccamadillo",msgTypeVersion:"msgTypeVersion"};f.AppMetaKeysEnum=a}),66);
__d("MAWDbMsgTypeVersionTxns",["MAWDbAppMeta","MAWDexieTable"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a.appMeta.get({key:d("MAWDbAppMeta").AppMetaKeysEnum.msgTypeVersion}).then(function(a){return a==null?void 0:a.value.msgTypeVersion})}function b(a,b){return a.appMeta.add({key:d("MAWDbAppMeta").AppMetaKeysEnum.msgTypeVersion,value:{msgTypeVersion:b}})}function c(a,b){return a.appMeta.put({key:d("MAWDbAppMeta").AppMetaKeysEnum.msgTypeVersion,value:{msgTypeVersion:b}})}function e(a,b){return a.appMeta.add({key:d("MAWDbAppMeta").AppMetaKeysEnum.hmacKey,value:{hmacKey:b}})}function f(a){return a.appMeta.get({key:d("MAWDbAppMeta").AppMetaKeysEnum.hmacKey}).then(function(a){return a==null?void 0:a.value.hmacKey})}function h(a,b){return a.appMeta.get({key:b})}function i(a,b){return a.appMeta.put({key:d("MAWDbAppMeta").AppMetaKeysEnum.allowSecurityAlert,value:{allowSecurityAlert:b}}).then(function(){})}function j(a,b){return a.appMeta.put({key:d("MAWDbAppMeta").AppMetaKeysEnum.allowSecurityAlertForSelf,value:{allowSecurityAlertForSelf:b}}).then(function(){})}function k(a){return h(a,d("MAWDbAppMeta").AppMetaKeysEnum.allowSecurityAlert).then(function(a){return(a=a==null?void 0:a.value.allowSecurityAlert)!=null?a:!1})}function l(a){return h(a,d("MAWDbAppMeta").AppMetaKeysEnum.allowSecurityAlertForSelf).then(function(a){return(a=a==null?void 0:a.value.allowSecurityAlertForSelf)!=null?a:!0})}function m(a,b){return a.appMeta.add({key:d("MAWDbAppMeta").AppMetaKeysEnum.hotlikeSticker,value:{hotlikeSticker:b}})}function n(a){return d("MAWDexieTable").dexieAll([l(a),k(a)]).then(function(a){var b=a[0];a=a[1];return{allowSecurityAlertForContact:a,allowSecurityAlertForSelf:b}})}g.MSG_TYPE_VERSION=d("MAWDbAppMeta").AppMetaKeysEnum.msgTypeVersion;g.ALLOW_SECURITY_ALERT_FOR_CONTACT=d("MAWDbAppMeta").AppMetaKeysEnum.allowSecurityAlert;g.ALLOW_SECURITY_ALERT_FOR_SELF=d("MAWDbAppMeta").AppMetaKeysEnum.allowSecurityAlertForSelf;g.HOT_LIKE=d("MAWDbAppMeta").AppMetaKeysEnum.hotlikeSticker;g.getMsgTypeVersion=a;g.addMsgTypeVersion=b;g.updateMsgTypeVersion=c;g.addHMACKey=e;g.getHMACKey=f;g.getAppMetaValue=h;g.updateSecurityAlertValueForContact=i;g.updateSecurityAlertValueForSelf=j;g.getSecuritySettingForContact=k;g.getSecuritySettingForSelf=l;g.addHotLike=m;g.maybeBulkGetSecuritySetting=n}),98);
__d("MAWHMACKey",["MAWCryptoConsts","MAWDbMsgTypeVersionTxns","MAWIndexedDb","MAWKeychainUtil","MAWSubtleCrypto","MAWTransactionMode","WABase64","tweetnacl-auth"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=d("MAWKeychainUtil").getBufferWithRandomValuesFromLength(d("MAWCryptoConsts").HKDF_SEED_LENGTH_IN_BYTES);return i(a).then(function(a){return d("MAWSubtleCrypto").MAWSubtleCrypto.exportKey("raw",a)})}function a(a,b){a=new TextEncoder().encode(a);b=new Uint8Array(b);a=c("tweetnacl-auth")(a,b);return d("WABase64").encodeB64UrlSafe(a)}function b(){return h().then(function(a){return d("MAWIndexedDb").makeMsgrTransactor({appMeta:d("MAWTransactionMode").READWRITE})(function(b){return d("MAWDbMsgTypeVersionTxns").getHMACKey(b).then(function(c){return c!=null?c:d("MAWDbMsgTypeVersionTxns").addHMACKey(b,a)}).then(function(){return a})})()})}function i(a){return d("MAWSubtleCrypto").MAWSubtleCrypto.importKey("raw",a,{hash:"SHA-256",name:"HMAC"},!0,["sign"])}g.genHMACKey=h;g.hmacTweetNaCl=a;g.generateAndInsertHMACKey=b}),98);
__d("MAWAudioUtils",["Promise","err"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var d=URL.createObjectURL(a);return new(b("Promise"))(function(a,b){var e=new Audio();e.setAttribute("crossOrigin","anonymous");e.addEventListener("loadedmetadata",function(c){c=c.currentTarget;if(c instanceof HTMLAudioElement){c=c.duration;a(Math.ceil(c))}else b("EventTarget returned for event should be HTMLAudioElement")});e.src=d;e.onabort=function(){b(function(){throw c("err")("Error loading audio from provided URL")})};e.onerror=function(){b(function(){throw c("err")("Wrong blob type")})}})}g.getAudioDurationInSeconds=a}),98);
__d("WALongInt",["WAHex","WALogger"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(['"','" is over 64 bits']);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(['"','" is not a valid decimal string']);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([""," is not a safe integer"]);j=function(){return a};return a}function k(a){if(typeof a!=="number"){d("WALogger").LOG(j(),a).color("red");throw new Error("numberOrThrowIfTooLarge is given a non-safe integer")}return a}e=function(a){return a==null?a:k(a)};function a(a,b){if(typeof a==="number"&&typeof b==="number")return a>b;a=typeof a==="number"?d("WAHex").hexLongFromNumber(a):a;b=typeof b==="number"?d("WAHex").hexLongFromNumber(b):b;return d("WAHex").isBiggerHexLong(a,b)}function b(a){if(typeof a==="number")return a.toString(10);var b=d("WAHex").hexLongToHex(a),c=[0],e=0;for(var f=0;f<b.length;f++){e=d("WAHex").hexAt(b,f);for(var g=0;g<c.length;g++)c[g]=c[g]*16+e,e=c[g]/10|0,c[g]%=10;while(e>0)c.push(e%10),e=e/10|0}g=c.reverse().join("");return d("WAHex").hexLongIsNegative(a)?"-"+g:g}function c(a){if(!/^-?\d+$/.test(a)){d("WALogger").LOG(i(),a).color("red");throw new Error("decimalStringToLongInt is given an invalid decimal string")}var b=a[0]==="-",c=a.replace(/^-?0*/,""),e=c.length;if(e<16||e===16&&c<="9007199254740991")return b?-Number(c):Number(c);if(e>20||e===20&&c>"18446744073709551615"||b&&(e>19||e===19&&c>"9223372036854775807")){d("WALogger").LOG(h(),a).color("red");throw new Error("decimalStringToHexLong is given value over 64 bits")}a=0;var f=0;for(var g=0;g<e;g++)a=a*10+Number(c[g]),f=f*10+Math.floor(a/4294967296),a=a%4294967296;return d("WAHex").createHexLongFrom32Bits(f,a,b)}g.numberOrThrowIfTooLarge=k;g.maybeNumberOrThrowIfTooLarge=e;g.isBiggerLongInt=a;g.longIntToDecimalString=b;g.decimalStringToLongInt=c}),98);
__d("WAConcurrentIterate",["Promise","regeneratorRuntime"],(function(a,b,c,d,e,f){function a(a,c,d){var e=[],f=[],g=0,h=function(){var d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:if(!(g<a)){e.next=8;break}d=g;g++;e.next=5;return b("regeneratorRuntime").awrap(c(d));case 5:f[d]=e.sent;e.next=0;break;case 8:case"end":return e.stop()}},null,this)};d=Math.min(a,d);for(var i=0;i<d;i++)e.push(h());return b("Promise").all(e).then(function(){return f})}f.concurrentIterate=a}),66);
__d("WATypedArraysCast",["WABase64"],(function(a,b,c,d,e,f,g){function a(a,b){if(b instanceof a)return b;return typeof b==="string"?new a(d("WABase64").decodeB64(b)):new a(b)}g.castTypedArrays=a}),98);
__d("WACryptoHmac",["WATypedArraysCast"],(function(a,b,c,d,e,f,g){var h=32,i=new Uint8Array(h),j={name:"HMAC",hash:"SHA-256"},k={name:"HMAC",hash:"SHA-512"},l={name:"HMAC",hash:"SHA-1"};function m(a,b){b=d("WATypedArraysCast").castTypedArrays(Uint8Array,b);return self.crypto.subtle.importKey("raw",b,a,!1,["sign"]).then(function(b){return{key:b,algo:a}})}function a(a){return m(j,a)}function n(a,b,c){var d=a.key;a=a.algo;return self.crypto.subtle.sign(a,d,b).then(function(a){return c!=null&&c!==0?a.slice(0,c):a})}function b(a,b){return m(j,a!=null?a:i).then(function(a){return n(a,b)})}function c(a,b,c){return m(j,a).then(function(a){return n(a,b,c)})}function e(a,b,c){return m(k,a).then(function(a){return n(a,b,c)})}function f(a,b,c){return m(l,a).then(function(a){return n(a,b,c)})}g.SHA256_BYTE_LENGTH=h;g.DEFAULT_SALT=i;g.encodeKeySha256=a;g.sign=n;g.extractSha256=b;g.hmacSha256=c;g.hmacSha512=e;g.hmacSha1=f}),98);
__d("WAMediaCryptoSidecar",["WAConcurrentIterate","WACryptoHmac"],(function(a,b,c,d,e,f,g){function a(a){return a==="video"}function b(a){return a}var h=16,i=10,j=64*1024;function c(a,b,c){c===void 0&&(c=1);var e=b.buffer.byteLength;e=Math.ceil((e-h)/j);var f=new Uint8Array(i*e);return d("WAConcurrentIterate").concurrentIterate(e,function(c){var e=c*j,g=e+h+j;e=b.subarray(e,g);return d("WACryptoHmac").sign(a,e).then(function(a){a=new Uint8Array(a,0,i);f.set(a,c*i)})},c).then(function(){return f.buffer})}g.shouldHaveStreamingSidecar=a;g.castToStreamingSidecar=b;g.calculateStreamingSidecar=c}),98);
__d("WAMediaEntryData.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};a.internalSpec={fileSha256:[1,d("WAProtoConst").TYPES.BYTES],mediaKey:[2,d("WAProtoConst").TYPES.BYTES],fileEncSha256:[3,d("WAProtoConst").TYPES.BYTES],directPath:[4,d("WAProtoConst").TYPES.STRING],mediaKeyTimestamp:[5,d("WAProtoConst").TYPES.INT64],serverMediaType:[6,d("WAProtoConst").TYPES.STRING],uploadToken:[7,d("WAProtoConst").TYPES.BYTES],validatedTimestamp:[8,d("WAProtoConst").TYPES.BYTES],sidecar:[9,d("WAProtoConst").TYPES.BYTES],objectId:[10,d("WAProtoConst").TYPES.STRING],fbid:[11,d("WAProtoConst").TYPES.STRING],downloadableThumbnail:[12,d("WAProtoConst").TYPES.MESSAGE,b],handle:[13,d("WAProtoConst").TYPES.STRING],filename:[14,d("WAProtoConst").TYPES.STRING]};b.internalSpec={fileSha256:[1,d("WAProtoConst").TYPES.BYTES],fileEncSha256:[2,d("WAProtoConst").TYPES.BYTES],directPath:[3,d("WAProtoConst").TYPES.STRING],mediaKey:[4,d("WAProtoConst").TYPES.BYTES],mediaKeyTimestamp:[5,d("WAProtoConst").TYPES.INT64]};g.MediaEntrySpec=a;g.MediaEntry$DownloadableThumbnailSpec=b}),98);
__d("WAServerMediaType",["WAAssertUnreachable"],(function(a,b,c,d,e,f,g){d=["image","sticker","ptt","audio","document","video","gif","ppic","md-app-state","md-msg-hist","kyc-id","template","thumbnail-image","thumbnail-video","thumbnail-gif","thumbnail-document","thumbnail-link","payment-bg-image","novi-video","novi-image","product","product-catalog-image","xma-image","biz-cover-photo","preview","newsletter-audio","newsletter-document","newsletter-image","newsletter-gif","newsletter-ptt","newsletter-sticker","newsletter-thumbnail-link","newsletter-video"];function a(a){switch(a){case"image":case"sticker":case"ptt":case"audio":case"document":case"video":case"gif":case"ppic":case"md-app-state":case"md-msg-hist":case"kyc-id":case"thumbnail-image":case"thumbnail-video":case"thumbnail-gif":case"thumbnail-document":case"thumbnail-link":case"payment-bg-image":case"novi-video":case"novi-image":case"template":case"product":case"product-catalog-image":case"xma-image":case"biz-cover-photo":case"preview":case"newsletter-audio":case"newsletter-document":case"newsletter-image":case"newsletter-gif":case"newsletter-ptt":case"newsletter-sticker":case"newsletter-thumbnail-link":case"newsletter-video":return a;default:return null}}function b(a){switch(a){case"Image":return"image";case"Video":return"video";case"Ptt":return"ptt";case"Gif":return"gif";case"Sticker":return"sticker";case"DocumentFile":return"document";case"Text":case"Futureproof":case"Ciphertext":case"Unavailable":case"ExpiredEphemeral":case"Admin":case"Revoked":case"DeleteForMe":case"EphemeralSettingAdmin":case"EphemeralSyncResponse":case"EphemeralSettingChangeFromCurrentDevice":case"AlertICDC":case"GroupInvite":case"SenderKeyDistribution":case"Reaction":case"EditAction":return null;default:return c("WAAssertUnreachable")(a)}}g.SERVER_MEDIA=d;g.castToServerMediaType=a;g.getMediaType=b}),98);
__d("WAMediaUtils",["Promise","WABase64","WAErr","WALongInt","WAMediaCryptoSidecar","WAMediaEntryData.pb","WAServerMediaType","WATimeUtils","decodeProtobuf","encodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=new Uint8Array(32);self.crypto.getRandomValues(a);return a.buffer}function i(a){return a}function a(){return h()}function j(a){return a}function e(a){return d("WABase64").encodeB64UrlSafe(a)}function f(a){return a}function k(a){return a}function l(a){return a}function m(a){return a}function n(a,b){a=d("decodeProtobuf").decodeProtobuf(d("WAMediaEntryData.pb").MediaEntrySpec,b);b=a.fileSha256;var c=a.mediaKey,e=a.fileEncSha256,f=a.directPath,g=a.mediaKeyTimestamp,h=a.sidecar,i=a.objectId,j=a.fbid,k=a.serverMediaType,l=a.downloadableThumbnail;a=a.filename;return{fileSha256:b,mediaKey:c,fileEncSha256:e,directPath:f,mediaKeyTimestamp:g==null?null:d("WATimeUtils").castToUnixTime(d("WALongInt").numberOrThrowIfTooLarge(g)),sidecar:h&&d("WAMediaCryptoSidecar").castToStreamingSidecar(h),objectId:i,fbid:j,downloadableThumbnail:l&&v(l),serverMediaType:k,filename:a}}function o(a,b,c,e,f,g,h,i,j,k){a=d("encodeProtobuf").encodeProtobuf(d("WAMediaEntryData.pb").MediaEntrySpec,{fileSha256:a,fileEncSha256:b,mediaKey:c,directPath:e,mediaKeyTimestamp:f,serverMediaType:g,objectId:h,fbid:i,downloadableThumbnail:j,filename:k});return a.readByteArray()}function p(a){return d("encodeProtobuf").encodeProtobuf(d("WAMediaEntryData.pb").MediaEntrySpec,a).readByteArray()}function q(a){return d("encodeProtobuf").encodeProtobuf(d("WAMediaEntryData.pb").MediaEntrySpec,a).readByteArray()}function r(a,b){return d("encodeProtobuf").encodeProtobuf(d("WAMediaEntryData.pb").MediaEntrySpec,babelHelpers["extends"]({},a,{directPath:b})).readByteArray()}function s(a,b){return d("encodeProtobuf").encodeProtobuf(d("WAMediaEntryData.pb").MediaEntrySpec,babelHelpers["extends"]({},a,{downloadableThumbnail:babelHelpers["extends"]({},a.downloadableThumbnail,{directPath:b})})).readByteArray()}function t(a,b){a=babelHelpers["extends"]({},a,{fbid:b});return d("encodeProtobuf").encodeProtobuf(d("WAMediaEntryData.pb").MediaEntrySpec,a).readByteArray()}function u(a,b){a=babelHelpers["extends"]({},a,{objectId:b});return d("encodeProtobuf").encodeProtobuf(d("WAMediaEntryData.pb").MediaEntrySpec,a).readByteArray()}function v(a){return a==null?null:{directPath:a.directPath,fileEncSha256:a.fileEncSha256,fileSha256:a.fileSha256,mediaKey:a.mediaKey&&i(a.mediaKey),mediaKeyTimestamp:a.mediaKeyTimestamp==null?null:d("WATimeUtils").castToUnixTime(d("WALongInt").numberOrThrowIfTooLarge(a.mediaKeyTimestamp))}}function w(a){a=d("decodeProtobuf").decodeProtobuf(d("WAMediaEntryData.pb").MediaEntrySpec,a);var b=a.serverMediaType,c=a.mediaKey,e=a.mediaKeyTimestamp,f=a.uploadToken,g=a.downloadableThumbnail;a=babelHelpers.objectWithoutPropertiesLoose(a,["serverMediaType","mediaKey","mediaKeyTimestamp","uploadToken","downloadableThumbnail"]);return babelHelpers["extends"]({},a,{serverMediaType:b==null?null:d("WAServerMediaType").castToServerMediaType(b),mediaKey:c&&i(c),mediaKeyTimestamp:e==null?null:d("WATimeUtils").castToUnixTime(d("WALongInt").numberOrThrowIfTooLarge(e)),uploadToken:f&&j(f),downloadableThumbnail:g&&v(g)})}function x(a){return"arrayBuffer"in a&&typeof a.arrayBuffer==="function"?a.arrayBuffer():new(b("Promise"))(function(b,d){var e=new FileReader();e.onload=function(){var a=e.result;a instanceof ArrayBuffer?b(a):d(c("WAErr")("blobToArrayBuffer got error becaues result is not ArrayBuffer"))};e.onerror=function(){var a;a=((a=e.error)==null?void 0:a.name)||"unknown";d(c("WAErr")("blobToArrayBuffer got error got error "+a))};e.readAsArrayBuffer(a)})}function y(a){var b="image/jpeg";switch(a){case"image":b="image/jpeg";break;case"ptt":b="audio/wav";break;case"video":b="video/mp4";break;case"gif":b="image/gif";break;case"sticker":b="image/webp";break;case"preview":b="image/jpeg";break;case"document":b="application/pdf";break;default:throw c("WAErr")("Unsupported server media type: "+a)}return b}g.createMediaKey=h;g.castToMediaKey=i;g.createUploadToken=a;g.castToUploadToken=j;g.toPlaintextHash=e;g.stringToPlaintextHash=f;g.toHashedPlaintextHash=k;g.stringToDeliveryObjectId=l;g.stringToBackupEntFbid=m;g.mediaEntryDataToRawData=n;g.rawDataToMediaEntry=o;g.encodeMediaEntryForUpload=p;g.encodeMediaEntryForDownload=q;g.encodeMediaEntryWithUpdatedPath=r;g.encodeMediaEntryDownloadableThumbnailWithUpdatedPath=s;g.encodeMediaEntryWithUpdatedFbid=t;g.encodeMediaEntryWithUpdatedObjectId=u;g.convertMediaDownloadableThumbnailToDownloadableThumbnail=v;g.decodeMediaEntryData=w;g.blobToArrayBuffer=x;g.getMimeTypeFromServerMediaType=y}),98);
__d("MAWMediaUtils",["MAWDbMedia","MAWGlobals","MAWHMACKey","WAMediaUtils","WATimeUtils","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){b===void 0&&(b="media");switch(a){case d("MAWDbMedia").MEDIA_TYPE.IMAGE:return b==="xma-media"?"xma-image":"image";case d("MAWDbMedia").MEDIA_TYPE.VIDEO:return"video";case d("MAWDbMedia").MEDIA_TYPE.PTT:return"ptt";case d("MAWDbMedia").MEDIA_TYPE.GIF:return"gif";case d("MAWDbMedia").MEDIA_TYPE.STICKER:return"sticker";case d("MAWDbMedia").MEDIA_TYPE.DOCUMENT_FILE:return"document";default:throw c("err")("get a wrong media file with type "+a)}}function h(a){try{return d("WAMediaUtils").blobToArrayBuffer(a).then(i)}catch(a){throw c("err")("Got "+a+" when convert the blob to Uint8Array")}}function i(a){return self.crypto.subtle.digest("SHA-256",a).then(function(a){return new Uint8Array(a)})}function e(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield h(a));a=d("WAMediaUtils").toPlaintextHash(a);var b=k(a);return[a,b]});return j.apply(this,arguments)}function k(a){var b=d("MAWGlobals").getHMACKey();return d("WAMediaUtils").toHashedPlaintextHash(d("MAWHMACKey").hmacTweetNaCl(a,b))}function f(a){var b="preview-"+d("WATimeUtils").unixTime().toString()+".jpeg";return l(a,b,"image/jpeg")}function l(a,b,c){return new File([new Blob([new Uint8Array(a)],{type:c})],b,{type:c})}g.getServerMediaTypeFromMediaType=a;g.hashBlob=h;g.hashArrayBuffer=i;g.genBlobHashes=e;g.genHMACPlaintextHash=k;g.convertJpegThumbnailArrayBufferToFile=f}),98);
__d("MAWSendVideoToWorker",["MAWMediaWorkerResource","Promise","WALogger","WebWorker"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Clean up media worker"]);h=function(){return a};return a}var i=j();function a(a){var c;return new(b("Promise"))(function(b){c=i&&k(i)?j():i,c.setMessageHandler(function(a){b(a)}).execute(),c.postMessage(a)})["finally"](function(){c&&(d("WALogger").LOG(h()),c.terminate(),(!i||!i.isCurrentState("constructed"))&&(i=j()))})}function j(){return new(c("WebWorker"))(c("MAWMediaWorkerResource")).setAllowCrossPageTransition(!0)}function k(a){return a.isCurrentState("preparing")||a.isCurrentState("executing")}g.sendVideoMessageToWorker=a}),98);
__d("MAWVideoPreProcess",["MAWSendVideoToWorker","Promise","QPLUserFlow","WALogger","err","qpl"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["MediaAnalyzer:checkAndRepair got error! ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["MediaAnalyzer:checkAndRepair rejected file (",")"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["MediaAnalyzer:checkAndRepair got parsing error! ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["trouble parsing file "," (fossil ",") ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Video preprocess failure: ",""]);l=function(){return a};return a}function m(){c("QPLUserFlow").start(c("qpl")._(25309473,"9188"))}function n(a){c("QPLUserFlow").endFailure(c("qpl")._(25309473,"9188"),"failure_during_video_preprocess"),d("WALogger").ERROR(l(),a)}function o(){c("QPLUserFlow").endSuccess(c("qpl")._(25309473,"9188"))}function a(a,d){return p(a,d).then(function(d){if(!d)throw c("err")("invalid file");d=new File([d.file],a.name,{type:d.file.type});return b("Promise").resolve(d)})}function p(a,b){m();return d("MAWSendVideoToWorker").sendVideoMessageToWorker({asGif:b,file:a,type:"prep"}).then(function(b){var c=b.error,a=b.file,e=b.filename,f=b.result;b=b.type;switch(b){case"result":o();return f;case"parsingError":d("WALogger").ERROR(k(),a,e,String(c));a&&d("WALogger").ERROR(j(),String(c));d("WALogger").ERROR(i(),String(c));return void 0}})["catch"](function(a){d("WALogger").ERROR(h(),String(a));n(String(a));return void 0})}g.processRawVideo=a}),98);
__d("MAWVideoUtils",["MAWImageUtils","Promise","err","generateVideoThumbnails"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var e=document.body;if(!e)return new(b("Promise"))(function(a,b){return b("Unable to find DOM body, please use this util only in DOM environment.")});var f=document.createElement("video");return new(b("Promise"))(function(d,g){f.setAttribute("style","display: none"),f.setAttribute("src",URL.createObjectURL(a)),f.addEventListener("loadedmetadata",function(a){a=a.currentTarget;if(a instanceof HTMLVideoElement){var e=a.duration,h=a.videoHeight;a=a.videoWidth;var i=c("generateVideoThumbnails")(f,a,h,1);d(b("Promise").all([i,a,h,Math.ceil(e)]))}else g("EventTarget returned for event should be HTMLVideoElement")}),e.appendChild(f)}).then(function(a){var b=a[0],c=a[1],g=a[2],h=a[3];e.removeChild(f);return d("MAWImageUtils").canvasToBlob(b.thumbnails[0].getCanvas(),d("MAWImageUtils").TYPE_JPEG,!0).then(function(a){return a.arrayBuffer().then(function(a){return{duration:h,height:g,jpegThumbnail:a,width:c}})})})["catch"](function(a){e.removeChild(f);throw c("err")(a)})}g.getVideoThumbnailUrlAndSpec=a}),98);
__d("MWConsole",["gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(){}g.log=a}),98);
__d("LSThreadAttributionTypeUtil.bs",["I64","LSIntEnum","LSMessagingThreadAttributionType","LSThreadAttributionStore.bs"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){b=d("LSThreadAttributionStore.bs").getSource({_0:b,TAG:1},d("I64").to_string(a));if(b.TAG===0)return b._0;a=b._0;if(a==="communityFriendsDialog"||a==="pagesHomeFriendsDialog"||a==="mutualFriendsDialog"||a==="birthday"||a==="groupMembers"||a==="fundraiserSupportersList"||a==="memories"||a==="feedPoll"||a==="reactorList"||a==="friendsList"||a==="pagesPrivateReply")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").FB_FEED_ORGANIC_POST);else if(a==="inboxPendingRequests")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_INBOX_PENDING_REQUESTS);else if(a==="fullscreenChat")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_COMMUNITY_MESSAGING_FULLSCREEN_CHAT);else if(a==="sidebarGroupsList")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").SIDEBAR_CONTACTS_GROUPS);else if(a==="jewel")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").JEWEL_THREAD_LIST);else if(a==="shop")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").MINI_SHOP_VIEW_MENU_BUTTON);else if(a==="chatheadsOverflow")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").CHATHEADS_OVERFLOW);else if(a==="hovercard"||a==="feedDynamicHoverCard")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").FB_FEED_DYNAMIC_HOVER_CARD);else if(a==="search"||a==="messengerUniversalSearch")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_UNIVERSAL_SEARCH);else if(a==="story"||a==="storyAggregatedUsers"||a==="storySeenByList")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").FB_STORY);else if(a==="timeline"||a==="feedOrganicPost")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").FB_FEED_ORGANIC_POST);else if(a==="pageAboutCard")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").FB_PAGE_ABOUT_CARD);else if(a==="inboxInThread")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_INBOX_IN_THREAD);else if(a==="notificationInThreadReply")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_NOTIFICATION_IN_THREAD_REPLY);else if(a==="archieve")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_ARCHIVED_THREADS);else if(a==="storyViewerSheetRow")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").FB_STORY_VIEWER_SHEET_ROW);else if(a==="chatheadsNewMessage")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").CHATHEADS_NEW_MESSAGE);else if(a==="event")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").FB_EVENT);else if(a==="jewelSearch")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").JEWEL_SEARCH);else if(a==="inboxSpam"||a==="inboxThreadList"||a==="inboxRestricted")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_INBOX);else if(a==="jewelNewMessage")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").JEWEL_NEW_MESSAGE);else if(a==="pendingRequests")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_PENDING_REQUESTS_INBOX_THREAD_LIST);else if(a==="sidebarSearch")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").SIDEBAR_CONTACTS_SEARCH);else if(a==="inboxRemainingThreads")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_INBOX_REMAINING_THREADS);else if(a==="pagesHeader")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").FB_PAGE_PROFILE_HEADER_MESSAGE_BUTTON);else if(a==="inboxRecentThreads")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_INBOX_RECENT_THREADS);else if(a==="chatheads")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").CHATHEADS);else if(a==="pageResponsivenessCard")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").FB_PAGE_RESPONSIVENESS_CONTEXT_CARD);else if(a==="inboxSearch")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_INBOX_MESSAGE_SEARCH);else if(a==="jewelNestedFolder")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").JEWEL_NESTED_FOLDER);else if(a==="marketplace")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").MARKETPLACE_SEND_MESSAGE);else if(a==="feedOrganicPostViewAndMessage")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").FB_FEED_ORGANIC_POST_VIEW_AND_MESSAGE);else if(a==="adsCta")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").CLICK_TO_MESSENGER_AD_SEND_MESSAGE_CTA);else if(a==="chatInThread")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_CHAT_IN_THREAD);else if(a==="payments")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").PAYMENTS);else if(a==="inboxFolder")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_INBOX_NESTED_FOLDER);else if(a==="inboxArchived")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_INBOX_ARCHIVED_THREADS);else if(a==="inboxActiveContacts")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_INBOX_ACTIVE_CONTACTS);else if(a==="sidebarContactsList")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").SIDEBAR_CONTACTS_LIST);else if(a==="sidebarCommunityChatsList")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").SIDEBAR_CONTACTS_COMMUNITY_CHATS);else return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").UNKNOWN)}g.getSource=a}),98);
__d("getMWReplySourceId",["MWChatMessageId"],(function(a,b,c,d,e,f,g){"use strict";function a(a){if(a==null)return;return d("MWChatMessageId").getMessageId(a.content._0.messageID)}g["default"]=a}),98);
__d("useLSMessagingSource",["MWLSThreadDisplayContext"],(function(a,b,c,d,e,f,g){"use strict";function a(){var a=d("MWLSThreadDisplayContext").useMWLSThreadDisplayContext();switch(a){case"Inbox":return"inboxInThread";case"FullscreenChat":return"fullscreenChat";case"ChatTab":return"chatInThread";default:return"unknown"}}g["default"]=a}),98);
__d("LSMessageReplySourceType",[],(function(a,b,c,d,e,f){a=Object.freeze({NONE:0,MESSAGE:1,STORY:2,FORWARD:3,FB_STORY_SHARE:4,IG_STORY_SHARE:5,LIGHTWEIGHT_STATUS:6,LIGHTWEIGHT_STATUS_REACTION:7,FB_FEED_POST:13,HIGHLIGHTS_TAB_POST_REPLY:14,HIGHLIGHTS_TAB_LOCAL_EVENT_REPLY:15});f["default"]=a}),66);
__d("MessagePowerUp",[],(function(a,b,c,d,e,f){a=Object.freeze({AVATAR_LOVE:1e3,AVATAR_ANGER:1001,AVATAR_LAUGH:1002,AVATAR_CRY:1003,NONE:0,LOVE:1,GIFT_WRAP:2,CELEBRATION:3,FIRE:4});f["default"]=a}),66);
__d("WorkChatMessageType",[],(function(a,b,c,d,e,f){"use strict";a="text";b="gif";c="sticker";d="audio";e="file";f.text=a;f.gif=b;f.sticker=c;f.audio=d;f.file=e}),66);
__d("useMWLSSendStickerMessage",["I64","Int64Hooks","LSFactory","LSIntEnum","LSMailboxType","LSMessageReplySourceType","LSMessageReplySourceTypeV2","LSOptimisticSendMessageV2","LSShape","LSThreadAttributionTypeUtil.bs","MWPActor.react","MWThread_DEPRECATED.bs","MessagePowerUp","WorkChatMessageType","getMWReplySourceId","promiseDone","useReStore"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,e){var f=c("useReStore")(),g=d("MWPActor.react").useActor();return d("Int64Hooks").useCallbackInt64(function(h,i,j,k){c("promiseDone")(f.runInTransaction(function(e){var f,l=d("MWThread_DEPRECATED.bs").toThreadKey(h);f=d("LSThreadAttributionTypeUtil.bs").getSource(l,(f=a)!=null?f:"unknown");return c("LSOptimisticSendMessageV2")(g,l,d("LSIntEnum").ofNumber(1),d("LSIntEnum").ofNumber(c("LSMailboxType").MESSENGER),void 0,void 0,d("LSShape").ofRecord({calculate_denormalizations:!0,initiating_source:b,mark_read:!0,optimistic_attachment_preview:d("LSShape").ofRecord({playable_url:void 0,playable_url_expiration_timestamp_ms:void 0,playable_url_fallback:void 0,playable_url_mime_type:void 0,preview_height:d("I64").zero,preview_url:k,preview_url_expiration_timestamp_ms:void 0,preview_url_fallback:void 0,preview_url_mime_type:void 0,preview_width:d("I64").zero}),power_up_style:d("LSIntEnum").ofNumber(c("MessagePowerUp").NONE),reply_source_id:c("getMWReplySourceId")(j),reply_source_type:d("LSIntEnum").ofNumber(c("LSMessageReplySourceType").MESSAGE),reply_source_type_v2:d("LSIntEnum").ofNumber(c("LSMessageReplySourceTypeV2").MESSAGE),snippet_has_emoji:!1,source:f,sticker_id:d("I64").of_string(i)}),c("LSFactory")(e))},"readwrite").then(function(a){e==null?void 0:e(d("WorkChatMessageType").sticker,1,a[0])}))},[f,g,b,a,e])}g["default"]=a}),98);
__d("MWChatForwardDialog.entrypoint",["JSResourceForInteraction","MWChatForwardDialogQuery$Parameters","MWXacGating.bs","WebPixelRatio"],(function(a,b,c,d,e,f,g){"use strict";a={getPreloadProps:function(a){return{queries:{forwardQueryReference:{parameters:b("MWChatForwardDialogQuery$Parameters"),variables:{scale:d("WebPixelRatio").get(),suppress_xac_groups:!d("MWXacGating.bs").isGroupsEnabled()}}}}},root:c("JSResourceForInteraction")("MWChatForwardDialog.react").__setRef("MWChatForwardDialog.entrypoint")};g["default"]=a}),98);
__d("LSMediaUrl.bs",["I64","LSMediaUrlUtils","rewriteFallbackUrl"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.previewUrlExpirationTimestampMs;return b!=null&&d("LSMediaUrlUtils").isTimestampExpired(b)?c("rewriteFallbackUrl")(a.previewUrlFallback):a.previewUrl}function b(a){var b=a.previewUrlExpirationTimestampMs;return b!=null&&d("LSMediaUrlUtils").isTimestampExpired(b)?c("rewriteFallbackUrl")(a.previewUrlFallback):a.previewUrlLarge}function e(a){var b=a.playableUrlExpirationTimestampMs;return b!=null&&d("LSMediaUrlUtils").isTimestampExpired(b)?c("rewriteFallbackUrl")(a.playableUrlFallback):a.playableUrl}function f(a){var b=a.imageUrlExpirationTimestampMs;return b!=null&&d("LSMediaUrlUtils").isTimestampExpired(b)?c("rewriteFallbackUrl")(a.imageUrlFallback):a.imageUrl}function h(a){var b=a.faviconUrlExpirationTimestampMs;return b!=null&&d("LSMediaUrlUtils").isTimestampExpired(b)?c("rewriteFallbackUrl")(a.faviconUrlFallback):a.faviconUrl}function i(a){try{var b=a.listItemContactUrlExpirationTimestampList1;return b!=null&&d("LSMediaUrlUtils").isTimestampExpired(d("I64").of_string(b))?c("rewriteFallbackUrl")(a.listItemContactUrlFallbackList1):a.listItemContactUrlList1}catch(b){return a.listItemContactUrlList1}}function j(a){try{var b=a.listItemContactUrlExpirationTimestampList2;return b!=null&&d("LSMediaUrlUtils").isTimestampExpired(d("I64").of_string(b))?c("rewriteFallbackUrl")(a.listItemContactUrlFallbackList2):a.listItemContactUrlList2}catch(b){return a.listItemContactUrlList2}}function k(a){try{var b=a.listItemContactUrlExpirationTimestampList3;return b!=null&&d("LSMediaUrlUtils").isTimestampExpired(d("I64").of_string(b))?c("rewriteFallbackUrl")(a.listItemContactUrlFallbackList3):a.listItemContactUrlList3}catch(b){return a.listItemContactUrlList3}}function l(a){var b=a.headerImageUrlExpirationTimestampMs;return b!=null&&d("LSMediaUrlUtils").isTimestampExpired(b)?c("rewriteFallbackUrl")(a.headerImageUrlFallback):a.headerImageUrl}function m(a){try{var b=a.listItemProfilePictureUrlExpirationTimestamp1;if(b!=null&&d("LSMediaUrlUtils").isTimestampExpired(d("I64").of_string(b)))return c("rewriteFallbackUrl")(a.listItemProfilePictureUrlFallback1);else return a.listItemProfilePictureUrl1}catch(b){return a.listItemProfilePictureUrl1}}function n(a){try{var b=a.listItemProfilePictureUrlExpirationTimestamp2;return b!=null&&d("LSMediaUrlUtils").isTimestampExpired(d("I64").of_string(b))?c("rewriteFallbackUrl")(a.listItemProfilePictureUrlFallback2):a.listItemProfilePictureUrl2}catch(b){return a.listItemProfilePictureUrl2}}function o(a){try{var b=a.listItemProfilePictureUrlExpirationTimestamp3;return b!=null&&d("LSMediaUrlUtils").isTimestampExpired(d("I64").of_string(b))?c("rewriteFallbackUrl")(a.listItemProfilePictureUrlFallback3):a.listItemProfilePictureUrl3}catch(b){return a.listItemProfilePictureUrl3}}h={faviconUrl:h,headerImageUrl:l,imageUrl:f,listItemContactUrlList1:i,listItemContactUrlList2:j,listItemContactUrlList3:k,listItemProfilePictureUrl1:m,listItemProfilePictureUrl2:n,listItemProfilePictureUrl3:o,playableUrl:e,previewUrl:a,previewUrlLarge:b};function p(a){var b=a.previewUrlExpirationTimestampMs;if(b!=null&&d("LSMediaUrlUtils").isTimestampExpired(b))return c("rewriteFallbackUrl")(a.previewUrlFallback);else return a.previewUrl}function q(a){var b=a.previewUrlExpirationTimestampMs;if(b!=null&&d("LSMediaUrlUtils").isTimestampExpired(b))return c("rewriteFallbackUrl")(a.previewUrlFallback);else return a.previewUrlLarge}function r(a){var b=a.playableUrlExpirationTimestampMs;if(b!=null&&d("LSMediaUrlUtils").isTimestampExpired(b))return c("rewriteFallbackUrl")(a.playableUrlFallback);else return a.playableUrl}function s(a){var b=a.faviconUrlExpirationTimestampMs;if(b!=null&&d("LSMediaUrlUtils").isTimestampExpired(b))return c("rewriteFallbackUrl")(a.faviconUrlFallback);else return a.faviconUrl}l={faviconUrl:s,playableUrl:r,previewUrl:p,previewUrlLarge:q};g.Attachment=h;g.AttachmentItem=l}),98);
__d("MWChatInteractionLog.bs",["QPLUserFlow"],(function(a,b,c,d,e,f,g){"use strict";var h=new Map();function a(a,b){var d=Date.now()|0;h.set(b,d);c("QPLUserFlow").start(a,{cancelOnUnload:!0,instanceKey:d,timeoutInMs:6e4})}function b(a,b,d){b=h.get(b);if(!(b==null)){c("QPLUserFlow").endFailure(a,d,{instanceKey:b});return}}function d(a,b){b=h.get(b);if(!(b==null)){c("QPLUserFlow").endSuccess(a,{instanceKey:b});return}}function e(a,b,d){b=h.get(b);if(!(b==null)){c("QPLUserFlow").addPoint(a,d,{instanceKey:b});return}}g.logStartUserFlow=a;g.logFailUserFlow=b;g.logSuccessUserFlow=d;g.logPointUserFlow=e}),98);
__d("useGetForwardSource",["LSIntEnum","LSMessagingThreadAttributionType","MWLSThreadDisplayContext"],(function(a,b,c,d,e,f,g){"use strict";function a(){var a=d("MWLSThreadDisplayContext").useMWLSThreadDisplayContext();if(a!=null)if(a==="Inbox")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_INBOX_FORWARD);else if(a==="ChatTab")return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_CHAT_FORWARD);else return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_BROADCAST_FLOW);else return d("LSIntEnum").ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_BROADCAST_FLOW)}g["default"]=a}),98);
__d("MWLSForwardMessage.bs",["I64","Int64Hooks","LSFactory","LSMediaUrl.bs","LSOptimisticSendAttachmentForward","LSOptimisticSendMessageForward","MWChatInteractionLog.bs","MWChatThreadId","MWPActor.react","MWThread_DEPRECATED.bs","ODS","Promise","ReQL","promiseDone","qpl","useGetForwardSource","useLSMessagingInitiatingSource","useLSMessagingSource","useMWLSSendStickerMessage","useReStore"],(function(a,b,c,d,e,f,g){"use strict";function a(){var a=c("useReStore")(),e=d("MWPActor.react").useActor(),f=c("useLSMessagingInitiatingSource")(),g=c("useGetForwardSource")(),h=c("useLSMessagingSource")(),i=c("useMWLSSendStickerMessage")(h,f);return d("Int64Hooks").useCallbackInt64(function(h,j){if(j.type!=="sent")return;var k=d("MWChatThreadId").getMessagingThreadType(h),l=d("MWThread_DEPRECATED.bs").toThreadKey(h);j=j.value;var m=j.timestamp,n=j.messageId,o=j.threadId;d("ODS").bumpEntityKey(3185,"mw_forward","send");d("MWChatInteractionLog.bs").logPointUserFlow(c("qpl")._(25298392,"4881"),n,"sending");var p=function(){return a.runInTransaction(function(a){return c("LSOptimisticSendMessageForward")(e,l,k,o,m,n,g,f,c("LSFactory")(a))},"readwrite").then(function(){})};c("promiseDone")(d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.table("messages")).getKeyRange(o,m,n)).then(function(c){if(c==null)return p();var e=c.stickerId;if(e!=null)return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.table("attachments")).getKeyRange(o,n)).then(function(a){a=a!=null?d("LSMediaUrl.bs").Attachment.previewUrl(a):void 0;i(h,d("I64").to_string(e),void 0,a);return b("Promise").resolve()});else return p()}),function(){d("ODS").bumpEntityKey(3185,"mw_forward","success");return d("MWChatInteractionLog.bs").logSuccessUserFlow(c("qpl")._(25298392,"4881"),n)},function(){d("ODS").bumpEntityKey(3185,"mw_forward","failure");return d("MWChatInteractionLog.bs").logFailUserFlow(c("qpl")._(25298392,"4881"),n,"ls_error")});return},[a,e,f,g,i])}function e(){var a=c("useReStore")(),b=d("MWPActor.react").useActor(),e=c("useLSMessagingInitiatingSource")(),f=c("useGetForwardSource")();return d("Int64Hooks").useMemoInt64(function(){return function(g,h,i){d("ODS").bumpEntityKey(3185,"mw_forward","send");i!=null&&d("MWChatInteractionLog.bs").logPointUserFlow(c("qpl")._(25298392,"4881"),i,"sending");var j=d("MWChatThreadId").getMessagingThreadType(g),k=d("MWThread_DEPRECATED.bs").toThreadKey(g);c("promiseDone")(a.runInTransaction(function(a){return c("LSOptimisticSendAttachmentForward")(b,k,j,void 0,void 0,void 0,void 0,d("I64").of_string(h),f,e,c("LSFactory")(a))},"readwrite"),function(){d("ODS").bumpEntityKey(3185,"mw_forward","success");if(i!=null)return d("MWChatInteractionLog.bs").logSuccessUserFlow(c("qpl")._(25298392,"4881"),i)},function(){i!=null&&d("MWChatInteractionLog.bs").logFailUserFlow(c("qpl")._(25298392,"4881"),i,"ls_error"),d("ODS").bumpEntityKey(3185,"mw_forward","failure")})}},[a,b,e,f])}g.useForwardMessage=a;g.useForwardAttachment=e}),98);
__d("useMWChatForward",["MWChatForwardDialog.entrypoint","MWChatInteractionLog.bs","MWChatMessageId","qpl","react","useMWXEntryPointDialog"],(function(a,b,c,d,e,f,g){"use strict";b=d("react");var h=b.useCallback,i=b.useRef;function a(a){var b=a.dropToggle,e=a.forwardDialogType,f=a.messageID,g=a.onClose,j=a.onSend;a=i(null);var k=c("useMWXEntryPointDialog")(c("MWChatForwardDialog.entrypoint"),{}),l=k[0];k=h(function(){var a=d("MWChatMessageId").getMessageId(f);a!=null&&d("MWChatInteractionLog.bs").logStartUserFlow(c("qpl")._(25298392,"4881"),a);l({dropToggle:b,forwardDialogType:e,messageID:f,onSend:j},g)},[j,l,f,g,e,b]);return{onClick:k,triggerRef:a}}g["default"]=a}),98);
__d("useMWV2ForwardMessage",["$InternalEnum","FBLogger","I64","Int64Hooks","LSMessagingThreadTypeUtil","MAWDbMsg","MAWThreadId","MAWVerifyThreadCutover","MWChatMessageId","MWLSForwardMessage.bs","MWPActor.react","MWQPLMarkers","MWSharedMsgLogUtils","MWThread_DEPRECATED.bs","Promise","ReQL","ReQLSuspense","asyncToGeneratorRuntime","cr:338","cr:4950","cr:6090","cr:6938","promiseDone","unrecoverableViolation","useGetForwardSource","useMWSendToSentQPLLogger","useReStore"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){var c=b.threadKey;return d("ReQLSuspense").useFirstExn(function(){return d("ReQL").fromTableAscending(a.table("threads")).getKeyRange(c)},[a,c],f.id+":54")}function i(a,b){return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.table("threads")).getKeyRange(b))}function j(a,b,c){return d("ReQL").firstAsync(d("ReQL").mergeJoin(d("ReQL").fromTableAscending(a.table("participants")).getKeyRange(b),d("ReQL").fromTableAscending(a.table("contacts"))).filter(function(a){a[0];a=a[1];return!d("I64").equal(a.id,c)}))}function k(a,b){var c=b.messageId,e=b.threadKey;return d("ReQLSuspense").useFirst(function(){return d("ReQL").fromTableAscending(a.table("attachments")).getKeyRange(e,c)},[a,c,e],f.id+":83")}var l=b("$InternalEnum")({SecureToOpen:"secure_to_open",OpenToOpen:"open_to_open",SecureToSecure:"secure_to_secure",OpenToSecure:"open_to_secure"});function a(a){var e=c("useReStore")(),f=h(e,a),g=k(e,a),m=d("LSMessagingThreadTypeUtil").isSecure(f.threadType),n=d("MWPActor.react").useActor(),o=!d("I64").equal(n,a.senderId),p=d("MWLSForwardMessage.bs").useForwardMessage(),q=c("useGetForwardSource")(),r=d("MWChatMessageId").makeSent(d("I64").to_string(a.threadKey),a.messageId,d("I64").to_string(a.timestampMs)),s=c("useMWSendToSentQPLLogger")(),t=s.addSendToSentAnnotations,u=s.markSendToSentFail,v=s.markSendToSentPoint,w=s.markSendToSentStart,x=s.markSendToSentSuccess,y=d("Int64Hooks").useCallbackInt64(function(){var f=b("asyncToGeneratorRuntime").asyncToGenerator(function*(f){var h=d("MWThread_DEPRECATED.bs").toThreadKey(f),k=(yield d("MAWVerifyThreadCutover").verifyThreadCutover(b("Promise").resolve(e),h)),m=w();h=(yield b("Promise").all([d("MAWThreadId").isSecureThreadId(e,h),i(e,h),j(e,h,n),d("MAWThreadId").getThreadFromJid(e,h)]));var p=h[0],r=h[1],s=h[2];h=h[3];var y=d("MWSharedMsgLogUtils").getMessageTypeParams();h!=null&&c("promiseDone")(d("MWSharedMsgLogUtils").getSendToSentAnnotations(h,y,q),function(a){a.string=babelHelpers["extends"]({},a.string,{attachment_type:"forward",message_type:"forward"}),t(m,a)});h=p||k;try{if(b("cr:6938")!=null&&!h){t(m,{string:{forward_type:l.SecureToOpen}});yield b("cr:6938").forwardMessage(e,f,a,o,g,n,q);x(m);return}y=d("MAWDbMsg").toMsgId(a.messageId);if(y==null)throw c("unrecoverableViolation")("Message does not have an id","messenger_web_product");if(b("cr:338")!=null){t(m,{string:{forward_type:l.SecureToSecure}});if(b("cr:6090")!=null&&r!=null){b("cr:338").forwardMessage(e,f,y,q,(p=m)!=null?p:void 0);x(m);return b("cr:6090")(e,r,s,d("LSMessagingThreadTypeUtil").isOneToOne(r.threadType))}b("cr:338").forwardMessage(e,f,y,q,(k=m)!=null?k:void 0);x(m);return}throw c("unrecoverableViolation")("We won't reach to this step, if you are in QE, you should use secure forward","messenger_web_product")}catch(a){v(m,d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.FAIL_FORWARDING_MESSAGE);u(m,a);c("FBLogger")("messenger_e2ee_web").catching(a).mustfix("MW Fail forwarding a message");throw a}});return function(a){return f.apply(this,arguments)}}(),[e,w,n,q,t,a,o,g,x,v,u]),z=d("Int64Hooks").useCallbackInt64(function(){var h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(h){var k=d("MWThread_DEPRECATED.bs").toThreadKey(h);k=(yield b("Promise").all([d("MAWThreadId").isSecureThreadId(e,k),i(e,k),j(e,k,n),d("MAWVerifyThreadCutover").verifyThreadCutover(b("Promise").resolve(e),k),d("MAWThreadId").getThreadFromJid(e,k)]));var m=k[0],s=k[1],y=k[2],z=k[3];k=k[4];m=m||z;var A=w();z=d("MWSharedMsgLogUtils").getMessageTypeParams();k!=null&&c("promiseDone")(d("MWSharedMsgLogUtils").getSendToSentAnnotations(k,z,q),function(a){a.string=babelHelpers["extends"]({},a.string,{attachment_type:"forward",message_type:"forward"}),t(A,a)});try{if(b("cr:4950")!=null&&m){t(A,{string:{forward_type:l.OpenToSecure}});if(b("cr:6090")!=null&&s!=null){b("cr:4950").forwardMessage(e,h,f,a,o,g,q,(k=A)!=null?k:void 0);x(A);return b("cr:6090")(e,s,y,d("LSMessagingThreadTypeUtil").isOneToOne(s.threadType))}else{b("cr:4950").forwardMessage(e,h,f,a,o,g,q,(z=A)!=null?z:void 0);x(A);return}}t(A,{string:{forward_type:l.OpenToOpen}});p(h,r);x(A);return}catch(a){v(A,d("MWQPLMarkers").MESSAGE_SEND_TO_SENT.FAIL_FORWARDING_MESSAGE);u(A,a);c("FBLogger")("messenger_e2ee_web").catching(a).mustfix("MW Fail forwarding a message");throw a}});return function(a){return h.apply(this,arguments)}}(),[t,e,p,o,u,w,x,v,g,a,r,n,q,f]);return d("Int64Hooks").useMemoInt64(function(){return m?y:z},[m,y,z])}g["default"]=a}),98);
__d("MWCMIsSubthreadContext.react",["react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");c=d("react");e=c.createContext;var i=c.useContext,j=c.useMemo,k=e({isSubthread:!1});function a(){return i(k)}function b(a){var b=a.children,c=a.isSubthread;a=j(function(){return{isSubthread:c}},[c]);return h.jsx(k.Provider,{value:a,children:b})}b.displayName=b.name+" [from "+f.id+"]";g.useIsSubthreadContext=a;g.MWCMIsSubthreadContextProvider=b}),98);
__d("MWV2MessageRowIsRowFocusedContext.bs",["emptyFunction","react"],(function(a,b,c,d,e,f,g){"use strict";d("react");b=d("react");e=b.createContext;var h=b.createElement;d={isDialogOpened:!1,setFocused:c("emptyFunction"),setIsDialogOpened:c("emptyFunction")};var i=e(d);function a(a){var b=a.children;a=a.value;return h(i.Provider,{children:b,value:a})}a.displayName=a.name+" [from "+f.id+"]";g.context=i;g.MWV2MessageRowIsRowFocusedContextProvider=a}),98);
__d("MWV2OneToOneThreadBlockedContext.react",["react"],(function(a,b,c,d,e,f,g){"use strict";d("react");c=d("react");e=c.createContext;var h=c.createElement,i=c.useContext,j=e(!1);function a(){return i(j)}function b(a){var b=a.blocked;a=a.children;return h(j.Provider,{children:a,value:b})}b.displayName=b.name+" [from "+f.id+"]";g.useIsBlocked=a;g.MWV2OneToOneThreadBlockedContext=b}),98);
__d("useMWHasForwardAction",["I64","LSAuthorityLevel","LSBitFlag","LSContactBitOffset","LSIntEnum","LSMessagingThreadTypeUtil","LSThreadBitOffset","MAWGating","MAWMsg","MWCMIsAnyCMThread","MWCMIsSubthreadContext.react","MWV2OneToOneThreadBlockedContext.react","MessagingAttachmentType","ReQL","ReQLSuspense","gkx","useIsReadOnlyFeatureLimitedWithThreadType","useReStore"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,e){var g=c("useReStore")(),h=d("MWCMIsSubthreadContext.react").useIsSubthreadContext();h=h.isSubthread;h=h&&!d("LSMessagingThreadTypeUtil").isCMSubthread(a.threadType);var i=d("LSMessagingThreadTypeUtil").isSecure(a.threadType),j=b.ephemeralDurationInSec;j=j!=null?d("I64").gt(j,d("I64").zero):!1;var k=c("useIsReadOnlyFeatureLimitedWithThreadType")(a.threadType)&&(!i||d("MAWGating").isFeatureLimitEnabled()),l=d("I64").equal(b.displayedContentTypes,d("LSIntEnum").ofNumber(4096)),m=d("I64").equal(b.displayedContentTypes,d("LSIntEnum").ofNumber(64)),n=d("MWV2OneToOneThreadBlockedContext.react").useIsBlocked(),o=d("ReQLSuspense").useFirst(function(){return d("ReQL").fromTableAscending(g.table("contacts")).getKeyRange(a.threadKey)},[a.threadKey,g],f.id+":63");o=o!=null?(o=d("LSContactBitOffset").has(d("LSIntEnum").ofNumber(66),o))!=null?o:!1:!1;var p=c("MWCMIsAnyCMThread")(a.threadType)&&d("I64").equal(b.sendStatusV2,d("LSIntEnum").ofNumber(4)),q=d("LSBitFlag").has(d("LSIntEnum").ofNumber(2),b.displayedContentTypes);i=(i?!j&&!l&&!(m&&!c("gkx")("9045")):!0)&&c("gkx")("1844772")&&!h&&!n&&!o&&!k&&!b.isUnsent&&!p&&!d("MAWMsg").isPlaceholder(b)&&d("LSThreadBitOffset").has(d("LSIntEnum").ofNumber(103),a)&&d("I64").gt(b.authorityLevel,d("LSIntEnum").ofNumber(c("LSAuthorityLevel").OPTIMISTIC))&&(e!=null&&d("I64").equal(e.attachmentType,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").XMA))&&(e.attachmentCta1Id!=null||e.attachmentCta2Id!=null||e.attachmentCta3Id!=null||e.defaultCtaId!=null)?e.isSharable:!0);j=q&&i;return{hasForwardAction:i,shouldShowForwardAction:j}}g["default"]=a}),98);
__d("MAWSecureComposerUtils",["I64","LSMessagingThreadTypeUtil","MAWAudioUtils","MAWBridgeFireAndForget","MAWBridgeSendAndReceive","MAWDbMsg","MAWExternalId","MAWGating","MAWGetEphemeralSettings","MAWImagePreProcess","MAWJobDefinitions","MAWMiActOnActThreadReady","MAWTimedJob","MAWUIJob","MAWUIThreadCache","MAWVideoPreProcess","MAWVideoUtils","MessageRequestsLog","Promise","QPLUserFlow","WAJobOrchestratorTypes","asyncToGeneratorRuntime","fileInputAcceptValues","gkx","promiseDone","qpl","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("MWLogSend.bs").__setRef("MAWSecureComposerUtils");function a(a,c){c?c=a.type==="image/webp"?b("Promise").resolve(a):d("MAWImagePreProcess").imageTranscode(a,"image/webp"):c=a.type==="image/gif"?b("Promise").resolve(a):d("MAWImagePreProcess").imageTranscode(a,"image/jpeg");return c.then(function(a){return b("Promise").all([d("MAWImagePreProcess").getJpegThumbnailInfo(a,400),d("MAWImagePreProcess").getImageSpec(a),a])}).then(function(a){var c=a[0],d=a[1];a=a[2];return b("Promise").resolve({args:{imageSpec:d,thumbnailUrlAndSpec:c},file:a,type:"image"})})}function e(a){return d("MAWVideoPreProcess").processRawVideo(a,!1).then(function(a){return b("Promise").all([a,d("MAWVideoUtils").getVideoThumbnailUrlAndSpec(a)])}).then(function(a){var c=a[0];a=a[1];return b("Promise").resolve({args:{thumbnailUrlAndSpec:a},file:c,type:"video"})})}function f(a){return d("MAWAudioUtils").getAudioDurationInSeconds(a).then(function(c){return b("Promise").resolve({args:{durations:c,isPtt:!0},file:a,type:"audio"})})}function i(a){return b("Promise").resolve({args:{filename:a.name},file:a,type:"document"})}function j(a,b,c,d,e,f,g,h,i,j,l,m){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g,i,j,k,l,m,n,o){b=(yield d("MAWUIThreadCache").getThreadJidByChatId({threadId:b}));if(b==null){c("QPLUserFlow").endFailure(c("qpl")._(25313175,"1551"),"no_chat_jid",{instanceKey:o});return}var p=null;if(l!=null){l=d("MAWDbMsg").toMsgId(l.messageId);l!=null&&(p=(yield d("MAWBridgeSendAndReceive").sendAndReceive("backend","getProtocolMsgIdByMsgId",{msgId:l})))}c("QPLUserFlow").addPoint(c("qpl")._(25313175,"1551"),"fetch_ephemeral_settings",{instanceKey:o});l=(yield d("MAWGetEphemeralSettings").getEphemeralSetting(b,e));c("QPLUserFlow").addPoint(c("qpl")._(25313175,"1551"),"sending_media_to_wajob",{instanceKey:o});var q=c("gkx")("2280");switch(i.type){case"image":var r,s=i.args;yield d("MAWTimedJob").TimedUIJobStarters.waitUntilCompleted(d("MAWJobDefinitions").createStartJobInfo("sendMediaMsg",{args:{ephemeralSetting:(r=l)!=null?r:void 0,height:s.imageSpec.height,isFirstMsg:n,isForwarded:!1,jpegThumbnail:s.thumbnailUrlAndSpec.jpegThumbnail,jpegThumbnailHeight:s.thumbnailUrlAndSpec.height,jpegThumbnailWidth:s.thumbnailUrlAndSpec.width,offlineAttachmentId:j,quote:(r=p)!=null?r:void 0,s2sInstanceKey:o,source:k,width:s.imageSpec.width},chatJid:b,externalId:d("MAWExternalId").generateExternalId(),file:i.file,scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}}),q?600:d("MAWTimedJob").DEFAULT_TIMEOUT_MS);break;case"video":r=i.args;yield d("MAWTimedJob").TimedUIJobStarters.waitUntilCompleted(d("MAWJobDefinitions").createStartJobInfo("sendMediaMsg",{args:{duration:r.thumbnailUrlAndSpec.duration,ephemeralSetting:(s=l)!=null?s:void 0,height:r.thumbnailUrlAndSpec.height,isFirstMsg:n,isForwarded:!1,jpegThumbnail:r.thumbnailUrlAndSpec.jpegThumbnail,jpegThumbnailHeight:r.thumbnailUrlAndSpec.height,jpegThumbnailWidth:r.thumbnailUrlAndSpec.width,offlineAttachmentId:j,quote:(s=p)!=null?s:void 0,s2sInstanceKey:o,source:k,width:r.thumbnailUrlAndSpec.width},chatJid:b,externalId:d("MAWExternalId").generateExternalId(),file:i.file,scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}}),q?600:d("MAWTimedJob").DEFAULT_TIMEOUT_MS);break;case"audio":s=i.args;yield d("MAWTimedJob").TimedUIJobStarters.waitUntilCompleted(d("MAWJobDefinitions").createStartJobInfo("sendMediaMsg",{args:{duration:Math.round(s.durations),ephemeralSetting:(r=l)!=null?r:void 0,isFirstMsg:n,isForwarded:!1,isPtt:s.isPtt,offlineAttachmentId:j,quote:(r=p)!=null?r:void 0,s2sInstanceKey:o,source:k},chatJid:b,externalId:d("MAWExternalId").generateExternalId(),file:i.file,scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}}));break;case"document":s=i.args;yield d("MAWTimedJob").TimedUIJobStarters.waitUntilCompleted(d("MAWJobDefinitions").createStartJobInfo("sendMediaMsg",{args:{ephemeralSetting:(r=l)!=null?r:void 0,filename:s.filename,isFirstMsg:n,isForwarded:!1,offlineAttachmentId:j,quote:(l=p)!=null?l:void 0,s2sInstanceKey:o,source:k},chatJid:b,externalId:d("MAWExternalId").generateExternalId(),file:i.file,scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}}),q?600:d("MAWTimedJob").DEFAULT_TIMEOUT_MS);break;default:c("QPLUserFlow").addPoint(c("qpl")._(25313175,"1551"),"uknown_file_type_sendMediaMsg_not_fired",{instanceKey:o})}var t;switch(i.type){case"image":t=8;break;case"video":t=10;break;case"audio":t=11;break;case"document":t=34;break}h.onReady(function(b){var c=d("I64").to_string(e);return b.log(a,e,f,j,[],g,k,t,!1,0,1,c,void 0,m?["dst:3"]:void 0,void 0)});return b});return k.apply(this,arguments)}var l=[".mp4",".mov"].concat(d("fileInputAcceptValues").PHOTO);l=c("gkx")("9045")?["*/*"]:["audio/*"].concat(l);function m(a,e,f,g){if(d("LSMessagingThreadTypeUtil").isSecure(e.threadType)){f!=null&&d("MessageRequestsLog").logActionConfirmed(e,8,d("I64").to_string(f));c("promiseDone")(d("MAWMiActOnActThreadReady").onActThreadReady(a,e.threadKey,"MAWSecureComposerUtils",function(a,c,e){d("MAWGating").isAppSyncDeleteThreadEnabled()?d("MAWUIJob").UIJobStarters.fireAndForget(d("MAWJobDefinitions").createStartJobInfo("deleteThread",{chatId:c,scheduleConfig:{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}})):d("MAWBridgeFireAndForget").fireAndForget("backend","deleteThread",{threadId:c});return b("Promise").resolve()}));return}}g.imagePreprocess=a;g.videoPreprocess=e;g.audioPreprocess=f;g.documentFilePreprocess=i;g.sendAttachment=j;g.supportedFileTypes=l;g.onDeleteThread=m}),98);
__d("MAWSupportedDocumentTypes",[],(function(a,b,c,d,e,f){"use strict";var g=["apk","pyc","7z","z","gz","xz","rar","zip","zipx","ace","arc","zpaq","quad","balz","cab","arj","lzh","uue","bz","bz2","bzip2","jar","iso","tar","ade","adp","air","app","application","bas","bat","chm","cmd","com","command","cpl","crt","dll","dmg","dpkg","exe","hlp","hta","inf","ins","isp","jnlp","js","jse","lib","lnk","lua","mde","msc","msi","msp","mst","ocx","pcd","pif","pkg","ps1","reg","scr","sct","sh","shb","shs","sys","term","url","vb","vbe","vbs","vxd","webarchive","wsc","wsf","wsh","xbap"];function a(a){if(a==null)return!1;a=a.includes(".")?a.split(".").pop():null;return a!=null&&!g.includes(a)}f.isAllowedType=a}),66);
__d("MAWMediaManagerUtils",["MAWBridgeFireAndForget","MAWMediaUtils","MAWMiActOnActThreadReady","MAWSecureComposerUtils","MAWSupportedDocumentTypes","OfflineThreadingId","Promise","cometIsMimeTypeForMedia","gkx","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h=new Map();function a(a){return b("Promise").all(a.map(function(a){if(a.type==="image/gif"||a.type==="image/webp"||d("cometIsMimeTypeForMedia").isMimeTypeForPhoto(a.type))return d("MAWSecureComposerUtils").imagePreprocess(a,!1);if(d("cometIsMimeTypeForMedia").isMimeTypeForVideo(a.type))return d("MAWSecureComposerUtils").videoPreprocess(a);if(a.type.startsWith("audio/"))return d("MAWSecureComposerUtils").audioPreprocess(a);return d("MAWSupportedDocumentTypes").isAllowedType(a.name)&&c("gkx")("9045")?d("MAWSecureComposerUtils").documentFilePreprocess(a):b("Promise").reject("Unsupported file type")})).then(function(a){a=d("OfflineThreadingId").createForItemsInOrder(a);a.forEach(function(a){h.set(a[1],a[0])});return a.map(function(a){return[a[0].file,a[1]]})})}function e(a,e,f){c("promiseDone")(d("MAWMiActOnActThreadReady").onActThreadReady(a,e,"MAWMediaManagerUtils",function(a,c,e){a=f.reduce(function(a,b){b=h.get(b[1]);b!=null&&a.push(b);return a},[]);a.forEach(function(a){switch(a.type){case"image":return d("MAWBridgeFireAndForget").fireAndForget("backend","optimisticUploadMedia",{file:a.file,threadId:c,thumbnail:d("MAWMediaUtils").convertJpegThumbnailArrayBufferToFile(a.args.thumbnailUrlAndSpec.jpegThumbnail)});case"video":return d("MAWBridgeFireAndForget").fireAndForget("backend","optimisticUploadMedia",{file:a.file,threadId:c,thumbnail:d("MAWMediaUtils").convertJpegThumbnailArrayBufferToFile(a.args.thumbnailUrlAndSpec.jpegThumbnail)});case"audio":return d("MAWBridgeFireAndForget").fireAndForget("backend","optimisticUploadMedia",{file:a.file,threadId:c,thumbnail:null});case"document":return d("MAWBridgeFireAndForget").fireAndForget("backend","optimisticUploadMedia",{file:a.file,threadId:c,thumbnail:null})}});return b("Promise").resolve()}))}g.MAWMediaManagerAttachments=h;g.preprocess=a;g.upload=e}),98);
__d("MWV2MediaViewerContainer.react",["MessengerBlurpleLogoSvg.react","XMessengerDotComCometRootControllerRouteBuilder","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");function a(a){var b=a.actions,d=a.children;a=a.shouldShowMessengerLogo;return h.jsxs("div",{className:"x1qjc9v5 xal61yo x9f619 x78zum5 xdt5ytf x1iyjqo2 x5yr21d x6ikm8r x10wlt62 x1n2onr6 x87ps6o x1uvtmcs",children:[d,h.jsx("div",{className:"x10l6tqk x16q8cke x1tk7jg1",children:((d=a)!=null?d:!1)?h.jsx("a",{"aria-label":"Messenger",href:c("XMessengerDotComCometRootControllerRouteBuilder").buildURL({}),children:h.jsx(c("MessengerBlurpleLogoSvg.react"),{height:"40",width:"40"})}):null}),h.jsx("div",{className:"x92rtbv x10l6tqk x1tk7jg1",children:b})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWV2LogMessageClick.bs",["I64","LSMessagingThreadTypeUtil","Promise","ReQL","UserAgentData","promiseDone","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("LsMessageClickFalcoEvent").__setRef("MWV2LogMessageClick.bs");function a(a,e,f,g){var i=e.threadKey;c("promiseDone")(d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.table("threads")).getKeyRange(i)).then(function(a){a!=null&&!d("LSMessagingThreadTypeUtil").isSecure(a.threadType)&&h.onReady(function(a){a.log(function(){var a={};g!=null&&(a.action=g);a.browserName=c("UserAgentData").browserName;return{click:{category:2},click_target:{type:f},extra:JSON.stringify(a),message:{id:e.messageId,sender_id:void 0,sent_time:d("I64").to_float(e.timestampMs)},thread:{id:d("I64").to_string(e.threadKey),key:void 0,type:void 0},xma:void 0}})});return b("Promise").resolve()}))}g.log=a}),98);
__d("useMWV2MessageForwardAction",["I64","LSBitFlag","LSIntEnum","LSMessagingThreadTypeUtil","MAWGating","MWChatMessageId","MWV2LogMessageClick.bs","MWV2MessageRowIsRowFocusedContext.bs","gkx","promiseDone","react","useMWChatForward","useMWV2ForwardMessage","useReStore"],(function(a,b,c,d,e,f,g){"use strict";b=d("react");var h=b.useCallback,i=b.useContext;function a(a,b){var e=c("useReStore")(),f=c("gkx")("1224637"),g=!f&&d("LSMessagingThreadTypeUtil").isSecure(a.threadType);f=!f&&d("MAWGating").isCrossForwardEnabled();g=g?f?"cross_transport":"secure":f?"cross_transport":"open_";f=d("MWChatMessageId").makeSent(d("I64").to_string(b.threadKey),b.messageId,d("I64").to_string(b.timestampMs));var j=c("useMWV2ForwardMessage")(b),k=i(d("MWV2MessageRowIsRowFocusedContext.bs").context),l=k.setFocused,m=k.setIsDialogOpened;k=b.stickerId;a=!d("LSMessagingThreadTypeUtil").isSecure(a.threadType);k=d("LSBitFlag").has(d("LSIntEnum").ofNumber(1),b.displayedContentTypes)&&!b.textHasLinks||d("LSBitFlag").has(d("LSIntEnum").ofNumber(16384),b.displayedContentTypes)||d("LSBitFlag").has(d("LSIntEnum").ofNumber(2),b.displayedContentTypes)||d("LSBitFlag").has(d("LSIntEnum").ofNumber(4),b.displayedContentTypes)||d("LSBitFlag").has(d("LSIntEnum").ofNumber(512),b.displayedContentTypes)||d("LSBitFlag").has(d("LSIntEnum").ofNumber(1024),b.displayedContentTypes)||k!=null&&d("I64").equal(k,d("I64").of_string("369239263222822"))||k!=null&&d("I64").equal(k,d("I64").of_string("369239343222814"))||k!=null&&d("I64").equal(k,d("I64").of_string("369239383222810"));var n=c("useMWChatForward")({dropToggle:a&&!k,forwardDialogType:g,messageID:f,onClose:h(function(){m(function(){return!1}),l(function(){return!0})},[l,m]),onSend:h(function(a){return c("promiseDone")(j(a))},[j])});return function(){d("MWV2LogMessageClick.bs").log(e,b,44),n!=null&&(m(function(){return!0}),n.onClick())}}g["default"]=a}),98);
__d("MWPOpenComposerUtils",["I64","LSRemoveMediaSendJobs","LSResumeMediaSendJob","MWConsole","Promise"],(function(a,b,c,d,e,f,g){"use strict";function a(a,c){return a.table("media_staging").get({hd:c,tl:0}).then(function(d){if(d!=null)return a.table("media_staging")["delete"]({hd:c,tl:0});else return b("Promise").resolve()})}function e(a,c,d){return a.table("media_staging").get({hd:c,tl:0}).then(function(c){if(c!=null)return a.table("media_staging").put(d(c));else return b("Promise").resolve()})}function f(a,c,d,e,f){return a.table("attachments").get({hd:c,tl:{hd:d,tl:{hd:e,tl:0}}}).then(function(g){if(g!=null)return a.table("attachments").upsert({hd:c,tl:{hd:d,tl:{hd:e,tl:0}}},f(g));else return b("Promise").resolve()})}function h(a,e,f){return c("LSResumeMediaSendJob")(e,d("I64").zero,(f=f)!=null?f:void 0,a).then(function(d){d=d[0];if(d)return c("LSRemoveMediaSendJobs")(e,a);else return b("Promise").resolve()})}g.deleteMediaStaging=a;g.updateMediaStaging=e;g.updateAttachment=f;g.resumeSendJob=h}),98);
__d("MWPComposerMediaUploadUtil",["FBLogger","I64","LSIntEnum","MessagingAttachmentType","XComposerPhotoUploader","cometIsMimeTypeForMedia","emptyFunction","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,d,e,f,g,h,i,j,k){a===void 0&&(a=c("emptyFunction"));d===void 0&&(d=c("emptyFunction"));e===void 0&&(e=!1);var l="/ajax/mercury/upload.php";h===!0&&(l="/ajax/mercury/chatsupportuser/upload.php");d=new(c("XComposerPhotoUploader"))({concurrentLimit:3,onUploadFailure:d,onUploadProgress:a,onUploadStart:c("emptyFunction"),onUploadSuccess:function(a,d){d=d.response.payload.metadata;var e;if(d==null)c("FBLogger")("messenger_browser_clients").warn("Empty payload"),e={};else{d=d[0];d!=null?e=d:(c("FBLogger")("messenger_browser_clients").warn("Empty metadata isChatSupportUser: %s",h),e={})}d=e.fbid;var f=e.video_id,g=e.audio_id,i=e.gif_id;e=e.file_id;g=(d=(f=(d=(d=d)!=null?d:f)!=null?d:g)!=null?f:i)!=null?d:e;if(g!=null)b(a,g);else throw c("unrecoverableViolation")("Unrecognized file upload success payload","messenger_comet")},retryLimit:1,uploadEndpoint:l});a={};a.data={chat_support_user_id:h===!0&&i!=null?i:void 0,nonce:h===!0&&k!=null?k:void 0,voice_clip:e?!0:void 0,voice_clip_waveform_data:e?JSON.stringify(j):void 0};d.getAsyncFileUploadRequest(f,g,a).send()}function b(a){a=a.type;if(d("cometIsMimeTypeForMedia").isMimeTypeForPhoto(a))return d("LSIntEnum").ofNumber(c("MessagingAttachmentType").IMAGE);else if(a==="audio/wav")return d("LSIntEnum").ofNumber(c("MessagingAttachmentType").AUDIO);else if(a==="image/gif")return d("LSIntEnum").ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE);else if(d("cometIsMimeTypeForMedia").isMimeTypeForVideo(a))return d("LSIntEnum").ofNumber(c("MessagingAttachmentType").VIDEO);else return d("LSIntEnum").ofNumber(c("MessagingAttachmentType").FILE)}function e(a,b,e,f){return{action_url:void 0,attachment_fbid:a,attachment_index:d("I64").zero,attachment_type:d("LSIntEnum").ofNumber(c("MessagingAttachmentType").AUDIO),cta1_title:void 0,cta2_title:void 0,cta3_title:void 0,description_text:void 0,filename:void 0,filesize:void 0,has_media:!0,has_xma:!1,image_url:void 0,mini_preview:void 0,offline_attachment_id:a,original_file_hash:void 0,playable_duration_ms:d("I64").of_float(e*1e3),playable_url:URL.createObjectURL(b),playable_url_mime_type:b.type,preview_height:void 0,preview_url:void 0,preview_url_mime_type:void 0,preview_width:void 0,sampling_frequency_hz:f==null?void 0:f.sampling_freq,source_text:void 0,subtitle_text:void 0,title_text:void 0,waveform_data:f==null?void 0:(a=f.amplitudes)==null?void 0:a.join(","),xma_layout_type:void 0,xmas_template_type:void 0}}function f(a,b){a=a.map(function(a){return{action_url:void 0,attachment_fbid:a.offlineAttachmentId,attachment_index:d("I64").zero,attachment_type:a.attachmentType,cta1_title:void 0,cta2_title:void 0,cta3_title:void 0,description_text:void 0,filename:a.filename,filesize:void 0,has_media:!0,has_xma:!1,image_url:void 0,mini_preview:void 0,offline_attachment_id:a.offlineAttachmentId,original_file_hash:void 0,playable_duration_ms:void 0,playable_url:a.previewUrl,playable_url_mime_type:a.mimeType,preview_height:a.previewHeight,preview_url:a.previewUrl,preview_url_mime_type:void 0,preview_width:a.previewWidth,source_text:void 0,subtitle_text:void 0,title_text:void 0,xma_layout_type:void 0,xmas_template_type:void 0}});var e=[],f=[];a.forEach(function(a){d("I64").equal(a.attachment_type,d("LSIntEnum").ofNumber(c("MessagingAttachmentType").IMAGE))&&!b?f.push(a):e.push([a])});f.length>0&&e.unshift(f);return e.map(function(a){return a.map(function(a,b){return babelHelpers["extends"]({},a,{attachment_index:d("I64").of_int32(b)})})})}g.startUpload=a;g.getAttachmentType=b;g.getAudioAttachment=e;g.createPartitionedAttachments=f}),98);